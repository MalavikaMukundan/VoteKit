
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ballot_graph/">
      
      
        <link rel="next" href="../SCR_general_vocabulary/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>API Reference - VoteKit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VoteKit" class="md-header__button md-logo" aria-label="VoteKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VoteKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mggg/VoteKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mggg/VoteKit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  VoteKit Documentation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../getting_started/" class="md-tabs__link">
        
  
    
  
  Getting started with votekit

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../some_plotting_options/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../SCR_general_vocabulary/" class="md-tabs__link">
          
  
  Social Choice Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VoteKit" class="md-nav__button md-logo" aria-label="VoteKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VoteKit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mggg/VoteKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mggg/VoteKit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VoteKit Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with votekit
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../some_plotting_options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Some Plotting Options: Summary Statistics, Pairwise Comparison Graphs, and MDS Plots.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bg_models_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ballot Generators: Generating PreferenceProfiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bg_models_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    More Ballot Generators: Slate, AC, and CS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bg_from_params/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ballot Generators from Parameters: the Dirichlet Distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ballot_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BallotGraph
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    <span class="md-ellipsis">
      Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot.Ballot" class="md-nav__link">
    <span class="md-ellipsis">
      Ballot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.PreferenceInterval" class="md-nav__link">
    <span class="md-ellipsis">
      PreferenceInterval
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PreferenceInterval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.PreferenceInterval.from_dirichlet" class="md-nav__link">
    <span class="md-ellipsis">
      from_dirichlet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.combine_preference_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      combine_preference_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile" class="md-nav__link">
    <span class="md-ellipsis">
      PreferenceProfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PreferenceProfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      __add__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.condense_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      condense_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.get_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      get_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.get_candidates" class="md-nav__link">
    <span class="md-ellipsis">
      get_candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.num_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      num_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState" class="md-nav__link">
    <span class="md-ellipsis">
      ElectionState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ElectionState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.changed_rankings" class="md-nav__link">
    <span class="md-ellipsis">
      changed_rankings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.eliminated" class="md-nav__link">
    <span class="md-ellipsis">
      eliminated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.get_scores" class="md-nav__link">
    <span class="md-ellipsis">
      get_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.rankings" class="md-nav__link">
    <span class="md-ellipsis">
      rankings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.round_outcome" class="md-nav__link">
    <span class="md-ellipsis">
      round_outcome
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.status" class="md-nav__link">
    <span class="md-ellipsis">
      status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.winners" class="md-nav__link">
    <span class="md-ellipsis">
      winners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph" class="md-nav__link">
    <span class="md-ellipsis">
      BallotGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.build_graph" class="md-nav__link">
    <span class="md-ellipsis">
      build_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.draw" class="md-nav__link">
    <span class="md-ellipsis">
      draw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.fix_short_ballot" class="md-nav__link">
    <span class="md-ellipsis">
      fix_short_ballot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.from_profile" class="md-nav__link">
    <span class="md-ellipsis">
      from_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.label_cands" class="md-nav__link">
    <span class="md-ellipsis">
      label_cands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.label_weights" class="md-nav__link">
    <span class="md-ellipsis">
      label_weights
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph" class="md-nav__link">
    <span class="md-ellipsis">
      PairwiseComparisonGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PairwiseComparisonGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.ballot_fill" class="md-nav__link">
    <span class="md-ellipsis">
      ballot_fill
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.build_graph" class="md-nav__link">
    <span class="md-ellipsis">
      build_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.compute_pairwise_dict" class="md-nav__link">
    <span class="md-ellipsis">
      compute_pairwise_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.dominating_tiers" class="md-nav__link">
    <span class="md-ellipsis">
      dominating_tiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.draw" class="md-nav__link">
    <span class="md-ellipsis">
      draw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_cycles" class="md-nav__link">
    <span class="md-ellipsis">
      get_condorcet_cycles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_winner" class="md-nav__link">
    <span class="md-ellipsis">
      get_condorcet_winner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_cycles" class="md-nav__link">
    <span class="md-ellipsis">
      has_condorcet_cycles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_winner" class="md-nav__link">
    <span class="md-ellipsis">
      has_condorcet_winner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.head2head_count" class="md-nav__link">
    <span class="md-ellipsis">
      head2head_count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cvr-loaders" class="md-nav__link">
    <span class="md-ellipsis">
      CVR Loaders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CVR Loaders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.cvr_loaders.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cvr_loaders.load_scottish" class="md-nav__link">
    <span class="md-ellipsis">
      load_scottish
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ballot-generators" class="md-nav__link">
    <span class="md-ellipsis">
      Ballot Generators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ballot Generators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      BallotGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.ballot_pool_to_profile" class="md-nav__link">
    <span class="md-ellipsis">
      ballot_pool_to_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.from_params" class="md-nav__link">
    <span class="md-ellipsis">
      from_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex" class="md-nav__link">
    <span class="md-ellipsis">
      BallotSimplex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotSimplex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.from_alpha" class="md-nav__link">
    <span class="md-ellipsis">
      from_alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.from_point" class="md-nav__link">
    <span class="md-ellipsis">
      from_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_PlackettLuce" class="md-nav__link">
    <span class="md-ellipsis">
      slate_PlackettLuce
    </span>
  </a>
  
    <nav class="md-nav" aria-label="slate_PlackettLuce">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_PlackettLuce.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_PlackettLuce" class="md-nav__link">
    <span class="md-ellipsis">
      name_PlackettLuce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_BradleyTerry" class="md-nav__link">
    <span class="md-ellipsis">
      slate_BradleyTerry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="slate_BradleyTerry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_BradleyTerry.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_BradleyTerry" class="md-nav__link">
    <span class="md-ellipsis">
      name_BradleyTerry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="name_BradleyTerry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_BradleyTerry.generate_profile_MCMC" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile_MCMC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.AlternatingCrossover" class="md-nav__link">
    <span class="md-ellipsis">
      AlternatingCrossover
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.CambridgeSampler" class="md-nav__link">
    <span class="md-ellipsis">
      CambridgeSampler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.OneDimSpatial" class="md-nav__link">
    <span class="md-ellipsis">
      OneDimSpatial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.ImpartialCulture" class="md-nav__link">
    <span class="md-ellipsis">
      ImpartialCulture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.ImpartialAnonymousCulture" class="md-nav__link">
    <span class="md-ellipsis">
      ImpartialAnonymousCulture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_Cumulative" class="md-nav__link">
    <span class="md-ellipsis">
      name_Cumulative
    </span>
  </a>
  
    <nav class="md-nav" aria-label="name_Cumulative">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_Cumulative.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elections" class="md-nav__link">
    <span class="md-ellipsis">
      Elections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Elections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc" class="md-nav__link">
    <span class="md-ellipsis">
      Bloc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bloc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda" class="md-nav__link">
    <span class="md-ellipsis">
      Borda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Borda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda" class="md-nav__link">
    <span class="md-ellipsis">
      CondoBorda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CondoBorda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Cumulative" class="md-nav__link">
    <span class="md-ellipsis">
      Cumulative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets" class="md-nav__link">
    <span class="md-ellipsis">
      DominatingSets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DominatingSets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.HighestScore" class="md-nav__link">
    <span class="md-ellipsis">
      HighestScore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.IRV" class="md-nav__link">
    <span class="md-ellipsis">
      IRV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited" class="md-nav__link">
    <span class="md-ellipsis">
      Limited
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limited">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Plurality" class="md-nav__link">
    <span class="md-ellipsis">
      Plurality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV" class="md-nav__link">
    <span class="md-ellipsis">
      SNTV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SNTV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid" class="md-nav__link">
    <span class="md-ellipsis">
      SNTV_STV_Hybrid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SNTV_STV_Hybrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV" class="md-nav__link">
    <span class="md-ellipsis">
      STV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.get_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      get_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.next_round" class="md-nav__link">
    <span class="md-ellipsis">
      next_round
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV" class="md-nav__link">
    <span class="md-ellipsis">
      SequentialRCV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequentialRCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo" class="md-nav__link">
    <span class="md-ellipsis">
      TopTwo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopTwo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleaning" class="md-nav__link">
    <span class="md-ellipsis">
      Cleaning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cleaning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.clean_profile" class="md-nav__link">
    <span class="md-ellipsis">
      clean_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.deduplicate_profiles" class="md-nav__link">
    <span class="md-ellipsis">
      deduplicate_profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.merge_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      merge_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.remove_empty_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      remove_empty_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.remove_noncands" class="md-nav__link">
    <span class="md-ellipsis">
      remove_noncands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.utils.borda_scores" class="md-nav__link">
    <span class="md-ellipsis">
      borda_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.first_place_votes" class="md-nav__link">
    <span class="md-ellipsis">
      first_place_votes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.mentions" class="md-nav__link">
    <span class="md-ellipsis">
      mentions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.earth_mover_dist" class="md-nav__link">
    <span class="md-ellipsis">
      earth_mover_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.lp_dist" class="md-nav__link">
    <span class="md-ellipsis">
      lp_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.em_array" class="md-nav__link">
    <span class="md-ellipsis">
      em_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.fractional_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      fractional_transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.seqRCV_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      seqRCV_transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.random_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      random_transfer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.compute_MDS" class="md-nav__link">
    <span class="md-ellipsis">
      compute_MDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.plot_MDS" class="md-nav__link">
    <span class="md-ellipsis">
      plot_MDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.profile_plots.plot_summary_stats" class="md-nav__link">
    <span class="md-ellipsis">
      plot_summary_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.utils.compute_votes" class="md-nav__link">
    <span class="md-ellipsis">
      compute_votes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.remove_cand" class="md-nav__link">
    <span class="md-ellipsis">
      remove_cand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.fix_ties" class="md-nav__link">
    <span class="md-ellipsis">
      fix_ties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.elect_cands_from_set_ranking" class="md-nav__link">
    <span class="md-ellipsis">
      elect_cands_from_set_ranking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.scores_into_set_list" class="md-nav__link">
    <span class="md-ellipsis">
      scores_into_set_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.tie_broken_ranking" class="md-nav__link">
    <span class="md-ellipsis">
      tie_broken_ranking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.candidate_position_dict" class="md-nav__link">
    <span class="md-ellipsis">
      candidate_position_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Social Choice Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Social Choice Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_general_vocabulary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Vocabulary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_preference_intervals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preference Intervals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_simplex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simplices in Social Choice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_ballot_generators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ballot Generators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_elections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCR_distances/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distances between PreferenceProfiles
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    <span class="md-ellipsis">
      Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot.Ballot" class="md-nav__link">
    <span class="md-ellipsis">
      Ballot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.PreferenceInterval" class="md-nav__link">
    <span class="md-ellipsis">
      PreferenceInterval
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PreferenceInterval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.PreferenceInterval.from_dirichlet" class="md-nav__link">
    <span class="md-ellipsis">
      from_dirichlet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_interval.combine_preference_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      combine_preference_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile" class="md-nav__link">
    <span class="md-ellipsis">
      PreferenceProfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PreferenceProfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      __add__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.condense_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      condense_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.get_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      get_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.get_candidates" class="md-nav__link">
    <span class="md-ellipsis">
      get_candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.num_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      num_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.pref_profile.PreferenceProfile.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState" class="md-nav__link">
    <span class="md-ellipsis">
      ElectionState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ElectionState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.changed_rankings" class="md-nav__link">
    <span class="md-ellipsis">
      changed_rankings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.eliminated" class="md-nav__link">
    <span class="md-ellipsis">
      eliminated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.get_scores" class="md-nav__link">
    <span class="md-ellipsis">
      get_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.rankings" class="md-nav__link">
    <span class="md-ellipsis">
      rankings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.round_outcome" class="md-nav__link">
    <span class="md-ellipsis">
      round_outcome
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.status" class="md-nav__link">
    <span class="md-ellipsis">
      status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.election_state.ElectionState.winners" class="md-nav__link">
    <span class="md-ellipsis">
      winners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph" class="md-nav__link">
    <span class="md-ellipsis">
      BallotGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.build_graph" class="md-nav__link">
    <span class="md-ellipsis">
      build_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.draw" class="md-nav__link">
    <span class="md-ellipsis">
      draw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.fix_short_ballot" class="md-nav__link">
    <span class="md-ellipsis">
      fix_short_ballot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.from_profile" class="md-nav__link">
    <span class="md-ellipsis">
      from_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.label_cands" class="md-nav__link">
    <span class="md-ellipsis">
      label_cands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.ballot_graph.BallotGraph.label_weights" class="md-nav__link">
    <span class="md-ellipsis">
      label_weights
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph" class="md-nav__link">
    <span class="md-ellipsis">
      PairwiseComparisonGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PairwiseComparisonGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.ballot_fill" class="md-nav__link">
    <span class="md-ellipsis">
      ballot_fill
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.build_graph" class="md-nav__link">
    <span class="md-ellipsis">
      build_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.compute_pairwise_dict" class="md-nav__link">
    <span class="md-ellipsis">
      compute_pairwise_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.dominating_tiers" class="md-nav__link">
    <span class="md-ellipsis">
      dominating_tiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.draw" class="md-nav__link">
    <span class="md-ellipsis">
      draw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_cycles" class="md-nav__link">
    <span class="md-ellipsis">
      get_condorcet_cycles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_winner" class="md-nav__link">
    <span class="md-ellipsis">
      get_condorcet_winner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_cycles" class="md-nav__link">
    <span class="md-ellipsis">
      has_condorcet_cycles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_winner" class="md-nav__link">
    <span class="md-ellipsis">
      has_condorcet_winner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.head2head_count" class="md-nav__link">
    <span class="md-ellipsis">
      head2head_count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cvr-loaders" class="md-nav__link">
    <span class="md-ellipsis">
      CVR Loaders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CVR Loaders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.cvr_loaders.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cvr_loaders.load_scottish" class="md-nav__link">
    <span class="md-ellipsis">
      load_scottish
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ballot-generators" class="md-nav__link">
    <span class="md-ellipsis">
      Ballot Generators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ballot Generators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      BallotGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.ballot_pool_to_profile" class="md-nav__link">
    <span class="md-ellipsis">
      ballot_pool_to_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.from_params" class="md-nav__link">
    <span class="md-ellipsis">
      from_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotGenerator.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex" class="md-nav__link">
    <span class="md-ellipsis">
      BallotSimplex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BallotSimplex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.from_alpha" class="md-nav__link">
    <span class="md-ellipsis">
      from_alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.from_point" class="md-nav__link">
    <span class="md-ellipsis">
      from_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.BallotSimplex.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_PlackettLuce" class="md-nav__link">
    <span class="md-ellipsis">
      slate_PlackettLuce
    </span>
  </a>
  
    <nav class="md-nav" aria-label="slate_PlackettLuce">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_PlackettLuce.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_PlackettLuce" class="md-nav__link">
    <span class="md-ellipsis">
      name_PlackettLuce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_BradleyTerry" class="md-nav__link">
    <span class="md-ellipsis">
      slate_BradleyTerry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="slate_BradleyTerry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.slate_BradleyTerry.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_BradleyTerry" class="md-nav__link">
    <span class="md-ellipsis">
      name_BradleyTerry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="name_BradleyTerry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_BradleyTerry.generate_profile_MCMC" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile_MCMC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.AlternatingCrossover" class="md-nav__link">
    <span class="md-ellipsis">
      AlternatingCrossover
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.CambridgeSampler" class="md-nav__link">
    <span class="md-ellipsis">
      CambridgeSampler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.OneDimSpatial" class="md-nav__link">
    <span class="md-ellipsis">
      OneDimSpatial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.ImpartialCulture" class="md-nav__link">
    <span class="md-ellipsis">
      ImpartialCulture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.ImpartialAnonymousCulture" class="md-nav__link">
    <span class="md-ellipsis">
      ImpartialAnonymousCulture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_Cumulative" class="md-nav__link">
    <span class="md-ellipsis">
      name_Cumulative
    </span>
  </a>
  
    <nav class="md-nav" aria-label="name_Cumulative">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.ballot_generator.name_Cumulative.generate_profile" class="md-nav__link">
    <span class="md-ellipsis">
      generate_profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elections" class="md-nav__link">
    <span class="md-ellipsis">
      Elections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Elections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc" class="md-nav__link">
    <span class="md-ellipsis">
      Bloc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bloc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Bloc.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda" class="md-nav__link">
    <span class="md-ellipsis">
      Borda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Borda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Borda.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda" class="md-nav__link">
    <span class="md-ellipsis">
      CondoBorda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CondoBorda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.CondoBorda.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Cumulative" class="md-nav__link">
    <span class="md-ellipsis">
      Cumulative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets" class="md-nav__link">
    <span class="md-ellipsis">
      DominatingSets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DominatingSets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.DominatingSets.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.HighestScore" class="md-nav__link">
    <span class="md-ellipsis">
      HighestScore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.IRV" class="md-nav__link">
    <span class="md-ellipsis">
      IRV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited" class="md-nav__link">
    <span class="md-ellipsis">
      Limited
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limited">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Limited.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.Plurality" class="md-nav__link">
    <span class="md-ellipsis">
      Plurality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV" class="md-nav__link">
    <span class="md-ellipsis">
      SNTV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SNTV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid" class="md-nav__link">
    <span class="md-ellipsis">
      SNTV_STV_Hybrid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SNTV_STV_Hybrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV" class="md-nav__link">
    <span class="md-ellipsis">
      STV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="STV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.get_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      get_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.next_round" class="md-nav__link">
    <span class="md-ellipsis">
      next_round
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.STV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV" class="md-nav__link">
    <span class="md-ellipsis">
      SequentialRCV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequentialRCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.SequentialRCV.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo" class="md-nav__link">
    <span class="md-ellipsis">
      TopTwo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopTwo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo.run_election" class="md-nav__link">
    <span class="md-ellipsis">
      run_election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.election_types.TopTwo.run_step" class="md-nav__link">
    <span class="md-ellipsis">
      run_step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleaning" class="md-nav__link">
    <span class="md-ellipsis">
      Cleaning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cleaning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.clean_profile" class="md-nav__link">
    <span class="md-ellipsis">
      clean_profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.deduplicate_profiles" class="md-nav__link">
    <span class="md-ellipsis">
      deduplicate_profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.merge_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      merge_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.remove_empty_ballots" class="md-nav__link">
    <span class="md-ellipsis">
      remove_empty_ballots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.cleaning.remove_noncands" class="md-nav__link">
    <span class="md-ellipsis">
      remove_noncands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.utils.borda_scores" class="md-nav__link">
    <span class="md-ellipsis">
      borda_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.first_place_votes" class="md-nav__link">
    <span class="md-ellipsis">
      first_place_votes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.mentions" class="md-nav__link">
    <span class="md-ellipsis">
      mentions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.earth_mover_dist" class="md-nav__link">
    <span class="md-ellipsis">
      earth_mover_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.lp_dist" class="md-nav__link">
    <span class="md-ellipsis">
      lp_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.metrics.distances.em_array" class="md-nav__link">
    <span class="md-ellipsis">
      em_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.fractional_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      fractional_transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.seqRCV_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      seqRCV_transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.elections.transfers.random_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      random_transfer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.compute_MDS" class="md-nav__link">
    <span class="md-ellipsis">
      compute_MDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.mds.plot_MDS" class="md-nav__link">
    <span class="md-ellipsis">
      plot_MDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.plots.profile_plots.plot_summary_stats" class="md-nav__link">
    <span class="md-ellipsis">
      plot_summary_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      Utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#votekit.utils.compute_votes" class="md-nav__link">
    <span class="md-ellipsis">
      compute_votes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.remove_cand" class="md-nav__link">
    <span class="md-ellipsis">
      remove_cand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.fix_ties" class="md-nav__link">
    <span class="md-ellipsis">
      fix_ties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.elect_cands_from_set_ranking" class="md-nav__link">
    <span class="md-ellipsis">
      elect_cands_from_set_ranking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.scores_into_set_list" class="md-nav__link">
    <span class="md-ellipsis">
      scores_into_set_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.tie_broken_ranking" class="md-nav__link">
    <span class="md-ellipsis">
      tie_broken_ranking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#votekit.utils.candidate_position_dict" class="md-nav__link">
    <span class="md-ellipsis">
      candidate_position_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="objects">Objects<a class="headerlink" href="#objects" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.ballot.Ballot" class="doc doc-heading">
          <code>Ballot</code>


<a href="#votekit.ballot.Ballot" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Ballot class, contains ranking and assigned weight.</p>
<p><strong>Attributes</strong>
<code>ranking</code>
:   tuple of candidate ranking. Entry <span class="arithmatex">\(i\)</span> of the tuple is a frozenset of candidates ranked
    in position <span class="arithmatex">\(i\)</span>.</p>
<p><code>weight</code>
:   (Fraction) weight assigned to a given a ballot. Defaults to 1.</p>
<p><code>voter_set</code>
:   optional set of voters who cast a given a ballot.</p>
<p><code>id</code>
:   optional ballot id.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">Ballot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ballot class, contains ranking and assigned weight.</span>

<span class="sd">    **Attributes**</span>
<span class="sd">    `ranking`</span>
<span class="sd">    :   tuple of candidate ranking. Entry $i$ of the tuple is a frozenset of candidates ranked</span>
<span class="sd">        in position $i$.</span>

<span class="sd">    `weight`</span>
<span class="sd">    :   (Fraction) weight assigned to a given a ballot. Defaults to 1.</span>

<span class="sd">    `voter_set`</span>
<span class="sd">    :   optional set of voters who cast a given a ballot.</span>

<span class="sd">    `id`</span>
<span class="sd">    :   optional ballot id.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ranking</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
    <span class="n">weight</span><span class="p">:</span> <span class="n">Fraction</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">voter_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># converts weight to a Fraction if an integer or float</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">):</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Check type</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Ballot</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check id</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check ranking</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranking</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check weight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">weight</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check voters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">voter_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">voter_set</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">voter_set</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">weight_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Weight: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">ranking_str</span> <span class="o">=</span> <span class="s2">&quot;Ballot</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranking</span><span class="p">):</span>
                <span class="c1"># display number and candidates</span>
                <span class="n">ranking_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.) &quot;</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">ranking_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">, &quot;</span>

                <span class="c1"># if tie</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ranking_str</span> <span class="o">+=</span> <span class="s2">&quot;(tie)&quot;</span>
                <span class="n">ranking_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ranking_str</span> <span class="o">+=</span> <span class="s2">&quot;Empty</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">ranking_str</span> <span class="o">+</span> <span class="n">weight_str</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.pref_interval.PreferenceInterval" class="doc doc-heading">
          <code>PreferenceInterval</code>


<a href="#votekit.pref_interval.PreferenceInterval" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>PreferenceInterval class, contains preference for individual candidates stored as relative
share of the interval [0,1].</p>
<p><strong>Attributes</strong></p>
<p><code>interval</code>
:   dictionary (candidate, support). A dictionary representing the given PreferenceInterval.
    The keys are candidate names, and the values are floats representing that candidates
    share of the interval. Does not have to sum to one, the init method will renormalize.</p>
<p><code>candidates</code>
: frozenset. A frozenset of candidates (with zero and non-zero support)</p>
<p><code>non_zero_cands</code>
: frozenset. A frozenset of candidates with non-zero support.</p>
<p><code>zero_cands</code>
: frozenset. A frozenset of candidates with zero support.</p>
<p><strong>Methods</strong></p>
<p><code>from_dirichlet</code>
: sample a PreferenceInterval from the Dirichlet distribution on the candidate simplex.</p>
<p><code>normalize</code>
: normalize the support values of the PreferenceInterval to sum to 1.</p>
<p><code>remove_zero_support_cands</code>
: remove candidates with zero support from the interval and store them in the attribute
    <code>zero_cands</code>.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/pref_interval.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PreferenceInterval</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PreferenceInterval class, contains preference for individual candidates stored as relative</span>
<span class="sd">    share of the interval [0,1].</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `interval`</span>
<span class="sd">    :   dictionary (candidate, support). A dictionary representing the given PreferenceInterval.</span>
<span class="sd">        The keys are candidate names, and the values are floats representing that candidates</span>
<span class="sd">        share of the interval. Does not have to sum to one, the init method will renormalize.</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : frozenset. A frozenset of candidates (with zero and non-zero support)</span>

<span class="sd">    `non_zero_cands`</span>
<span class="sd">    : frozenset. A frozenset of candidates with non-zero support.</span>

<span class="sd">    `zero_cands`</span>
<span class="sd">    : frozenset. A frozenset of candidates with zero support.</span>


<span class="sd">    **Methods**</span>

<span class="sd">    `from_dirichlet`</span>
<span class="sd">    : sample a PreferenceInterval from the Dirichlet distribution on the candidate simplex.</span>

<span class="sd">    `normalize`</span>
<span class="sd">    : normalize the support values of the PreferenceInterval to sum to 1.</span>

<span class="sd">    `remove_zero_support_cands`</span>
<span class="sd">    : remove candidates with zero support from the interval and store them in the attribute</span>
<span class="sd">        `zero_cands`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO frozendict, frozenclass</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MappingProxyType</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">zero_cands</span><span class="p">:</span> <span class="nb">frozenset</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_zero_cands</span><span class="p">:</span> <span class="nb">frozenset</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_zero_support_cands</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normalize</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dirichlet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Samples a PreferenceInterval from the Dirichlet distribution on the candidate simplex.</span>
<span class="sd">        Alpha tends to 0 is strong support, alpha tends to infinity is uniform support, alpha = 1</span>
<span class="sd">        is all bets are off.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)))</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">({</span><span class="n">c</span><span class="p">:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">probs</span><span class="p">)})</span>

    <span class="k">def</span> <span class="nf">_normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize a PreferenceInterval so the support values sum to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">summ</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s2">&quot;There are no candidates with non-zero support.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MappingProxyType</span><span class="p">(</span>
            <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">s</span> <span class="o">/</span> <span class="n">summ</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_remove_zero_support_cands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove candidates with zero support from the interval. Store candidates</span>
<span class="sd">        with zero support as a set in the attribute `zero_cands`.</span>

<span class="sd">        Should only be run once.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_cands</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_zero_cands</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MappingProxyType</span><span class="p">(</span>
                <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">non_zero_cands</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PreferenceInterval</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Both types must be PreferenceInterval.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_cands</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">zero_cands</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_zero_cands</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">non_zero_cands</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">interval</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
                <span class="nb">round</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">printed_interval</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">printed_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.pref_interval.PreferenceInterval.from_dirichlet" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_dirichlet</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#votekit.pref_interval.PreferenceInterval.from_dirichlet" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Samples a PreferenceInterval from the Dirichlet distribution on the candidate simplex.
Alpha tends to 0 is strong support, alpha tends to infinity is uniform support, alpha = 1
is all bets are off.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_interval.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_dirichlet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Samples a PreferenceInterval from the Dirichlet distribution on the candidate simplex.</span>
<span class="sd">    Alpha tends to 0 is strong support, alpha tends to infinity is uniform support, alpha = 1</span>
<span class="sd">    is all bets are off.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)))</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">({</span><span class="n">c</span><span class="p">:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">probs</span><span class="p">)})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h3 id="votekit.pref_interval.combine_preference_intervals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">combine_preference_intervals</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span> <span class="n">proportions</span><span class="p">)</span></code>

<a href="#votekit.pref_interval.combine_preference_intervals" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <div class="highlight"><pre><span></span><code>Combine a list of preference intervals given a list of proportions used to reweight each
interval.
</code></pre></div>
<p><strong>Arguments</strong>
<code>intervals</code>
: list.  A list of PreferenceInterval objects to combine.</p>
<p><code>proportions</code>
: list. A list of floats used to reweight the PreferenceInterval objects. Proportion <span class="arithmatex">\(i\)</span> will
reweight interval <span class="arithmatex">\(i\)</span>.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_interval.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">combine_preference_intervals</span><span class="p">(</span>
    <span class="n">intervals</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PreferenceInterval</span><span class="p">],</span> <span class="n">proportions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combine a list of preference intervals given a list of proportions used to reweight each</span>
<span class="sd">        interval.</span>

<span class="sd">    **Arguments**</span>
<span class="sd">    `intervals`</span>
<span class="sd">    : list.  A list of PreferenceInterval objects to combine.</span>

<span class="sd">    `proportions`</span>
<span class="sd">    : list. A list of floats used to reweight the PreferenceInterval objects. Proportion $i$ will</span>
<span class="sd">    reweight interval $i$.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="nb">frozenset</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">candidates</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">]))</span>
        <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Intervals must have disjoint candidate sets&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">proportions</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Proportions must sum to 1.&quot;</span><span class="p">)</span>

    <span class="n">sum_pi</span> <span class="o">=</span> <span class="n">PreferenceInterval</span><span class="p">(</span>
        <span class="n">interval</span><span class="o">=</span><span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="o">*</span> <span class="n">prop</span>
            <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span> <span class="n">proportions</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pi</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># carry along the candidates with zero support</span>
    <span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">])</span>

    <span class="c1"># need to union to ensure that if one of the proportions is 0 those candidates are saved</span>
    <span class="n">sum_pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="o">=</span> <span class="n">sum_pi</span><span class="o">.</span><span class="n">zero_cands</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sum_pi</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.pref_profile.PreferenceProfile" class="doc doc-heading">
          <code>PreferenceProfile</code>


<a href="#votekit.pref_profile.PreferenceProfile" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>PreferenceProfile class, contains ballots and candidates for a given election.</p>
<p><strong>Attributes</strong></p>
<p><code>ballots</code>
:   list of <code>Ballot</code> objects.</p>
<p><code>candidates</code>
:   list of candidates.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PreferenceProfile</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PreferenceProfile class, contains ballots and candidates for a given election.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `ballots`</span>
<span class="sd">    :   list of `Ballot` objects.</span>

<span class="sd">    `candidates`</span>
<span class="sd">    :   list of candidates.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">candidates</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;candidates&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">cands_must_be_unique</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;all candidates must be unique&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">candidates</span>

    <span class="k">def</span> <span class="nf">get_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">         List of ballots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">[:]</span>

    <span class="k">def</span> <span class="nf">get_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received_votes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            received_votes: If True, only return candidates that received votes. Defaults</span>
<span class="sd">                    to True.</span>
<span class="sd">        Returns:</span>
<span class="sd">          List of candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">received_votes</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="n">unique_cands</span><span class="p">:</span> <span class="nb">set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
                <span class="n">unique_cands</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>

            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_cands</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>

    <span class="c1"># can also cache</span>
    <span class="k">def</span> <span class="nf">num_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fraction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts number of ballots based on assigned weight.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Number of ballots cast.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="n">num_ballots</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

        <span class="k">return</span> <span class="n">num_ballots</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">standardize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts to dictionary with keys = rankings and values = corresponding total weights.</span>

<span class="sd">        Args:</span>
<span class="sd">            standardize (Boolean): If True, divides the weight of each ballot</span>
<span class="sd">                            by the total weight. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary with ranking (keys) and corresponding total weights (values).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span>
        <span class="n">di</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="n">rank_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="n">num_ballots</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
            <span class="k">if</span> <span class="n">rank_tuple</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">di</span><span class="p">[</span><span class="n">rank_tuple</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">di</span><span class="p">[</span><span class="n">rank_tuple</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
        <span class="k">return</span> <span class="n">di</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves PreferenceProfile to CSV.</span>

<span class="sd">        Args:</span>
<span class="sd">            fpath: Path to the saved csv.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">]</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">fieldnames</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_create_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates pandas DataFrame for display and building plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="n">part</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ranking</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ranking</span><span class="si">}</span><span class="s2"> (Tie)&quot;</span><span class="p">)</span>

            <span class="n">ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">part</span><span class="p">))</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Ballots&quot;</span><span class="p">:</span> <span class="n">ballots</span><span class="p">,</span> <span class="s2">&quot;Weight&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">})</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Weight&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># fill nans with zero for edge cases</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">format_as_percent</span><span class="p">(</span><span class="n">frac</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">frac</span><span class="p">)</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">format_as_percent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">sort_by_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">percents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">totals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays top-n ballots in profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            n: Number of ballots to view.</span>
<span class="sd">            sort_by_weight: If True, rank ballot from most to least votes. Defaults to True.</span>
<span class="sd">            percents: If True, show voter share for a given ballot.</span>
<span class="sd">            totals: If True, show total values for Percent and Weight.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dataframe with top-n ballots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_df</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">sort_by_weight</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">totals</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_row</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">percents</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Percent&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">sort_by_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">percents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">totals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays bottom-n ballots in profile.</span>

<span class="sd">        Args:</span>
<span class="sd">            n: Number of ballots to view.</span>
<span class="sd">            sort_by_weight: If True, rank ballot from least to most votes. Defaults to True.</span>
<span class="sd">            percents: If True, show voter share for a given ballot.</span>
<span class="sd">            totals: If True, show total values for Percent and Weight.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A data frame with bottom-n ballots.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_df</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">sort_by_weight</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;New Index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;New Index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">totals</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_row</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">percents</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Percent&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Displays top 15 cast ballots or entire profile</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_df</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">),</span> <span class="n">sort_by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span>
                <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;justify&quot;</span>
            <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PreferenceProfile too long, only showing 15 out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="si">}</span><span class="s2"> rows.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">sort_by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;justify&quot;</span>
        <span class="p">)</span>

    <span class="c1"># set repr to print outputs</span>
    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>

    <span class="k">def</span> <span class="nf">condense_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups ballots by rankings and updates weights.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A PreferenceProfile object with condensed ballot list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking_to_index</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">weight_accumulator</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ranking_to_index</span><span class="p">:</span>
                <span class="n">ranking_to_index</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking_to_index</span><span class="p">)</span>
                <span class="n">weight_accumulator</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">weight_accumulator</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

        <span class="n">new_ballot_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">ranking</span><span class="p">)),</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">weight_accumulator</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="n">condensed_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">new_ballot_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">condensed_profile</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PreferenceProfile</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">pp_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="n">pp_2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">pp_1</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pp_2</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">pp_2</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pp_1</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_sum_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes sum total for weight and percent column</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">format_as_float</span><span class="p">(</span><span class="n">percent_str</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">percent_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">sum_row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Ballot&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Weight&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> out of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s2">&quot;Percent&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Percent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">format_as_float</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> out of 100%&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Totals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_row</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add two PreferenceProfiles by combining their ballot lists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PreferenceProfile</span><span class="p">):</span>
            <span class="n">ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">ballots</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">)</span>
            <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">pp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Unsupported operand type. Must be an instance of PreferenceProfile.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.__add__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.__add__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Add two PreferenceProfiles by combining their ballot lists.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add two PreferenceProfiles by combining their ballot lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PreferenceProfile</span><span class="p">):</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">ballots</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">)</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Unsupported operand type. Must be an instance of PreferenceProfile.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.condense_ballots" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">condense_ballots</span><span class="p">()</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.condense_ballots" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Groups ballots by rankings and updates weights.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile object with condensed ballot list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">condense_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Groups ballots by rankings and updates weights.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A PreferenceProfile object with condensed ballot list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ranking_to_index</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">weight_accumulator</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ranking_to_index</span><span class="p">:</span>
            <span class="n">ranking_to_index</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking_to_index</span><span class="p">)</span>
            <span class="n">weight_accumulator</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">weight_accumulator</span><span class="p">[</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

    <span class="n">new_ballot_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">,</span> <span class="n">ranking</span><span class="p">)),</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">weight_accumulator</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="n">condensed_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">new_ballot_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">condensed_profile</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.get_ballots" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_ballots</span><span class="p">()</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.get_ballots" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of ballots.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">     List of ballots.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">[:]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.get_candidates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_candidates</span><span class="p">(</span><span class="n">received_votes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.get_candidates" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>received_votes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, only return candidates that received votes. Defaults
    to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
  List of candidates.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received_votes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        received_votes: If True, only return candidates that received votes. Defaults</span>
<span class="sd">                to True.</span>
<span class="sd">    Returns:</span>
<span class="sd">      List of candidates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">received_votes</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
        <span class="n">unique_cands</span><span class="p">:</span> <span class="nb">set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="n">unique_cands</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_cands</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.head" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sort_by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">percents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">totals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.head" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Displays top-n ballots in profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ballots to view.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sort_by_weight</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rank ballot from most to least votes. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>percents</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show voter share for a given ballot.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>totals</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show total values for Percent and Weight.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dataframe with top-n ballots.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">head</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">sort_by_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">percents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">totals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays top-n ballots in profile.</span>

<span class="sd">    Args:</span>
<span class="sd">        n: Number of ballots to view.</span>
<span class="sd">        sort_by_weight: If True, rank ballot from most to least votes. Defaults to True.</span>
<span class="sd">        percents: If True, show voter share for a given ballot.</span>
<span class="sd">        totals: If True, show total values for Percent and Weight.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dataframe with top-n ballots.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_df</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sort_by_weight</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">totals</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_row</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">percents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Percent&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.num_ballots" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">num_ballots</span><span class="p">()</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.num_ballots" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Counts number of ballots based on assigned weight.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="fractions.Fraction">Fraction</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ballots cast.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">num_ballots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fraction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts number of ballots based on assigned weight.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Number of ballots cast.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
        <span class="n">num_ballots</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

    <span class="k">return</span> <span class="n">num_ballots</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.tail" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sort_by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">percents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">totals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.tail" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Displays bottom-n ballots in profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ballots to view.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sort_by_weight</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rank ballot from least to most votes. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>percents</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show voter share for a given ballot.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>totals</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show total values for Percent and Weight.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A data frame with bottom-n ballots.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tail</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">sort_by_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">percents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">totals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays bottom-n ballots in profile.</span>

<span class="sd">    Args:</span>
<span class="sd">        n: Number of ballots to view.</span>
<span class="sd">        sort_by_weight: If True, rank ballot from least to most votes. Defaults to True.</span>
<span class="sd">        percents: If True, show voter share for a given ballot.</span>
<span class="sd">        totals: If True, show total values for Percent and Weight.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A data frame with bottom-n ballots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_df</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sort_by_weight</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;New Index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;New Index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">totals</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum_row</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">percents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Percent&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.to_csv" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.to_csv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Saves PreferenceProfile to CSV.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fpath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the saved csv.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves PreferenceProfile to CSV.</span>

<span class="sd">    Args:</span>
<span class="sd">        fpath: Path to the saved csv.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">]</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">fieldnames</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.pref_profile.PreferenceProfile.to_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_dict</span><span class="p">(</span><span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.pref_profile.PreferenceProfile.to_dict" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Converts to dictionary with keys = rankings and values = corresponding total weights.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>standardize</code></td>
          <td>
                <code>Boolean</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, divides the weight of each ballot
            by the total weight. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with ranking (keys) and corresponding total weights (values).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/pref_profile.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">standardize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts to dictionary with keys = rankings and values = corresponding total weights.</span>

<span class="sd">    Args:</span>
<span class="sd">        standardize (Boolean): If True, divides the weight of each ballot</span>
<span class="sd">                        by the total weight. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with ranking (keys) and corresponding total weights (values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span>
    <span class="n">di</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
        <span class="n">rank_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="n">num_ballots</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
        <span class="k">if</span> <span class="n">rank_tuple</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">di</span><span class="p">[</span><span class="n">rank_tuple</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">di</span><span class="p">[</span><span class="n">rank_tuple</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
    <span class="k">return</span> <span class="n">di</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.election_state.ElectionState" class="doc doc-heading">
          <code>ElectionState</code>


<a href="#votekit.election_state.ElectionState" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>Class for storing information on each round of an election and the final outcome.</p>
<p><strong>Attributes</strong>
<code>curr_round</code>
:   current round number. Defaults to 0.</p>
<p><code>elected</code>
:   list of candidates who pass a threshold to win.</p>
<p><code>eliminated_cands</code>
:   list of candidates who were eliminated.</p>
<p><code>remaining</code>
:   list of candidates who are still in the running.</p>
<p><code>profile</code>
:   an instance of a PreferenceProfile object.</p>
<p><code>previous</code>
:   an instance of ElectionState representing the previous round.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/election_state.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ElectionState</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for storing information on each round of an election and the final outcome.</span>

<span class="sd">    **Attributes**</span>
<span class="sd">    `curr_round`</span>
<span class="sd">    :   current round number. Defaults to 0.</span>

<span class="sd">    `elected`</span>
<span class="sd">    :   list of candidates who pass a threshold to win.</span>

<span class="sd">    `eliminated_cands`</span>
<span class="sd">    :   list of candidates who were eliminated.</span>

<span class="sd">    `remaining`</span>
<span class="sd">    :   list of candidates who are still in the running.</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   an instance of a PreferenceProfile object.</span>

<span class="sd">    `previous`</span>
<span class="sd">    :   an instance of ElectionState representing the previous round.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">curr_round</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">elected</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">eliminated_cands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">remaining</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span>
    <span class="n">scores</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;ElectionState&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">allow_mutation</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">winners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">         A list of elected candidates ordered from first round to current round.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span>

    <span class="k">def</span> <span class="nf">eliminated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">          A list of eliminated candidates ordered from current round to first round.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span>

    <span class="k">def</span> <span class="nf">rankings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">          List of all candidates in order of their ranking after each round, first the winners,\</span>
<span class="sd">          then the eliminated candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span> <span class="o">!=</span> <span class="p">[{}]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">round_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="c1"># {&#39;elected&#39;:list[set[str]], &#39;eliminated&#39;:list[set[str]]}</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds the outcome of a given round.</span>

<span class="sd">        Args:</span>
<span class="sd">            round (int): Round number.</span>

<span class="sd">        Returns:</span>
<span class="sd">          A dictionary with elected and eliminated candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">==</span> <span class="nb">round</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;Elected&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span><span class="p">,</span>
                <span class="s2">&quot;Eliminated&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">,</span>
                <span class="s2">&quot;Remaining&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">round_outcome</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Round number out of range&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">curr_round</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of the candidate scores for the inputted round.</span>
<span class="sd">        Defaults to the last round</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">round</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Round number out of range&quot;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span> <span class="nf">changed_rankings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A dictionary with keys = candidate(s) who changed \</span>
<span class="sd">                ranking from previous round and values = a tuple of (previous rank, new rank).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This is the first round, cannot compare previous ranking&quot;</span><span class="p">)</span>

        <span class="n">prev_ranking</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">candidate_position_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">rankings</span><span class="p">())</span>
        <span class="n">curr_ranking</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">candidate_position_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">curr_ranking</span> <span class="o">==</span> <span class="n">prev_ranking</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="n">changes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">curr_ranking</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prev_ranking</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">!=</span> <span class="n">index</span><span class="p">:</span>
                <span class="n">changes</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_ranking</span><span class="p">[</span><span class="n">candidate</span><span class="p">],</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">changes</span>

    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">          Data frame displaying candidate, status (elected, eliminated,</span>
<span class="sd">            remaining), and the round their status updated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_cands</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
        <span class="n">status_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Candidate&quot;</span><span class="p">:</span> <span class="n">all_cands</span><span class="p">,</span>
                <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Remaining&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_cands</span><span class="p">),</span>
                <span class="s2">&quot;Round&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_cands</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="nb">round</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_outcome</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">status</span><span class="p">,</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                        <span class="n">tied_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="c1"># if tie</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">remaining_cands</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cand</span><span class="p">)))</span>
                            <span class="n">tied_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (tie with </span><span class="si">{</span><span class="n">remaining_cands</span><span class="si">}</span><span class="s2">)&quot;</span>

                        <span class="n">status_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">status_df</span><span class="p">[</span><span class="s2">&quot;Candidate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cand</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">status</span> <span class="o">+</span> <span class="n">tied_str</span>
                        <span class="p">)</span>
                        <span class="n">status_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">status_df</span><span class="p">[</span><span class="s2">&quot;Candidate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cand</span><span class="p">,</span> <span class="s2">&quot;Round&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span>

        <span class="k">return</span> <span class="n">status_df</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns election results as a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            keep (list, optional): List of information to store in dictionary, should be subset of</span>
<span class="sd">                &quot;elected&quot;, &quot;eliminated&quot;, &quot;remaining&quot;, &quot;ranking&quot;. Defaults to empty list,</span>
<span class="sd">                which stores all information.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;elected&quot;</span><span class="p">,</span> <span class="s2">&quot;eliminated&quot;</span><span class="p">,</span> <span class="s2">&quot;remaining&quot;</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">]</span>
        <span class="n">values</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">(),</span>
        <span class="p">]</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># pull out candidates from sets, if tied adds tuple of tied candidates</span>
            <span class="n">temp_lst</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cand_set</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cand_set</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">temp_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cand_set</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp_lst</span> <span class="o">+=</span> <span class="p">[</span><span class="n">cand</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cand_set</span><span class="p">]</span>
            <span class="n">rv</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_lst</span>

        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves election state object as a JSON file:</span>

<span class="sd">        Args:</span>
<span class="sd">            keep (list, optional): List of information to store in dictionary, should be subset of</span>
<span class="sd">                &quot;elected&quot;, &quot;eliminated&quot;, &quot;remaining&quot;, &quot;ranking&quot;. Defaults to empty list,</span>
<span class="sd">                which stores all information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">json_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="n">keep</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">show</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current Round: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">show</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;justify&quot;</span><span class="p">)</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.changed_rankings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">changed_rankings</span><span class="p">()</span></code>

<a href="#votekit.election_state.ElectionState.changed_rankings" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with keys = candidate(s) who changed                 ranking from previous round and values = a tuple of (previous rank, new rank).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">changed_rankings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with keys = candidate(s) who changed \</span>
<span class="sd">            ranking from previous round and values = a tuple of (previous rank, new rank).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This is the first round, cannot compare previous ranking&quot;</span><span class="p">)</span>

    <span class="n">prev_ranking</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">candidate_position_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">rankings</span><span class="p">())</span>
    <span class="n">curr_ranking</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">candidate_position_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">curr_ranking</span> <span class="o">==</span> <span class="n">prev_ranking</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">changes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">curr_ranking</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">prev_ranking</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">!=</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">changes</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_ranking</span><span class="p">[</span><span class="n">candidate</span><span class="p">],</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">changes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.eliminated" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eliminated</span><span class="p">()</span></code>

<a href="#votekit.election_state.ElectionState.eliminated" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of eliminated candidates ordered from current round to first round.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eliminated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of eliminated candidates ordered from current round to first round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.get_scores" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_scores</span><span class="p">(</span><span class="nb">round</span><span class="o">=</span><span class="n">curr_round</span><span class="p">)</span></code>

<a href="#votekit.election_state.ElectionState.get_scores" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Returns a dictionary of the candidate scores for the inputted round.
Defaults to the last round</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">curr_round</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of the candidate scores for the inputted round.</span>
<span class="sd">    Defaults to the last round</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">round</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Round number out of range&quot;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.rankings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rankings</span><span class="p">()</span></code>

<a href="#votekit.election_state.ElectionState.rankings" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of all candidates in order of their ranking after each round, first the winners,          then the eliminated candidates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rankings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">      List of all candidates in order of their ranking after each round, first the winners,\</span>
<span class="sd">      then the eliminated candidates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span> <span class="o">!=</span> <span class="p">[{}]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.round_outcome" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">round_outcome</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span></code>

<a href="#votekit.election_state.ElectionState.round_outcome" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Finds the outcome of a given round.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>round</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Round number.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with elected and eliminated candidates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">round_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="c1"># {&#39;elected&#39;:list[set[str]], &#39;eliminated&#39;:list[set[str]]}</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the outcome of a given round.</span>

<span class="sd">    Args:</span>
<span class="sd">        round (int): Round number.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A dictionary with elected and eliminated candidates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">==</span> <span class="nb">round</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;Elected&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span><span class="p">,</span>
            <span class="s2">&quot;Eliminated&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">,</span>
            <span class="s2">&quot;Remaining&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">round_outcome</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Round number out of range&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.status" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">status</span><span class="p">()</span></code>

<a href="#votekit.election_state.ElectionState.status" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data frame displaying candidate, status (elected, eliminated,
remaining), and the round their status updated.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">      Data frame displaying candidate, status (elected, eliminated,</span>
<span class="sd">        remaining), and the round their status updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_cands</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
    <span class="n">status_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;Candidate&quot;</span><span class="p">:</span> <span class="n">all_cands</span><span class="p">,</span>
            <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Remaining&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_cands</span><span class="p">),</span>
            <span class="s2">&quot;Round&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_cands</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="nb">round</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_outcome</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">status</span><span class="p">,</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">tied_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="c1"># if tie</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">remaining_cands</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cand</span><span class="p">)))</span>
                        <span class="n">tied_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (tie with </span><span class="si">{</span><span class="n">remaining_cands</span><span class="si">}</span><span class="s2">)&quot;</span>

                    <span class="n">status_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">status_df</span><span class="p">[</span><span class="s2">&quot;Candidate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cand</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">status</span> <span class="o">+</span> <span class="n">tied_str</span>
                    <span class="p">)</span>
                    <span class="n">status_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">status_df</span><span class="p">[</span><span class="s2">&quot;Candidate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cand</span><span class="p">,</span> <span class="s2">&quot;Round&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span>

    <span class="k">return</span> <span class="n">status_df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.to_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_dict</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#votekit.election_state.ElectionState.to_dict" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Returns election results as a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>keep</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of information to store in dictionary, should be subset of
"elected", "eliminated", "remaining", "ranking". Defaults to empty list,
which stores all information.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns election results as a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        keep (list, optional): List of information to store in dictionary, should be subset of</span>
<span class="sd">            &quot;elected&quot;, &quot;eliminated&quot;, &quot;remaining&quot;, &quot;ranking&quot;. Defaults to empty list,</span>
<span class="sd">            which stores all information.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;elected&quot;</span><span class="p">,</span> <span class="s2">&quot;eliminated&quot;</span><span class="p">,</span> <span class="s2">&quot;remaining&quot;</span><span class="p">,</span> <span class="s2">&quot;ranking&quot;</span><span class="p">]</span>
    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winners</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eliminated</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankings</span><span class="p">(),</span>
    <span class="p">]</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">keep</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># pull out candidates from sets, if tied adds tuple of tied candidates</span>
        <span class="n">temp_lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cand_set</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cand_set</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">temp_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cand_set</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp_lst</span> <span class="o">+=</span> <span class="p">[</span><span class="n">cand</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cand_set</span><span class="p">]</span>
        <span class="n">rv</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_lst</span>

    <span class="k">return</span> <span class="n">rv</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.to_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#votekit.election_state.ElectionState.to_json" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Saves election state object as a JSON file:</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>keep</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of information to store in dictionary, should be subset of
"elected", "eliminated", "remaining", "ranking". Defaults to empty list,
which stores all information.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves election state object as a JSON file:</span>

<span class="sd">    Args:</span>
<span class="sd">        keep (list, optional): List of information to store in dictionary, should be subset of</span>
<span class="sd">            &quot;elected&quot;, &quot;eliminated&quot;, &quot;remaining&quot;, &quot;ranking&quot;. Defaults to empty list,</span>
<span class="sd">            which stores all information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">json_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="n">keep</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.election_state.ElectionState.winners" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">winners</span><span class="p">()</span></code>

<a href="#votekit.election_state.ElectionState.winners" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of elected candidates ordered from first round to current round.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/election_state.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">winners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">     A list of elected candidates ordered from first round to current round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elected</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.graphs.ballot_graph.BallotGraph" class="doc doc-heading">
          <code>BallotGraph</code>


<a href="#votekit.graphs.ballot_graph.BallotGraph" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.graphs.base_graph.Graph">Graph</span></code></p>

  
      <p>Class to build ballot graphs.</p>
<p><strong>Attributes</strong></p>
<p><code>source</code>
:   data to create graph from, either PreferenceProfile object, number of
        candidates, or list of candidates.</p>
<p><code>allow_partial</code>
:   if True, builds graph using all possible ballots,
    if False, only uses total linear ordered ballots.
    If building from a PreferenceProfile, defaults to True.</p>
<p><code>fix_short</code>
: if True, auto completes ballots of length n-1 to n.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BallotGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to build ballot graphs.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `source`</span>
<span class="sd">    :   data to create graph from, either PreferenceProfile object, number of</span>
<span class="sd">            candidates, or list of candidates.</span>

<span class="sd">    `allow_partial`</span>
<span class="sd">    :   if True, builds graph using all possible ballots,</span>
<span class="sd">        if False, only uses total linear ordered ballots.</span>
<span class="sd">        If building from a PreferenceProfile, defaults to True.</span>

<span class="sd">    `fix_short`</span>
<span class="sd">    : if True, auto completes ballots of length n-1 to n.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
        <span class="n">allow_partial</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">fix_short</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_partial</span> <span class="o">=</span> <span class="n">allow_partial</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_cands</span> <span class="o">=</span> <span class="n">source</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_cands</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">source</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">PreferenceProfile</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">source</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_cands</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_partial</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_profile</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">fix_short</span><span class="o">=</span><span class="n">fix_short</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="c1"># if no partial ballots allowed, create induced subgraph</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_partial</span><span class="p">:</span>
            <span class="n">total_ballots</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_cands</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">total_ballots</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">ballot</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_relabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gr</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="n">new_label</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_cands</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Relabels nodes in gr based on new_label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">graph_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">graph_nodes</span><span class="p">:</span>
            <span class="c1"># add the value of new_label to every entry in every ballot</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_label</span> <span class="o">+</span> <span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>

            <span class="c1"># reduce everything mod new_label</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">num_cands</span><span class="p">:</span>
                    <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">num_cands</span>
            <span class="n">node_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">new_label</span><span class="p">]</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">gr</span><span class="p">,</span> <span class="n">node_map</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>  <span class="c1"># ask Gabe about optimizing?</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds graph of all possible ballots given a number of candiates.</span>

<span class="sd">        Args:</span>
<span class="sd">            n: Number of candidates in an election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A networkx graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Gc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
        <span class="c1"># base cases</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>

        <span class="k">elif</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">G_prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># add the node for the bullet vote i</span>
                <span class="n">Gc</span><span class="o">.</span><span class="n">add_node</span><span class="p">((</span><span class="n">i</span><span class="p">,),</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># make the subgraph for the ballots where i is ranked first</span>
                <span class="n">G_corner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relabel</span><span class="p">(</span><span class="n">G_prev</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

                <span class="c1"># add the components from that graph to the larger graph</span>
                <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">G_corner</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

                <span class="c1"># connect the bullet vote node to the appropriate vertices</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
                        <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
                    <span class="p">)</span>

            <span class="n">nodes</span> <span class="o">=</span> <span class="n">Gc</span><span class="o">.</span><span class="n">nodes</span>

            <span class="n">new_edges</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">bal</span><span class="p">,</span> <span class="p">(</span><span class="n">bal</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">bal</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="k">for</span> <span class="n">bal</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bal</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
            <span class="p">]</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">new_edges</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Gc</span>

    <span class="k">def</span> <span class="nf">from_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">fix_short</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates existing graph based on cast ballots from a PreferenceProfile,</span>
<span class="sd">        or creates graph based on PreferenceProfile.</span>

<span class="sd">        Args:</span>
<span class="sd">            profile: PreferenceProfile assigned to graph.</span>


<span class="sd">        Returns:</span>
<span class="sd">            Graph based on PreferenceProfile, &#39;cast&#39; node attribute indicates</span>
<span class="sd">                    ballots cast in PreferenceProfile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">ballot</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
            <span class="n">ballot_node</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;ballots must be cleaned to resolve ties&quot;</span>
                    <span class="p">)</span>  <span class="c1"># still unsure about ties</span>
                <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">position</span><span class="p">:</span>
                    <span class="n">ballot_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span><span class="p">[</span><span class="n">cand</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">fix_short</span><span class="p">:</span>
                <span class="n">ballot_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_short_ballot</span><span class="p">(</span>
                    <span class="n">ballot_node</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)][</span><span class="s2">&quot;cast&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

    <span class="k">def</span> <span class="nf">fix_short_ballot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ballot</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds missing candidates to a short ballot.</span>

<span class="sd">        Args:</span>
<span class="sd">            ballot: A list of candidates on the ballot.</span>
<span class="sd">            candidates: A list of all candidates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new list with the missing candidates added to the end of the ballot.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ballot</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ballot</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">label_cands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns candidate labels to ballot graph for plotting.</span>

<span class="sd">        Args:</span>
<span class="sd">            candidates (list): A list of candidates.</span>
<span class="sd">            to_display: A Boolean callable that takes in a graph and node,</span>
<span class="sd">                        returns True if node should be displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">candidate_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>

        <span class="n">cand_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">candidate_numbers</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">cand_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
                <span class="n">ballot</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
                    <span class="n">ballot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand_dict</span><span class="p">[</span><span class="n">num</span><span class="p">])</span>

                <span class="c1"># label the ballot and give the number of votes</span>
                <span class="n">cand_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">cand_labels</span>

    <span class="k">def</span> <span class="nf">label_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns weight labels to ballot graph for plotting.</span>
<span class="sd">        Only shows weight if non-zero.</span>

<span class="sd">        Args:</span>
<span class="sd">            to_display: A Boolean callable that takes in a graph and node,</span>
<span class="sd">                        returns True if node should be displayed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
                <span class="c1"># label the ballot and give the number of votes</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">node_labels</span>

    <span class="nd">@cache</span>
    <span class="k">def</span> <span class="nf">_number_cands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cands</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns numerical marker to candidates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cands</span><span class="p">):</span>
            <span class="n">legend</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">legend</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">,</span>
        <span class="n">neighborhoods</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">show_cast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualize the graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            to_display: A boolean function that takes the graph and a node as input,</span>
<span class="sd">                returns True if you want that node displayed. Defaults to showing all nodes.</span>
<span class="sd">            neighborhoods: A list of neighborhoods to display, given as tuple (node, radius).</span>
<span class="sd">                            (ex. (n,1) gives all nodes within one step of n).</span>
<span class="sd">            show_cast: If True, show only nodes with &quot;cast&quot; attribute = True.</span>
<span class="sd">                        If False, show all nodes.</span>
<span class="sd">            labels: If True, labels nodes with candidate names and vote totals.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">cast_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;cast&quot;</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">in_neighborhoods</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
            <span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">neighborhoods</span><span class="p">]</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">neighborhoods</span><span class="p">]</span>

            <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">]</span>

            <span class="k">return</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">radii</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">show_cast</span><span class="p">:</span>
            <span class="n">to_display</span> <span class="o">=</span> <span class="n">cast_nodes</span>

        <span class="k">if</span> <span class="n">neighborhoods</span><span class="p">:</span>
            <span class="n">to_display</span> <span class="o">=</span> <span class="n">in_neighborhoods</span>

        <span class="n">ballots</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no candidate names assigned&quot;</span><span class="p">)</span>
            <span class="n">node_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_cands</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="n">to_display</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">node_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_weights</span><span class="p">(</span><span class="n">to_display</span><span class="p">)</span>

            <span class="c1"># if not labeling the nodes with candidates and graph is drawn from profile,</span>
            <span class="c1"># print labeling dictionary</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The candidates are labeled as follows.&quot;</span><span class="p">)</span>
                <span class="n">cand_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="n">cands</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">cand</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cand_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">cand</span><span class="p">)</span>

        <span class="n">subgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">ballots</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">subgraph</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">subgraph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">)</span>

        <span class="c1"># handles labels overlapping with margins</span>
        <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
        <span class="n">x_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
        <span class="n">y_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">x_min</span> <span class="o">-</span> <span class="n">x_margin</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">+</span> <span class="n">x_margin</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y_margin</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="n">y_margin</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.build_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_graph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.build_graph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Builds graph of all possible ballots given a number of candiates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of candidates in an election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="networkx.Graph">Graph</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A networkx graph.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>  <span class="c1"># ask Gabe about optimizing?</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds graph of all possible ballots given a number of candiates.</span>

<span class="sd">    Args:</span>
<span class="sd">        n: Number of candidates in an election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A networkx graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Gc</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="c1"># base cases</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>

    <span class="k">elif</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">G_prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># add the node for the bullet vote i</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_node</span><span class="p">((</span><span class="n">i</span><span class="p">,),</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># make the subgraph for the ballots where i is ranked first</span>
            <span class="n">G_corner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relabel</span><span class="p">(</span><span class="n">G_prev</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

            <span class="c1"># add the components from that graph to the larger graph</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">G_corner</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

            <span class="c1"># connect the bullet vote node to the appropriate vertices</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">G_corner</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="n">Gc</span><span class="o">.</span><span class="n">nodes</span>

        <span class="n">new_edges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">bal</span><span class="p">,</span> <span class="p">(</span><span class="n">bal</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">bal</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="k">for</span> <span class="n">bal</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bal</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
        <span class="p">]</span>
        <span class="n">Gc</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">new_edges</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Gc</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.draw" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">draw</span><span class="p">(</span><span class="n">to_display</span><span class="o">=</span><span class="n">all_nodes</span><span class="p">,</span> <span class="n">neighborhoods</span><span class="o">=</span><span class="p">[],</span> <span class="n">show_cast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.draw" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Visualize the graph.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>to_display</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A boolean function that takes the graph and a node as input,
returns True if you want that node displayed. Defaults to showing all nodes.</p>
            </div>
          </td>
          <td>
                <code><span title="votekit.graphs.ballot_graph.all_nodes">all_nodes</span></code>
          </td>
        </tr>
        <tr>
          <td><code>neighborhoods</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[list[tuple]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of neighborhoods to display, given as tuple (node, radius).
            (ex. (n,1) gives all nodes within one step of n).</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>show_cast</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show only nodes with "cast" attribute = True.
        If False, show all nodes.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, labels nodes with candidate names and vote totals.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">draw</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">,</span>
    <span class="n">neighborhoods</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">show_cast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        to_display: A boolean function that takes the graph and a node as input,</span>
<span class="sd">            returns True if you want that node displayed. Defaults to showing all nodes.</span>
<span class="sd">        neighborhoods: A list of neighborhoods to display, given as tuple (node, radius).</span>
<span class="sd">                        (ex. (n,1) gives all nodes within one step of n).</span>
<span class="sd">        show_cast: If True, show only nodes with &quot;cast&quot; attribute = True.</span>
<span class="sd">                    If False, show all nodes.</span>
<span class="sd">        labels: If True, labels nodes with candidate names and vote totals.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">cast_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;cast&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">in_neighborhoods</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">neighborhoods</span><span class="p">]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">neighborhoods</span><span class="p">]</span>

        <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">radii</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">show_cast</span><span class="p">:</span>
        <span class="n">to_display</span> <span class="o">=</span> <span class="n">cast_nodes</span>

    <span class="k">if</span> <span class="n">neighborhoods</span><span class="p">:</span>
        <span class="n">to_display</span> <span class="o">=</span> <span class="n">in_neighborhoods</span>

    <span class="n">ballots</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no candidate names assigned&quot;</span><span class="p">)</span>
        <span class="n">node_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_cands</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="n">to_display</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">node_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_weights</span><span class="p">(</span><span class="n">to_display</span><span class="p">)</span>

        <span class="c1"># if not labeling the nodes with candidates and graph is drawn from profile,</span>
        <span class="c1"># print labeling dictionary</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The candidates are labeled as follows.&quot;</span><span class="p">)</span>
            <span class="n">cand_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="n">cands</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">cand</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cand_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">cand</span><span class="p">)</span>

    <span class="n">subgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">ballots</span><span class="p">)</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">subgraph</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">subgraph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">)</span>

    <span class="c1"># handles labels overlapping with margins</span>
    <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
    <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
    <span class="n">x_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
    <span class="n">y_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">x_min</span> <span class="o">-</span> <span class="n">x_margin</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">+</span> <span class="n">x_margin</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y_margin</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="n">y_margin</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.fix_short_ballot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fix_short_ballot</span><span class="p">(</span><span class="n">ballot</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.fix_short_ballot" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Adds missing candidates to a short ballot.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ballot</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of candidates on the ballot.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>candidates</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of all candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new list with the missing candidates added to the end of the ballot.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_short_ballot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ballot</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds missing candidates to a short ballot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ballot: A list of candidates on the ballot.</span>
<span class="sd">        candidates: A list of all candidates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new list with the missing candidates added to the end of the ballot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ballot</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">ballot</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.from_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">fix_short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.from_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Updates existing graph based on cast ballots from a PreferenceProfile,
or creates graph based on PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile assigned to graph.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="networkx.Graph">Graph</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Graph based on PreferenceProfile, 'cast' node attribute indicates
    ballots cast in PreferenceProfile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">fix_short</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates existing graph based on cast ballots from a PreferenceProfile,</span>
<span class="sd">    or creates graph based on PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile: PreferenceProfile assigned to graph.</span>


<span class="sd">    Returns:</span>
<span class="sd">        Graph based on PreferenceProfile, &#39;cast&#39; node attribute indicates</span>
<span class="sd">                ballots cast in PreferenceProfile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_voters</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
    <span class="n">ballots</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">ballot</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="n">ballot_node</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;ballots must be cleaned to resolve ties&quot;</span>
                <span class="p">)</span>  <span class="c1"># still unsure about ties</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">position</span><span class="p">:</span>
                <span class="n">ballot_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span><span class="p">[</span><span class="n">cand</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">fix_short</span><span class="p">:</span>
            <span class="n">ballot_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_short_ballot</span><span class="p">(</span>
                <span class="n">ballot_node</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cand_num</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)][</span><span class="s2">&quot;cast&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_weights</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot_node</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.label_cands" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">label_cands</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">to_display</span><span class="o">=</span><span class="n">all_nodes</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.label_cands" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Assigns candidate labels to ballot graph for plotting.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>candidates</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>to_display</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Boolean callable that takes in a graph and node,
        returns True if node should be displayed.</p>
            </div>
          </td>
          <td>
                <code><span title="votekit.graphs.ballot_graph.all_nodes">all_nodes</span></code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">label_cands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns candidate labels to ballot graph for plotting.</span>

<span class="sd">    Args:</span>
<span class="sd">        candidates (list): A list of candidates.</span>
<span class="sd">        to_display: A Boolean callable that takes in a graph and node,</span>
<span class="sd">                    returns True if node should be displayed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">candidate_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_cands</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>

    <span class="n">cand_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">candidate_numbers</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">cand_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
            <span class="n">ballot</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
                <span class="n">ballot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand_dict</span><span class="p">[</span><span class="n">num</span><span class="p">])</span>

            <span class="c1"># label the ballot and give the number of votes</span>
            <span class="n">cand_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ballot</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">cand_labels</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.ballot_graph.BallotGraph.label_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">label_weights</span><span class="p">(</span><span class="n">to_display</span><span class="o">=</span><span class="n">all_nodes</span><span class="p">)</span></code>

<a href="#votekit.graphs.ballot_graph.BallotGraph.label_weights" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Assigns weight labels to ballot graph for plotting.
Only shows weight if non-zero.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>to_display</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Boolean callable that takes in a graph and node,
        returns True if node should be displayed.</p>
            </div>
          </td>
          <td>
                <code><span title="votekit.graphs.ballot_graph.all_nodes">all_nodes</span></code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/ballot_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">label_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_display</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">all_nodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns weight labels to ballot graph for plotting.</span>
<span class="sd">    Only shows weight if non-zero.</span>

<span class="sd">    Args:</span>
<span class="sd">        to_display: A Boolean callable that takes in a graph and node,</span>
<span class="sd">                    returns True if node should be displayed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">to_display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
            <span class="c1"># label the ballot and give the number of votes</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">node_labels</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph" class="doc doc-heading">
          <code>PairwiseComparisonGraph</code>


<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.graphs.base_graph.Graph">Graph</span></code></p>

  
      <p>Class to construct the pairwise comparison graph where nodes are candidates
and edges are pairwise preferences.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to construct graph from.</p>
<p><code>ballot_length</code>
:   (optional) max length of ballot, defaults to longest possible ballot length.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PairwiseComparisonGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to construct the pairwise comparison graph where nodes are candidates</span>
<span class="sd">    and edges are pairwise preferences.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to construct graph from.</span>

<span class="sd">    `ballot_length`</span>
<span class="sd">    :   (optional) max length of ballot, defaults to longest possible ballot length.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">ballot_length</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot_length</span> <span class="o">=</span> <span class="n">ballot_length</span>
        <span class="k">if</span> <span class="n">ballot_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">())</span>
        <span class="n">full_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_fill</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">full_profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_pairwise_dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_graph</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ballot_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">ballot_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fills incomplete ballots for pairwise comparison.</span>

<span class="sd">        Args:</span>
<span class="sd">            profile: PreferenceProfile to fill.</span>
<span class="sd">            ballot_length: How long a ballot is.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PreferenceProfile (PreferenceProfile): A PreferenceProfile with incomplete</span>
<span class="sd">                ballots filled in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cand_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">cand</span><span class="p">}</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()]</span>
        <span class="n">updated_ballot_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ballot_length</span><span class="p">:</span>
                <span class="n">missing_cands</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">cand</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cand_list</span> <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
                <span class="p">]</span>
                <span class="n">missing_cands_perms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">permutations</span><span class="p">(</span><span class="n">missing_cands</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_cands</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="n">frac_freq</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_cands_perms</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">missing_cands_perms</span><span class="p">:</span>
                    <span class="n">updated_rank</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">])</span>
                    <span class="n">updated_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
                        <span class="n">ranking</span><span class="o">=</span><span class="n">updated_rank</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">frac_freq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">updated_ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_ballot</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updated_ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">updated_ballot_list</span><span class="p">)</span>

    <span class="c1"># Helper functions to make pairwise comparison graph</span>
    <span class="k">def</span> <span class="nf">head2head_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cand1</span><span class="p">,</span> <span class="n">cand2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fraction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts head to head comparisons between two candidates. Note that the given order</span>
<span class="sd">        of the candidates matters here.</span>

<span class="sd">        Args:</span>
<span class="sd">            cand1 (str): The first candidate to compare.</span>
<span class="sd">            cand2 (str): The second candidate to compare.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A count of the number of times cand1 is preferred to cand2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ballots_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots_list</span><span class="p">:</span>
            <span class="n">rank_list</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">rank_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cand1</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">cand2</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute_pairwise_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs dictionary where keys are tuples (cand_a, cand_b) containing</span>
<span class="sd">        two candidates and values is the frequency cand_a is preferred to</span>
<span class="sd">        cand_b.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary with keys = (cand_a, cand_b) and values = frequency cand_a is preferred</span>
<span class="sd">                to cand_b.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pairwise_dict</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {(cand_a, cand_b): freq cand_a is preferred over cand_b}</span>
        <span class="n">cand_pairs</span> <span class="o">=</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">cand_pairs</span><span class="p">:</span>
            <span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">head_2_head_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">),</span>
                <span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">),</span>
            <span class="p">}</span>
            <span class="n">max_pair</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">head_2_head_dict</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">head_2_head_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">pairwise_dict</span><span class="p">[</span><span class="n">max_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">)</span>
                <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1">## would display x:y instead of abs(x-y)</span>
            <span class="c1"># winner, loser = max_pair[1]</span>
            <span class="c1"># pairwise_dict[max_pair[1]] = f&quot;{head_2_head_dict[(winner, loser)]}: \</span>
            <span class="c1"># {head_2_head_dict[(loser, winner)]}&quot;</span>

        <span class="k">return</span> <span class="n">pairwise_dict</span>

    <span class="k">def</span> <span class="nf">build_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the networkx pairwise comparison graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The networkx digraph representing the pairwise comparison graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">G</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draws pairwise comparison graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            outfile (str): The filepath to save the graph. Defaults to not saving.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span>
            <span class="n">G</span><span class="p">,</span>
            <span class="n">pos</span><span class="p">,</span>
            <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
            <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span>
            <span class="n">edgelist</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
            <span class="n">G</span><span class="p">,</span>
            <span class="n">pos</span><span class="p">,</span>
            <span class="n">edgelist</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">arrowsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()}</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
            <span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span>
        <span class="p">)</span>
        <span class="c1"># Out stuff</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># More complicated Requests</span>
    <span class="k">def</span> <span class="nf">has_condorcet_winner</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if graph has a condorcet winner.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if condorcet winner exists, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_condorcet_winner</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the condorcet winner. Raises a ValueError if no condorcet winner.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The condorcet winner.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_condorcet_winner</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There is no condorcet winner.&quot;</span><span class="p">)</span>

    <span class="nd">@cache</span>
    <span class="k">def</span> <span class="nf">dominating_tiers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds dominating tiers within an election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of dominating tiers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">beat_set_size_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">):</span>
            <span class="n">beat_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">other_cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nx</span><span class="o">.</span><span class="n">has_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span><span class="p">,</span> <span class="n">cand</span><span class="p">,</span> <span class="n">other_cand</span><span class="p">):</span>
                        <span class="n">beat_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other_cand</span><span class="p">)</span>
            <span class="n">beat_set_size_dict</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">beat_set</span><span class="p">)</span>

        <span class="c1"># We want to return candidates sorted and grouped by beat set size</span>
        <span class="n">tier_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">beat_set_size_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">}</span>
        <span class="n">tier_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tier_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">tier_list</span>

    <span class="k">def</span> <span class="nf">has_condorcet_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if graph has any condorcet cycles, which we define as any cycle of length</span>
<span class="sd">            greater than 2 in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if condorcet cycles exists, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_condorcet_cycles</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@cache</span>
    <span class="k">def</span> <span class="nf">get_condorcet_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of condorcet cycles in the graph, which we define as any cycle of length</span>
<span class="sd">            greater than 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of condorcet cycles sorted by length.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span>
        <span class="n">list_of_cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">recursive_simple_cycles</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_of_cycles</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.ballot_fill" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ballot_fill</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_length</span><span class="p">)</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.ballot_fill" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fills incomplete ballots for pairwise comparison.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile to fill.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballot_length</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How long a ballot is.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>PreferenceProfile</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile with incomplete
ballots filled in.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ballot_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">ballot_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fills incomplete ballots for pairwise comparison.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile: PreferenceProfile to fill.</span>
<span class="sd">        ballot_length: How long a ballot is.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PreferenceProfile (PreferenceProfile): A PreferenceProfile with incomplete</span>
<span class="sd">            ballots filled in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cand_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">cand</span><span class="p">}</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()]</span>
    <span class="n">updated_ballot_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ballot_length</span><span class="p">:</span>
            <span class="n">missing_cands</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">cand</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cand_list</span> <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
            <span class="p">]</span>
            <span class="n">missing_cands_perms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">permutations</span><span class="p">(</span><span class="n">missing_cands</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_cands</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">frac_freq</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_cands_perms</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">missing_cands_perms</span><span class="p">:</span>
                <span class="n">updated_rank</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">])</span>
                <span class="n">updated_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="n">updated_rank</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">frac_freq</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">updated_ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_ballot</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">updated_ballot_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.build_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_graph</span><span class="p">()</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.build_graph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Builds the networkx pairwise comparison graph.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="networkx.DiGraph">DiGraph</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The networkx digraph representing the pairwise comparison graph.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the networkx pairwise comparison graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The networkx digraph representing the pairwise comparison graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.compute_pairwise_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_pairwise_dict</span><span class="p">()</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.compute_pairwise_dict" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Constructs dictionary where keys are tuples (cand_a, cand_b) containing
two candidates and values is the frequency cand_a is preferred to
cand_b.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with keys = (cand_a, cand_b) and values = frequency cand_a is preferred
to cand_b.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_pairwise_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs dictionary where keys are tuples (cand_a, cand_b) containing</span>
<span class="sd">    two candidates and values is the frequency cand_a is preferred to</span>
<span class="sd">    cand_b.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with keys = (cand_a, cand_b) and values = frequency cand_a is preferred</span>
<span class="sd">            to cand_b.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pairwise_dict</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {(cand_a, cand_b): freq cand_a is preferred over cand_b}</span>
    <span class="n">cand_pairs</span> <span class="o">=</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">cand_pairs</span><span class="p">:</span>
        <span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">head_2_head_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">),</span>
            <span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">max_pair</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">head_2_head_dict</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">head_2_head_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">pairwise_dict</span><span class="p">[</span><span class="n">max_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_a</span><span class="p">,</span> <span class="n">cand_b</span><span class="p">)</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand_b</span><span class="p">,</span> <span class="n">cand_a</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1">## would display x:y instead of abs(x-y)</span>
        <span class="c1"># winner, loser = max_pair[1]</span>
        <span class="c1"># pairwise_dict[max_pair[1]] = f&quot;{head_2_head_dict[(winner, loser)]}: \</span>
        <span class="c1"># {head_2_head_dict[(loser, winner)]}&quot;</span>

    <span class="k">return</span> <span class="n">pairwise_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.dominating_tiers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dominating_tiers</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.dominating_tiers" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Finds dominating tiers within an election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of dominating tiers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@cache</span>
<span class="k">def</span> <span class="nf">dominating_tiers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds dominating tiers within an election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of dominating tiers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">beat_set_size_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">):</span>
        <span class="n">beat_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">other_cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nx</span><span class="o">.</span><span class="n">has_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span><span class="p">,</span> <span class="n">cand</span><span class="p">,</span> <span class="n">other_cand</span><span class="p">):</span>
                    <span class="n">beat_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other_cand</span><span class="p">)</span>
        <span class="n">beat_set_size_dict</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">beat_set</span><span class="p">)</span>

    <span class="c1"># We want to return candidates sorted and grouped by beat set size</span>
    <span class="n">tier_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">beat_set_size_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">}</span>
    <span class="n">tier_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tier_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">tier_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.draw" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">draw</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.draw" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Draws pairwise comparison graph.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>outfile</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The filepath to save the graph. Defaults to not saving.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws pairwise comparison graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        outfile (str): The filepath to save the graph. Defaults to not saving.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span>
        <span class="n">G</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">,</span>
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span>
        <span class="n">edgelist</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
        <span class="n">G</span><span class="p">,</span>
        <span class="n">pos</span><span class="p">,</span>
        <span class="n">edgelist</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">arrowsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()}</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
        <span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span>
    <span class="p">)</span>
    <span class="c1"># Out stuff</span>
    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_cycles" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_condorcet_cycles</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_cycles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Returns a list of condorcet cycles in the graph, which we define as any cycle of length
    greater than 2.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of condorcet cycles sorted by length.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@cache</span>
<span class="k">def</span> <span class="nf">get_condorcet_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of condorcet cycles in the graph, which we define as any cycle of length</span>
<span class="sd">        greater than 2.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of condorcet cycles sorted by length.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pairwise_graph</span>
    <span class="n">list_of_cycles</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">recursive_simple_cycles</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_of_cycles</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_winner" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_condorcet_winner</span><span class="p">()</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.get_condorcet_winner" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Returns the condorcet winner. Raises a ValueError if no condorcet winner.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The condorcet winner.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_condorcet_winner</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the condorcet winner. Raises a ValueError if no condorcet winner.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The condorcet winner.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_condorcet_winner</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There is no condorcet winner.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_cycles" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">has_condorcet_cycles</span><span class="p">()</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_cycles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Checks if graph has any condorcet cycles, which we define as any cycle of length
    greater than 2 in the graph.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if condorcet cycles exists, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_condorcet_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if graph has any condorcet cycles, which we define as any cycle of length</span>
<span class="sd">        greater than 2 in the graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if condorcet cycles exists, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_condorcet_cycles</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_winner" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">has_condorcet_winner</span><span class="p">()</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.has_condorcet_winner" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Checks if graph has a condorcet winner.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if condorcet winner exists, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_condorcet_winner</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if graph has a condorcet winner.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if condorcet winner exists, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.head2head_count" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">head2head_count</span><span class="p">(</span><span class="n">cand1</span><span class="p">,</span> <span class="n">cand2</span><span class="p">)</span></code>

<a href="#votekit.graphs.pairwise_comparison_graph.PairwiseComparisonGraph.head2head_count" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Counts head to head comparisons between two candidates. Note that the given order
of the candidates matters here.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cand1</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first candidate to compare.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cand2</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second candidate to compare.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="fractions.Fraction">Fraction</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A count of the number of times cand1 is preferred to cand2.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/graphs/pairwise_comparison_graph.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">head2head_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cand1</span><span class="p">,</span> <span class="n">cand2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fraction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts head to head comparisons between two candidates. Note that the given order</span>
<span class="sd">    of the candidates matters here.</span>

<span class="sd">    Args:</span>
<span class="sd">        cand1 (str): The first candidate to compare.</span>
<span class="sd">        cand2 (str): The second candidate to compare.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A count of the number of times cand1 is preferred to cand2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ballots_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots_list</span><span class="p">:</span>
        <span class="n">rank_list</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">rank_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cand1</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">cand2</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="cvr-loaders">CVR Loaders<a class="headerlink" href="#cvr-loaders" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.cvr_loaders.load_csv" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_csv</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">rank_cols</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="p">,</span> <span class="n">weight_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#votekit.cvr_loaders.load_csv" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given a file path, loads cast vote records (cvr) with ranks as columns and voters as rows.
Empty cells are treated as None.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fpath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to cvr file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rank_cols</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of column indexes that contain rankings. Indexing starts from 0,
        in order from top to bottom rank.
        Default implies that all columns contain rankings.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>weight_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column position for ballot weights.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>delimiter</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The character that breaks up rows.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>id_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index for the column with voter ids.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>FileNotFoundError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If fpath is invalid.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="pandas.errors.EmptyDataError">EmptyDataError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If dataset is empty.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the voter id column has missing values.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="pandas.errors.DataError">DataError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the voter id column has duplicate values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile that represents all the ballots in the election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cvr_loaders.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_csv</span><span class="p">(</span>
    <span class="n">fpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">rank_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">weight_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">id_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a file path, loads cast vote records (cvr) with ranks as columns and voters as rows.</span>
<span class="sd">    Empty cells are treated as None.</span>

<span class="sd">    Args:</span>
<span class="sd">        fpath: Path to cvr file.</span>
<span class="sd">        rank_cols: List of column indexes that contain rankings. Indexing starts from 0,</span>
<span class="sd">                    in order from top to bottom rank.</span>
<span class="sd">                    Default implies that all columns contain rankings.</span>
<span class="sd">        weight_col: The column position for ballot weights.</span>
<span class="sd">        delimiter: The character that breaks up rows.</span>
<span class="sd">        id_col: Index for the column with voter ids.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If fpath is invalid.</span>
<span class="sd">        EmptyDataError: If dataset is empty.</span>
<span class="sd">        ValueError: If the voter id column has missing values.</span>
<span class="sd">        DataError: If the voter id column has duplicate values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A PreferenceProfile that represents all the ballots in the election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fpath</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File with path </span><span class="si">{</span><span class="n">fpath</span><span class="si">}</span><span class="s2"> cannot be found&quot;</span><span class="p">)</span>

    <span class="n">cvr_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">cvr_path</span><span class="p">,</span>
        <span class="n">on_bad_lines</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">,</span>
        <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EmptyDataError</span><span class="p">(</span><span class="s2">&quot;Dataset cannot be empty&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">id_col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing value(s) in column at index </span><span class="si">{</span><span class="n">id_col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">id_col</span><span class="p">]</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicate value(s) in column at index </span><span class="si">{</span><span class="n">id_col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rank_cols</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">id_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">rank_cols</span> <span class="o">+</span> <span class="p">[</span><span class="n">id_col</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">rank_cols</span><span class="p">]</span>

    <span class="n">ranks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ranks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">id_col</span><span class="p">])</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">group_df</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="kc">None</span><span class="p">})</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">else</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">c</span><span class="p">})</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">voter_set</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">id_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">voter_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">group_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">id_col</span><span class="p">])</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_df</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weight_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">group_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">weight_col</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">weight</span><span class="p">),</span> <span class="n">voter_set</span><span class="o">=</span><span class="n">voter_set</span><span class="p">)</span>
        <span class="n">ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.cvr_loaders.load_scottish" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_scottish</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span></code>

<a href="#votekit.cvr_loaders.load_scottish" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given a file path, loads cvr from format used for Scottish election data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fpath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to cvr file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>FileNotFoundError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If fpath is invalid.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="pandas.errors.EmptyDataError">EmptyDataError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If dataset is empty.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="pandas.errors.DataError">DataError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there is missing or incorrect metadata or candidate data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple (PreferenceProfile, seats) representing the election and the
    number of seats in the election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cvr_loaders.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_scottish</span><span class="p">(</span><span class="n">fpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a file path, loads cvr from format used for Scottish election data.</span>

<span class="sd">    Args:</span>
<span class="sd">        fpath: Path to cvr file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If fpath is invalid.</span>
<span class="sd">        EmptyDataError: If dataset is empty.</span>
<span class="sd">        DataError: If there is missing or incorrect metadata or candidate data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): A tuple (PreferenceProfile, seats) representing the election and the</span>
<span class="sd">                number of seats in the election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">name_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">cands_included</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fpath</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File with path </span><span class="si">{</span><span class="n">fpath</span><span class="si">}</span><span class="s2"> cannot be found&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EmptyDataError</span><span class="p">(</span><span class="s2">&quot;Dataset cannot be empty&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># first number is number of candidates, second is number of seats to elect</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span>
                        <span class="s2">&quot;metadata (first line) should have two parameters&quot;</span>
                        <span class="s2">&quot; (number of candidates, number of seats)&quot;</span>
                    <span class="p">)</span>
                <span class="n">seats</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># read in ballots, cleaning out rankings labeled &#39;0&#39; (designating end of line)</span>
            <span class="k">elif</span> <span class="n">numbers</span><span class="p">:</span>
                <span class="n">ballot</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">vote</span><span class="p">)</span> <span class="k">for</span> <span class="n">vote</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
                <span class="n">num_votes</span> <span class="o">=</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1"># ballots terminate with a single row with the character &#39;0&#39;</span>
                <span class="k">if</span> <span class="n">num_votes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">numbers</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="n">rank</span> <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="k">if</span> <span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">ranking</span><span class="p">,</span> <span class="n">num_votes</span><span class="p">)</span>
                    <span class="n">ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># this is converted to the PP format later</span>
            <span class="c1"># read in candidates</span>
            <span class="k">elif</span> <span class="s2">&quot;(&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">cands_included</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">name_parts</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">last_name</span> <span class="o">=</span> <span class="n">name_parts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">party</span> <span class="o">=</span> <span class="n">name_parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">,</span> <span class="n">party</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">err_message</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Number of candidates listed, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; differs from&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;number of candidates recorded in metadata, </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="n">err_message</span><span class="p">)</span>
                <span class="c1"># read in election location (do we need this?)</span>
                <span class="c1"># location = s.strip(&quot;\&quot;&quot;)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">cands_included</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="s2">&quot;Candidates missing from file&quot;</span><span class="p">)</span>
                <span class="c1"># map candidate numbers onto their names and convert ballots to PP format</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
                    <span class="n">name_map</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
                <span class="n">clean_ballots</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">Ballot</span><span class="p">(</span>
                        <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span>
                            <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">name_map</span><span class="p">[</span><span class="n">cand</span><span class="p">]})</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                        <span class="p">),</span>
                        <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span>
                <span class="p">]</span>

        <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">clean_ballots</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="n">names</span><span class="p">),</span> <span class="n">seats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="ballot-generators">Ballot Generators<a class="headerlink" href="#ballot-generators" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.BallotGenerator" class="doc doc-heading">
          <code>BallotGenerator</code>


<a href="#votekit.ballot_generator.BallotGenerator" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Base class for ballot generation models that use the candidate simplex
(e.g. Plackett-Luce, Bradley-Terry, etc.).</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
:   list of candidates in the election.</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries mapping of bloc to cohesion parameters.
    (ex. {bloc_1: {bloc_1: .7, bloc_2: .2, bloc_3:.1}})</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: voter proportion}).</p>
<details class="note" open="open">
<summary>Note</summary>
<ul>
<li>Voter proportion for blocs must sum to 1.</li>
<li>Preference interval for candidates must sum to 1.</li>
<li>Must have same blocs in <code>pref_intervals_by_bloc</code> and <code>bloc_voter_prop</code>.</li>
</ul>
</details>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BallotGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for ballot generation models that use the candidate simplex</span>
<span class="sd">    (e.g. Plackett-Luce, Bradley-Terry, etc.).</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    :   list of candidates in the election.</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries mapping of bloc to cohesion parameters.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1: .7, bloc_2: .2, bloc_3:.1}})</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: voter proportion}).</span>


<span class="sd">    ???+ note</span>
<span class="sd">        * Voter proportion for blocs must sum to 1.</span>
<span class="sd">        * Preference interval for candidates must sum to 1.</span>
<span class="sd">        * Must have same blocs in `pref_intervals_by_bloc` and `bloc_voter_prop`.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;candidates&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;slate_to_candidates&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;At least one of candidates or slate_to_candidates must be provided.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;candidates&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;candidates&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;slate_to_candidates&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;slate_to_candidates&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">c</span> <span class="k">for</span> <span class="n">c_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c_list</span>
            <span class="p">]</span>

        <span class="n">nec_parameters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;pref_intervals_by_bloc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cohesion_parameters&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bloc_voter_prop&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nec_parameters</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nec_parameters</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;If one of </span><span class="si">{</span><span class="n">nec_parameters</span><span class="si">}</span><span class="s2"> is provided, all must be provided.&quot;</span>
                <span class="p">)</span>

            <span class="n">bloc_voter_prop</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bloc_voter_prop&quot;</span><span class="p">]</span>
            <span class="n">pref_intervals_by_bloc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pref_intervals_by_bloc&quot;</span><span class="p">]</span>
            <span class="n">cohesion_parameters</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cohesion_parameters&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">8</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Voter proportion for blocs must sum to 1&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">pref_intervals_by_bloc</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Blocs are not the same between bloc_voter_prop and pref_intervals_by_bloc.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">cohesion_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Blocs are not the same between bloc_voter_prop and cohesion_parameters.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">pref_intervals_by_bloc</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">cohesion_parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Blocs are not the same between pref_intervals_by_bloc and cohesion_parameters.&quot;</span>
                <span class="p">)</span>

            <span class="k">for</span> <span class="n">bloc</span><span class="p">,</span> <span class="n">cohesion_parameter_dict</span> <span class="ow">in</span> <span class="n">cohesion_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">cohesion_parameter_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">8</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cohesion parameters for bloc </span><span class="si">{</span><span class="n">bloc</span><span class="si">}</span><span class="s2"> must sum to 1.&quot;</span>
                    <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span> <span class="o">=</span> <span class="n">pref_intervals_by_bloc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span> <span class="o">=</span> <span class="n">bloc_voter_prop</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span> <span class="o">=</span> <span class="n">cohesion_parameters</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_params</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">slate_to_candidates</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">bloc_voter_prop</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">alphas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a BallotGenerator by constructing a preference interval</span>
<span class="sd">        from parameters; the prior parameters (if inputted) will be overwritten.</span>

<span class="sd">        Args:</span>
<span class="sd">            slate_to_candidates (dict): A mapping of blocs to candidates</span>
<span class="sd">                (ex. {bloc: [candidate]})</span>
<span class="sd">            bloc_voter_prop (dict): A mapping of the percentage of total voters</span>
<span class="sd">                 per bloc (ex. {bloc: 0.7})</span>
<span class="sd">            cohesion_parameters (dict): Cohension factors for each bloc (ex. {bloc_1: {bloc_1: .9,</span>
<span class="sd">                                                                                        bloc_2:.1})</span>
<span class="sd">            alphas (dict): Alpha for the Dirichlet distribution of each bloc</span>
<span class="sd">                            (ex. {bloc: {bloc: 1, opposing_bloc: 1/2}}).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the voter proportion for blocs don&#39;t sum to 1.</span>
<span class="sd">            ValueError: Blocs are not the same.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (BallotGenerator): Initialized ballot generator.</span>

<span class="sd">        ???+ note</span>
<span class="sd">            * Voter proportion for blocs must sum to 1.</span>
<span class="sd">            * Each cohesion parameter must be in the interval [0,1].</span>
<span class="sd">            * Dirichlet parameters are in the interval $(0,\infty)$.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">8</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Voter proportion for blocs must sum to 1&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Blocs are not the same&quot;</span><span class="p">)</span>

        <span class="n">pref_intervals_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">current_bloc</span> <span class="ow">in</span> <span class="n">bloc_voter_prop</span><span class="p">:</span>
            <span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bloc_voter_prop</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">PreferenceInterval</span><span class="o">.</span><span class="n">from_dirichlet</span><span class="p">(</span>
                    <span class="n">candidates</span><span class="o">=</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">current_bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">interval</span>

            <span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">current_bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">intervals</span>

        <span class="k">if</span> <span class="s2">&quot;candidates&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">cands</span> <span class="o">=</span> <span class="p">[</span><span class="n">cand</span> <span class="k">for</span> <span class="n">cands</span> <span class="ow">in</span> <span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;candidates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cands</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pref_intervals_by_bloc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pref_intervals_by_bloc</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bloc_voter_prop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bloc_voter_prop</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;cohesion_parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohesion_parameters</span>

        <span class="k">if</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">AlternatingCrossover</span><span class="p">,</span>
            <span class="n">slate_PlackettLuce</span><span class="p">,</span>
            <span class="n">slate_BradleyTerry</span><span class="p">,</span>
            <span class="n">CambridgeSampler</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
                <span class="n">slate_to_candidates</span><span class="o">=</span><span class="n">slate_to_candidates</span><span class="p">,</span>
                <span class="o">**</span><span class="n">data</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">generator</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a `PreferenceProfile`.</span>

<span class="sd">        Args:</span>
<span class="sd">            number_of_ballots (int): Number of ballots to generate.</span>
<span class="sd">            by_bloc (bool): True if you want a tuple (pp_by_bloc, pp), which is a dictionary of</span>
<span class="sd">                            PreferenceProfiles with keys = blocs and the aggregated profile.</span>
<span class="sd">                    False if you want the aggregated profile. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (PreferenceProfile): A generated `PreferenceProfile`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_round_num</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rounds up or down a float randomly.</span>

<span class="sd">        Args:</span>
<span class="sd">            num (float): Number to round.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: A whole number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">if</span> <span class="n">rand</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a list of ballots and candidates, convert them into a `PreferenceProfile.`</span>

<span class="sd">        Args:</span>
<span class="sd">            ballot_pool (list of tuple): A list of ballots, where each ballot is a tuple</span>
<span class="sd">                    of candidates indicating their ranking from top to bottom.</span>
<span class="sd">            candidates (list): A list of candidates.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (PreferenceProfile): A PreferenceProfile representing the ballots in the election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking_counts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ballot_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">ballot_pool</span><span class="p">:</span>
            <span class="n">tuple_rank</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
            <span class="n">ranking_counts</span><span class="p">[</span><span class="n">tuple_rank</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ranking_counts</span><span class="p">[</span><span class="n">tuple_rank</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tuple_rank</span> <span class="ow">in</span> <span class="n">ranking_counts</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">ranking_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">cand</span><span class="p">])</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">])</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
            <span class="n">ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_list</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="n">candidates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotGenerator.ballot_pool_to_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#votekit.ballot_generator.BallotGenerator.ballot_pool_to_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Given a list of ballots and candidates, convert them into a <code>PreferenceProfile.</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ballot_pool</code></td>
          <td>
                <code>list of tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of ballots, where each ballot is a tuple
    of candidates indicating their ranking from top to bottom.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>candidates</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile representing the ballots in the election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a list of ballots and candidates, convert them into a `PreferenceProfile.`</span>

<span class="sd">    Args:</span>
<span class="sd">        ballot_pool (list of tuple): A list of ballots, where each ballot is a tuple</span>
<span class="sd">                of candidates indicating their ranking from top to bottom.</span>
<span class="sd">        candidates (list): A list of candidates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A PreferenceProfile representing the ballots in the election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ranking_counts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ballot_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">ballot_pool</span><span class="p">:</span>
        <span class="n">tuple_rank</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">ranking_counts</span><span class="p">[</span><span class="n">tuple_rank</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ranking_counts</span><span class="p">[</span><span class="n">tuple_rank</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tuple_rank</span> <span class="ow">in</span> <span class="n">ranking_counts</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">ranking_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">cand</span><span class="p">])</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
        <span class="n">ballot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_list</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="n">candidates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotGenerator.from_params" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_params</span><span class="p">(</span><span class="n">slate_to_candidates</span><span class="p">,</span> <span class="n">bloc_voter_prop</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#votekit.ballot_generator.BallotGenerator.from_params" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Initializes a BallotGenerator by constructing a preference interval
from parameters; the prior parameters (if inputted) will be overwritten.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>slate_to_candidates</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of blocs to candidates
(ex. {bloc: [candidate]})</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bloc_voter_prop</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of the percentage of total voters
 per bloc (ex. {bloc: 0.7})</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cohesion_parameters</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cohension factors for each bloc (ex. {bloc_1: {bloc_1: .9,
                                                                        bloc_2:.1})</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>alphas</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha for the Dirichlet distribution of each bloc
            (ex. {bloc: {bloc: 1, opposing_bloc: 1/2}}).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the voter proportion for blocs don't sum to 1.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blocs are not the same.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialized ballot generator.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <details class="note" open="open">
<summary>Note</summary>
<ul>
<li>Voter proportion for blocs must sum to 1.</li>
<li>Each cohesion parameter must be in the interval [0,1].</li>
<li>Dirichlet parameters are in the interval <span class="arithmatex">\((0,\infty)\)</span>.</li>
</ul>
</details>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_params</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">slate_to_candidates</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">bloc_voter_prop</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">alphas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a BallotGenerator by constructing a preference interval</span>
<span class="sd">    from parameters; the prior parameters (if inputted) will be overwritten.</span>

<span class="sd">    Args:</span>
<span class="sd">        slate_to_candidates (dict): A mapping of blocs to candidates</span>
<span class="sd">            (ex. {bloc: [candidate]})</span>
<span class="sd">        bloc_voter_prop (dict): A mapping of the percentage of total voters</span>
<span class="sd">             per bloc (ex. {bloc: 0.7})</span>
<span class="sd">        cohesion_parameters (dict): Cohension factors for each bloc (ex. {bloc_1: {bloc_1: .9,</span>
<span class="sd">                                                                                    bloc_2:.1})</span>
<span class="sd">        alphas (dict): Alpha for the Dirichlet distribution of each bloc</span>
<span class="sd">                        (ex. {bloc: {bloc: 1, opposing_bloc: 1/2}}).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the voter proportion for blocs don&#39;t sum to 1.</span>
<span class="sd">        ValueError: Blocs are not the same.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (BallotGenerator): Initialized ballot generator.</span>

<span class="sd">    ???+ note</span>
<span class="sd">        * Voter proportion for blocs must sum to 1.</span>
<span class="sd">        * Each cohesion parameter must be in the interval [0,1].</span>
<span class="sd">        * Dirichlet parameters are in the interval $(0,\infty)$.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">8</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Voter proportion for blocs must sum to 1&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Blocs are not the same&quot;</span><span class="p">)</span>

    <span class="n">pref_intervals_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">current_bloc</span> <span class="ow">in</span> <span class="n">bloc_voter_prop</span><span class="p">:</span>
        <span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bloc_voter_prop</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">PreferenceInterval</span><span class="o">.</span><span class="n">from_dirichlet</span><span class="p">(</span>
                <span class="n">candidates</span><span class="o">=</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphas</span><span class="p">[</span><span class="n">current_bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">interval</span>

        <span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">current_bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">intervals</span>

    <span class="k">if</span> <span class="s2">&quot;candidates&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">cands</span> <span class="o">=</span> <span class="p">[</span><span class="n">cand</span> <span class="k">for</span> <span class="n">cands</span> <span class="ow">in</span> <span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;candidates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cands</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pref_intervals_by_bloc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pref_intervals_by_bloc</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bloc_voter_prop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bloc_voter_prop</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;cohesion_parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohesion_parameters</span>

    <span class="k">if</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="n">AlternatingCrossover</span><span class="p">,</span>
        <span class="n">slate_PlackettLuce</span><span class="p">,</span>
        <span class="n">slate_BradleyTerry</span><span class="p">,</span>
        <span class="n">CambridgeSampler</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">slate_to_candidates</span><span class="o">=</span><span class="n">slate_to_candidates</span><span class="p">,</span>
            <span class="o">**</span><span class="n">data</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">generator</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotGenerator.generate_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#votekit.ballot_generator.BallotGenerator.generate_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Generates a <code>PreferenceProfile</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>number_of_ballots</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ballots to generate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>by_bloc</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if you want a tuple (pp_by_bloc, pp), which is a dictionary of
            PreferenceProfiles with keys = blocs and the aggregated profile.
    False if you want the aggregated profile. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A generated <code>PreferenceProfile</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a `PreferenceProfile`.</span>

<span class="sd">    Args:</span>
<span class="sd">        number_of_ballots (int): Number of ballots to generate.</span>
<span class="sd">        by_bloc (bool): True if you want a tuple (pp_by_bloc, pp), which is a dictionary of</span>
<span class="sd">                        PreferenceProfiles with keys = blocs and the aggregated profile.</span>
<span class="sd">                False if you want the aggregated profile. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A generated `PreferenceProfile`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.BallotSimplex" class="doc doc-heading">
          <code>BallotSimplex</code>


<a href="#votekit.ballot_generator.BallotSimplex" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Base class for ballot generation models that use the ballot simplex
(e.g. ImpartialCulture, ImpartialAnonymousCulture).</p>
<p><strong>Attributes</strong></p>
<p><code>alpha</code>
:   (float) alpha parameter for ballot simplex. Defaults to None.</p>
<p><code>point</code>
:   dictionary representing a point in the ballot simplex with candidate as
    keys and electoral support as values. Defaults to None.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>Point or alpha arguments must be included to initialize.</p>
</details>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BallotSimplex</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for ballot generation models that use the ballot simplex</span>
<span class="sd">    (e.g. ImpartialCulture, ImpartialAnonymousCulture).</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `alpha`</span>
<span class="sd">    :   (float) alpha parameter for ballot simplex. Defaults to None.</span>

<span class="sd">    `point`</span>
<span class="sd">    :   dictionary representing a point in the ballot simplex with candidate as</span>
<span class="sd">        keys and electoral support as values. Defaults to None.</span>

<span class="sd">    ???+ note</span>

<span class="sd">        Point or alpha arguments must be included to initialize.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;point or alpha must be initialized&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e20</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e-10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_point</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a Ballot Simplex model from a point in the Dirichlet distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            point (dict): A mapping of candidate to candidate support.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the candidate support does not sum to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (BallotSimplex): Initialized from point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;probability distribution from point (</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="si">}</span><span class="s2">) does not sum to 1&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_alpha</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a Ballot Simplex model from an alpha value for the Dirichlet</span>
<span class="sd">        distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            alpha (float): An alpha parameter for the Dirichlet distribution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (BallotSimplex): Initialized from alpha.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a PreferenceProfile from the ballot simplex.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">perm_set</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>

        <span class="n">perm_rankings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">perm_set</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm_rankings</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">:</span>
            <span class="c1"># calculates probabilities for each ranking</span>
            <span class="c1"># using probability distribution for candidate support</span>
            <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reduce</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">prod</span><span class="p">,</span> <span class="n">cand</span><span class="p">:</span> <span class="n">prod</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="n">ranking</span><span class="p">,</span>
                    <span class="mf">1.0</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">perm_rankings</span>
            <span class="p">]</span>
            <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">prob</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">draw_probabilities</span><span class="p">)</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">draw_probabilities</span>
            <span class="p">]</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">perm_rankings</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">draw_probabilities</span>
        <span class="p">)</span>
        <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">perm_rankings</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">)]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotSimplex.from_alpha" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#votekit.ballot_generator.BallotSimplex.from_alpha" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Initializes a Ballot Simplex model from an alpha value for the Dirichlet
distribution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An alpha parameter for the Dirichlet distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotSimplex" href="#votekit.ballot_generator.BallotSimplex">BallotSimplex</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialized from alpha.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_alpha</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a Ballot Simplex model from an alpha value for the Dirichlet</span>
<span class="sd">    distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        alpha (float): An alpha parameter for the Dirichlet distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (BallotSimplex): Initialized from alpha.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotSimplex.from_point" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_point</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#votekit.ballot_generator.BallotSimplex.from_point" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Initializes a Ballot Simplex model from a point in the Dirichlet distribution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>point</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of candidate to candidate support.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the candidate support does not sum to 1.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotSimplex" href="#votekit.ballot_generator.BallotSimplex">BallotSimplex</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialized from point.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_point</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a Ballot Simplex model from a point in the Dirichlet distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        point (dict): A mapping of candidate to candidate support.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the candidate support does not sum to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (BallotSimplex): Initialized from point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;probability distribution from point (</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="si">}</span><span class="s2">) does not sum to 1&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.BallotSimplex.generate_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.ballot_generator.BallotSimplex.generate_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Generates a PreferenceProfile from the ballot simplex.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a PreferenceProfile from the ballot simplex.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">perm_set</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">))</span>

    <span class="n">perm_rankings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">perm_set</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm_rankings</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">:</span>
        <span class="c1"># calculates probabilities for each ranking</span>
        <span class="c1"># using probability distribution for candidate support</span>
        <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">reduce</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">prod</span><span class="p">,</span> <span class="n">cand</span><span class="p">:</span> <span class="n">prod</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">ranking</span><span class="p">,</span>
                <span class="mf">1.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">perm_rankings</span>
        <span class="p">]</span>
        <span class="n">draw_probabilities</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">prob</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">draw_probabilities</span><span class="p">)</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">draw_probabilities</span>
        <span class="p">]</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">perm_rankings</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">draw_probabilities</span>
    <span class="p">)</span>
    <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">perm_rankings</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">)]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.slate_PlackettLuce" class="doc doc-heading">
          <code>slate_PlackettLuce</code>


<a href="#votekit.ballot_generator.slate_PlackettLuce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for generating ballots using a slate-PlackettLuce model.
This model first samples a ballot type by flipping a cohesion parameter weighted coin.
It then fills out the ballot type via sampling with out replacement from the interval.</p>
<p>Can be initialized with an interval or can be
constructed with the Dirichlet distribution using the <code>from_params</code> method in the
<code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>slate_to_candidates</code>
:   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">slate_PlackettLuce</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating ballots using a slate-PlackettLuce model.</span>
<span class="sd">    This model first samples a ballot type by flipping a cohesion parameter weighted coin.</span>
<span class="sd">    It then fills out the ballot type via sampling with out replacement from the interval.</span>

<span class="sd">    Can be initialized with an interval or can be</span>
<span class="sd">    constructed with the Dirichlet distribution using the `from_params` method in the</span>
<span class="sd">    `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `slate_to_candidates`</span>
<span class="sd">    :   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">        `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">        `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                    False if you want the full, aggregated PreferenceProfile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pref_profile_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
            <span class="c1"># number of voters in this bloc</span>
            <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="n">num_ballots</span>
            <span class="n">pref_intervals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">pref_intervals</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
            <span class="p">)</span>

            <span class="n">slate_to_non_zero_candidates</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">s</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c_list</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zero_cands</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">c_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="n">ballot_types</span> <span class="o">=</span> <span class="n">sample_cohesion_ballot_types</span><span class="p">(</span>
                <span class="n">slate_to_non_zero_candidates</span><span class="o">=</span><span class="n">slate_to_non_zero_candidates</span><span class="p">,</span>
                <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">,</span>
                <span class="n">cohesion_parameters_for_bloc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot_types</span><span class="p">):</span>
                <span class="n">cand_ordering_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
                    <span class="c1"># create a pref interval dict of only this blocs candidates</span>
                    <span class="n">bloc_cand_pref_interval</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span>
                    <span class="n">cands</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">non_zero_cands</span>

                    <span class="c1"># if there are no non-zero candidates, skip this bloc</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span><span class="n">bloc_cand_pref_interval</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>

                    <span class="c1"># sample</span>
                    <span class="n">cand_ordering</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="n">a</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>
                    <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cand_ordering</span><span class="p">)</span>

                <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">})]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bt</span><span class="p">):</span>
                    <span class="c1"># append the current first candidate, then remove them from the ordering</span>
                    <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>
                    <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">))</span>
                <span class="n">ballot_pool</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pref_profile_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pref_profile_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pref_profile_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.slate_PlackettLuce.generate_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.ballot_generator.slate_PlackettLuce.generate_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Args:
<code>number_of_ballots</code>: The number of ballots to generate.</p>
<p><code>by_bloc</code>: True if you want to return a dictionary of PreferenceProfiles by bloc.
            False if you want the full, aggregated PreferenceProfile.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">    `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">    `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                False if you want the full, aggregated PreferenceProfile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
            <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">pref_profile_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
        <span class="c1"># number of voters in this bloc</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="n">num_ballots</span>
        <span class="n">pref_intervals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">pref_intervals</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="p">)</span>

        <span class="n">slate_to_non_zero_candidates</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">s</span><span class="p">:</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">c_list</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zero_cands</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">c_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="n">ballot_types</span> <span class="o">=</span> <span class="n">sample_cohesion_ballot_types</span><span class="p">(</span>
            <span class="n">slate_to_non_zero_candidates</span><span class="o">=</span><span class="n">slate_to_non_zero_candidates</span><span class="p">,</span>
            <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">,</span>
            <span class="n">cohesion_parameters_for_bloc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot_types</span><span class="p">):</span>
            <span class="n">cand_ordering_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
                <span class="c1"># create a pref interval dict of only this blocs candidates</span>
                <span class="n">bloc_cand_pref_interval</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span>
                <span class="n">cands</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">non_zero_cands</span>

                <span class="c1"># if there are no non-zero candidates, skip this bloc</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span><span class="n">bloc_cand_pref_interval</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>

                <span class="c1"># sample</span>
                <span class="n">cand_ordering</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="n">a</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cand_ordering</span><span class="p">)</span>

            <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">})]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bt</span><span class="p">):</span>
                <span class="c1"># append the current first candidate, then remove them from the ordering</span>
                <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>
                <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">))</span>
            <span class="n">ballot_pool</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="n">pref_profile_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

    <span class="c1"># combine the profiles</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
    <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pref_profile_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pref_profile_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

    <span class="c1"># else return the combined profiles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.name_PlackettLuce" class="doc doc-heading">
          <code>name_PlackettLuce</code>


<a href="#votekit.ballot_generator.name_PlackettLuce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.ballot_generator.short_name_PlackettLuce">short_name_PlackettLuce</span></code></p>

  
      <p>Class for generating full ballots with name-PlackettLuce. This model samples without
replacement from a preference interval. Can be initialized with an interval or can be
constructed with the Dirichlet distribution using the <code>from_params</code> method in the
<code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
: a list of candidates.</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">name_PlackettLuce</span><span class="p">(</span><span class="n">short_name_PlackettLuce</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating full ballots with name-PlackettLuce. This model samples without</span>
<span class="sd">    replacement from a preference interval. Can be initialized with an interval or can be</span>
<span class="sd">    constructed with the Dirichlet distribution using the `from_params` method in the</span>
<span class="sd">    `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : a list of candidates.</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</span>


<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;candidates&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">ballot_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;candidates&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;slate_to_candidates&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">ballot_length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">c_list</span><span class="p">)</span> <span class="k">for</span> <span class="n">c_list</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;slate_to_candidates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of candidates or slate_to_candidates must be passed.&quot;</span><span class="p">)</span>

        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ballot_length</span><span class="o">=</span><span class="n">ballot_length</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.slate_BradleyTerry" class="doc doc-heading">
          <code>slate_BradleyTerry</code>


<a href="#votekit.ballot_generator.slate_BradleyTerry" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for generating ballots using a slate-BradleyTerry model. It
presamples ballot types by checking all pairwise comparisons, then fills out candidate
ordering by sampling without replacement from preference intervals.</p>
<p>Only works with 2 blocs at the moment.</p>
<p>Can be initialized with an interval or can be
constructed with the Dirichlet distribution using the <code>from_params</code> method in the
<code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>slate_to_candidates</code>
:   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">slate_BradleyTerry</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating ballots using a slate-BradleyTerry model. It</span>
<span class="sd">    presamples ballot types by checking all pairwise comparisons, then fills out candidate</span>
<span class="sd">    ordering by sampling without replacement from preference intervals.</span>

<span class="sd">    Only works with 2 blocs at the moment.</span>

<span class="sd">    Can be initialized with an interval or can be</span>
<span class="sd">    constructed with the Dirichlet distribution using the `from_params` method in the</span>
<span class="sd">    `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `slate_to_candidates`</span>
<span class="sd">    :   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;This model currently only supports at most two blocs, but you </span><span class="se">\</span>
<span class="s2">                              passed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ballot_type_pdf</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">b</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ballot_type_dist</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_compute_ballot_type_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bloc</span><span class="p">,</span> <span class="n">opp_bloc</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dictionary with keys ballot types and values equal to probability of sampling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blocs_to_sample</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="p">]</span>
        <span class="n">total_comparisons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">l_of_c</span><span class="p">)</span> <span class="k">for</span> <span class="n">l_of_c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="p">)</span>
        <span class="n">cohesion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">bloc</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">prob_of_type</span><span class="p">(</span><span class="n">b_type</span><span class="p">):</span>
            <span class="n">success</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="n">b_type</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">opp_bloc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">bloc</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">cohesion</span><span class="p">,</span> <span class="n">success</span><span class="p">)</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="n">cohesion</span><span class="p">,</span> <span class="n">total_comparisons</span> <span class="o">-</span> <span class="n">success</span>
            <span class="p">)</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">b</span><span class="p">:</span> <span class="n">prob_of_type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">blocs_to_sample</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocs_to_sample</span><span class="p">)))</span>
        <span class="p">}</span>

        <span class="n">summ</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">v</span> <span class="o">/</span> <span class="n">summ</span> <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">def</span> <span class="nf">_sample_ballot_types_deterministic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bloc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">opp_bloc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_ballots</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to generate bloc orderings for deliberative.</span>

<span class="sd">        Returns a list of lists, where each sublist contains the bloc names in order they appear</span>
<span class="sd">        on the ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pdf = self._compute_ballot_type_dist(bloc=bloc, opp_bloc=opp_bloc)</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_type_pdf</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">b_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_types</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">b_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sampled_indices</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_sample_ballot_types_MCMC</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bloc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate ballot types using MCMC that has desired stationary distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">seed_ballot_type</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="p">]</span>

        <span class="n">ballots</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">num_ballots</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">current_ranking</span> <span class="o">=</span> <span class="n">seed_ballot_type</span>

        <span class="n">cohesion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">bloc</span><span class="p">]</span>

        <span class="c1"># presample swap indices</span>
        <span class="n">swap_indices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">j1</span><span class="p">,</span> <span class="n">j1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seed_ballot_type</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">odds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cohesion</span><span class="p">)</span> <span class="o">/</span> <span class="n">cohesion</span>
        <span class="c1"># generate MCMC sample</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ballots</span><span class="p">):</span>
            <span class="c1"># choose adjacent pair to propose a swap</span>
            <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span> <span class="o">=</span> <span class="n">swap_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># if swap reduces number of voters bloc above opposing bloc</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">]</span> <span class="o">==</span> <span class="n">bloc</span>
            <span class="p">):</span>
                <span class="n">acceptance_prob</span> <span class="o">=</span> <span class="n">odds</span>

            <span class="c1"># if swap increases number of voters bloc above opposing or swaps two of same bloc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">acceptance_prob</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># if you accept, make the swap</span>
            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">acceptance_prob</span><span class="p">:</span>
                <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">],</span> <span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">],</span>
                    <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">accept</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">ballots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_ranking</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Acceptance ratio as number accepted / total steps: </span><span class="si">{</span><span class="n">accept</span><span class="o">/</span><span class="n">num_ballots</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Some element of ballots list is not a ballot.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ballots</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">        `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">        `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                    False if you want the full, aggregated PreferenceProfile.</span>

<span class="sd">        `deterministic`: True if you want to use the computed pdf for the slate-BT model,</span>
<span class="sd">                        False if you want to use MCMC approximation. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
        <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pref_profile_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
            <span class="c1"># number of voters in this bloc</span>
            <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="n">num_ballots</span>
            <span class="n">pref_intervals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">pref_intervals</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">deterministic</span><span class="p">:</span>
                <span class="n">ballot_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ballot_types_deterministic</span><span class="p">(</span>
                    <span class="n">bloc</span><span class="o">=</span><span class="n">bloc</span><span class="p">,</span> <span class="n">opp_bloc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">],</span> <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ballot_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ballot_types_MCMC</span><span class="p">(</span>
                    <span class="n">bloc</span><span class="o">=</span><span class="n">bloc</span><span class="p">,</span> <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span>
                <span class="p">)</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot_types</span><span class="p">):</span>
                <span class="n">cand_ordering_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
                    <span class="c1"># create a pref interval dict of only this blocs candidates</span>
                    <span class="n">bloc_cand_pref_interval</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span>
                    <span class="n">cands</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">non_zero_cands</span>

                    <span class="c1"># if there are no non-zero candidates, skip this bloc</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span><span class="n">bloc_cand_pref_interval</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>

                    <span class="c1"># sample</span>
                    <span class="n">cand_ordering</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="n">a</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
                    <span class="p">)</span>

                    <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cand_ordering</span><span class="p">)</span>

                <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">})]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bt</span><span class="p">):</span>
                    <span class="c1"># append the current first candidate, then remove them from the ordering</span>
                    <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>
                    <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">))</span>
                <span class="n">ballot_pool</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pref_profile_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pref_profile_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pref_profile_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.slate_BradleyTerry.generate_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#votekit.ballot_generator.slate_BradleyTerry.generate_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Args:
<code>number_of_ballots</code>: The number of ballots to generate.</p>
<p><code>by_bloc</code>: True if you want to return a dictionary of PreferenceProfiles by bloc.
            False if you want the full, aggregated PreferenceProfile.</p>
<p><code>deterministic</code>: True if you want to use the computed pdf for the slate-BT model,
                False if you want to use MCMC approximation. Defaults to True.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">    `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">    `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                False if you want the full, aggregated PreferenceProfile.</span>

<span class="sd">    `deterministic`: True if you want to use the computed pdf for the slate-BT model,</span>
<span class="sd">                    False if you want to use MCMC approximation. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
    <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
            <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">pref_profile_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
        <span class="c1"># number of voters in this bloc</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="n">num_ballots</span>
        <span class="n">pref_intervals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">zero_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">zero_cands</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">pref_intervals</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">deterministic</span><span class="p">:</span>
            <span class="n">ballot_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ballot_types_deterministic</span><span class="p">(</span>
                <span class="n">bloc</span><span class="o">=</span><span class="n">bloc</span><span class="p">,</span> <span class="n">opp_bloc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">],</span> <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ballot_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ballot_types_MCMC</span><span class="p">(</span>
                <span class="n">bloc</span><span class="o">=</span><span class="n">bloc</span><span class="p">,</span> <span class="n">num_ballots</span><span class="o">=</span><span class="n">num_ballots</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot_types</span><span class="p">):</span>
            <span class="n">cand_ordering_by_bloc</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
                <span class="c1"># create a pref interval dict of only this blocs candidates</span>
                <span class="n">bloc_cand_pref_interval</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span>
                <span class="n">cands</span> <span class="o">=</span> <span class="n">pref_intervals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">non_zero_cands</span>

                <span class="c1"># if there are no non-zero candidates, skip this bloc</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span><span class="n">bloc_cand_pref_interval</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cands</span><span class="p">]</span>

                <span class="c1"># sample</span>
                <span class="n">cand_ordering</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="n">a</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">cands</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>

                <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cand_ordering</span><span class="p">)</span>

            <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">})]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bt</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bt</span><span class="p">):</span>
                <span class="c1"># append the current first candidate, then remove them from the ordering</span>
                <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]})</span>
                <span class="n">cand_ordering_by_bloc</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">))</span>
            <span class="n">ballot_pool</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="n">pref_profile_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

    <span class="c1"># combine the profiles</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
    <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pref_profile_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pref_profile_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

    <span class="c1"># else return the combined profiles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.name_BradleyTerry" class="doc doc-heading">
          <code>name_BradleyTerry</code>


<a href="#votekit.ballot_generator.name_BradleyTerry" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for generating ballots using a name-BradleyTerry model. The probability of sampling
the ranking <span class="arithmatex">\(X&gt;Y&gt;Z\)</span> is proportional to <span class="arithmatex">\(P(X&gt;Y)*P(X&gt;Z)*P(Y&gt;Z)\)</span>.
These individual probabilities are based on the preference interval: <span class="arithmatex">\(P(X&gt;Y) = x/(x+y)\)</span>.
Can be initialized with an interval or can be constructed with the Dirichlet distribution using
the <code>from_params</code> method in the <code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
: a list of candidates.</p>
<p><code>pref_intervals_by_bloc</code>
: dictionary of dictionaries mapping of bloc to preference intervals or dictionary of PIs.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of slate to voter proportions (ex. {race: voter proportion}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">name_BradleyTerry</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating ballots using a name-BradleyTerry model. The probability of sampling</span>
<span class="sd">    the ranking $X&gt;Y&gt;Z$ is proportional to $P(X&gt;Y)*P(X&gt;Z)*P(Y&gt;Z)$.</span>
<span class="sd">    These individual probabilities are based on the preference interval: $P(X&gt;Y) = x/(x+y)$.</span>
<span class="sd">    Can be initialized with an interval or can be constructed with the Dirichlet distribution using</span>
<span class="sd">    the `from_params` method in the `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : a list of candidates.</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    : dictionary of dictionaries mapping of bloc to preference intervals or dictionary of PIs.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of slate to voter proportions (ex. {race: voter proportion}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># if dictionary of pref intervals</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span> <span class="n">PreferenceInterval</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span>

        <span class="c1"># if nested dictionary of pref intervals, combine by cohesion</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">bloc</span><span class="p">:</span> <span class="n">combine_preference_intervals</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">],</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span>
            <span class="p">}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="c1"># precompute pdfs for sampling</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdfs_by_bloc</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">bloc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BT_pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;For 12 or more candidates, exact sampling is computationally infeasible. </span><span class="se">\</span>
<span class="s2">                    Please only use the built in generate_profile_MCMC method.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permutations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span> <span class="n">cand_support_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given a list of (possibly incomplete) rankings and the preference interval, \</span>
<span class="sd">        calculates the probability of observing each ranking</span>

<span class="sd">        Args:</span>
<span class="sd">            permutations (list[tuple]): a list of permuted rankings</span>
<span class="sd">            cand_support_dict (dict): a mapping from candidate to their \</span>
<span class="sd">            support (preference interval)</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: a mapping of the rankings to their probability</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking_to_prob</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ranking</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)):</span>
                <span class="n">cand_i</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">greater_cand_support</span> <span class="o">=</span> <span class="n">cand_support_dict</span><span class="p">[</span><span class="n">cand_i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)):</span>
                    <span class="n">cand_j</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">cand_support</span> <span class="o">=</span> <span class="n">cand_support_dict</span><span class="p">[</span><span class="n">cand_j</span><span class="p">]</span>
                    <span class="n">prob</span> <span class="o">*=</span> <span class="n">greater_cand_support</span> <span class="o">/</span> <span class="p">(</span><span class="n">greater_cand_support</span> <span class="o">+</span> <span class="n">cand_support</span><span class="p">)</span>
            <span class="n">ranking_to_prob</span><span class="p">[</span><span class="n">ranking</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
        <span class="k">return</span> <span class="n">ranking_to_prob</span>

    <span class="k">def</span> <span class="nf">_make_pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method for _BT_pdf.</span>
<span class="sd">        Takes is a list representing the preference lengths of each candidate</span>
<span class="sd">        in a permutation.</span>
<span class="sd">        Computes the numerator of BT probability.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">*=</span> <span class="n">val</span> <span class="o">**</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_BT_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dct</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct the BT pdf as a dictionary (ballot, probability) given a preference</span>
<span class="sd">        interval as a dictionary (candidate, preference).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># gives PI lengths for each candidate in permutation</span>
        <span class="k">def</span> <span class="nf">pull_perm</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">dct</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>

        <span class="n">new_dct</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">perm</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_pow</span><span class="p">(</span><span class="n">pull_perm</span><span class="p">(</span><span class="n">perm</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">dct</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dct</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="n">summ</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">new_dct</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="o">/</span> <span class="n">summ</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_dct</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
        <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>

        <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
            <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>

            <span class="c1"># Directly initialize the list using good memory trick</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="n">num_ballots</span>
            <span class="n">zero_cands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span><span class="o">.</span><span class="n">zero_cands</span>
            <span class="n">pdf_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdfs_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>

            <span class="c1"># Directly use the keys and values from the dictionary for sampling</span>
            <span class="n">rankings</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">pdf_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

            <span class="c1"># The return of this will be a numpy array, so we don&#39;t need to make it into a list</span>
            <span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">rankings</span><span class="p">),</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">,</span>
                    <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sampled_indices</span><span class="p">):</span>
                <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">cand</span><span class="p">})</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>

                <span class="c1"># Add any zero candidates as ties only if they exist</span>
                <span class="k">if</span> <span class="n">zero_cands</span><span class="p">:</span>
                    <span class="n">ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">))</span>

                <span class="n">ballot_pool</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>

    <span class="k">def</span> <span class="nf">_BT_mcmc</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">num_ballots</span><span class="p">,</span> <span class="n">pref_interval</span><span class="p">,</span> <span class="n">seed_ballot</span><span class="p">,</span> <span class="n">zero_cands</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample from BT distribution for a given preference interval using MCMC.</span>

<span class="sd">        num_ballots (int): the number of ballots to sample</span>
<span class="sd">        pref_interval (dict): the preference interval to determine BT distribution</span>
<span class="sd">        sub_sample_length (int): how many attempts at swaps to make before saving ballot</span>
<span class="sd">        seed_ballot: Ballot, the seed ballot for the Markov chain</span>
<span class="sd">        verbose: bool, if True, print the acceptance ratio of the chain</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check that seed ballot has no ties</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">seed_ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Seed ballot contains ties&quot;</span><span class="p">)</span>

        <span class="n">ballots</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_ballots</span>
        <span class="n">accept</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">current_ranking</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">seed_ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">num_candidates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_ranking</span><span class="p">)</span>

        <span class="c1"># presample swap indices</span>
        <span class="n">swap_indices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">j1</span><span class="p">,</span> <span class="n">j1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j1</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_candidates</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">num_ballots</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># generate MCMC sample</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ballots</span><span class="p">):</span>
            <span class="c1"># choose adjacent pair to propose a swap</span>
            <span class="n">j1</span><span class="p">,</span> <span class="n">j2</span> <span class="o">=</span> <span class="n">swap_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">acceptance_prob</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="mi">1</span><span class="p">,</span>
                <span class="n">pref_interval</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">]))]</span>
                <span class="o">/</span> <span class="n">pref_interval</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">]))],</span>
            <span class="p">)</span>

            <span class="c1"># if you accept, make the swap</span>
            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">acceptance_prob</span><span class="p">:</span>
                <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">],</span> <span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">current_ranking</span><span class="p">[</span><span class="n">j2</span><span class="p">],</span>
                    <span class="n">current_ranking</span><span class="p">[</span><span class="n">j1</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">accept</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_cands</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ballots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">current_ranking</span> <span class="o">+</span> <span class="p">[</span><span class="n">zero_cands</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ballots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">current_ranking</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Acceptance ratio as number accepted / total steps: </span><span class="si">{</span><span class="n">accept</span><span class="o">/</span><span class="n">num_ballots</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Some element of ballots list is not a ballot.&quot;</span><span class="p">)</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pp</span>

    <span class="k">def</span> <span class="nf">generate_profile_MCMC</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample from the BT distribution using Markov Chain Monte Carlo. `number_of_ballots` should</span>
<span class="sd">        be sufficiently large to allow for convergence of the chain.</span>

<span class="sd">        Args:</span>
<span class="sd">            number_of_ballots (int): Number of ballots to generate.</span>
<span class="sd">            verbose (bool, optional): If True, print the acceptance ratio of the chain. Default</span>
<span class="sd">                                        is False.</span>
<span class="sd">            by_bloc (bool, optional): True if you want a tuple (pp_by_bloc, pp), which is a</span>
<span class="sd">                                    dictionary of  PreferenceProfiles with keys = blocs and the</span>
<span class="sd">                                    aggregated profile. False if you want the aggregated profile.</span>
<span class="sd">                                    Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Generated ballots as a PreferenceProfile or tuple (dict, PreferenceProfile).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
        <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
            <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">pref_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">pref_interval_dict</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">interval</span>
            <span class="n">non_zero_cands</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">non_zero_cands</span>
            <span class="n">zero_cands</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">zero_cands</span>

            <span class="n">seed_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">c</span><span class="p">})</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">non_zero_cands</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BT_mcmc</span><span class="p">(</span>
                <span class="n">num_ballots</span><span class="p">,</span>
                <span class="n">pref_interval_dict</span><span class="p">,</span>
                <span class="n">seed_ballot</span><span class="p">,</span>
                <span class="n">zero_cands</span><span class="o">=</span><span class="n">zero_cands</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.name_BradleyTerry.generate_profile_MCMC" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile_MCMC</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.ballot_generator.name_BradleyTerry.generate_profile_MCMC" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Sample from the BT distribution using Markov Chain Monte Carlo. <code>number_of_ballots</code> should
be sufficiently large to allow for convergence of the chain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>number_of_ballots</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ballots to generate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, print the acceptance ratio of the chain. Default
                        is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>by_bloc</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if you want a tuple (pp_by_bloc, pp), which is a
                    dictionary of  PreferenceProfiles with keys = blocs and the
                    aggregated profile. False if you want the aggregated profile.
                    Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a>, <span title="typing.Tuple">Tuple</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Generated ballots as a PreferenceProfile or tuple (dict, PreferenceProfile).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_profile_MCMC</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample from the BT distribution using Markov Chain Monte Carlo. `number_of_ballots` should</span>
<span class="sd">    be sufficiently large to allow for convergence of the chain.</span>

<span class="sd">    Args:</span>
<span class="sd">        number_of_ballots (int): Number of ballots to generate.</span>
<span class="sd">        verbose (bool, optional): If True, print the acceptance ratio of the chain. Default</span>
<span class="sd">                                    is False.</span>
<span class="sd">        by_bloc (bool, optional): True if you want a tuple (pp_by_bloc, pp), which is a</span>
<span class="sd">                                dictionary of  PreferenceProfiles with keys = blocs and the</span>
<span class="sd">                                aggregated profile. False if you want the aggregated profile.</span>
<span class="sd">                                Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Generated ballots as a PreferenceProfile or tuple (dict, PreferenceProfile).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
    <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
            <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">:</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">pref_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">pref_interval_dict</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">interval</span>
        <span class="n">non_zero_cands</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">non_zero_cands</span>
        <span class="n">zero_cands</span> <span class="o">=</span> <span class="n">pref_interval</span><span class="o">.</span><span class="n">zero_cands</span>

        <span class="n">seed_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">c</span><span class="p">})</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">non_zero_cands</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BT_mcmc</span><span class="p">(</span>
            <span class="n">num_ballots</span><span class="p">,</span>
            <span class="n">pref_interval_dict</span><span class="p">,</span>
            <span class="n">seed_ballot</span><span class="p">,</span>
            <span class="n">zero_cands</span><span class="o">=</span><span class="n">zero_cands</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

    <span class="c1"># combine the profiles</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
    <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

    <span class="c1"># else return the combined profiles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.AlternatingCrossover" class="doc doc-heading">
          <code>AlternatingCrossover</code>


<a href="#votekit.ballot_generator.AlternatingCrossover" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for Alternating Crossover style of generating ballots.
AC assumes that voters either rank all of their own blocs candidates above the other bloc,
or the voters "crossover" and rank a candidate from the other bloc first, then alternate
between candidates from their own bloc and the opposing.
Should only be used when there are two blocs.</p>
<p>Can be initialized with an interval or can be
constructed with the Dirichlet distribution using the <code>from_params</code> method in the
<code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of slate to voter proportions (ex. {bloc: voter proportion}).</p>
<p><code>slate_to_candidates</code>
:   dictionary mapping of slate to candidates (ex. {bloc: [candidate1, candidate2]}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AlternatingCrossover</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for Alternating Crossover style of generating ballots.</span>
<span class="sd">    AC assumes that voters either rank all of their own blocs candidates above the other bloc,</span>
<span class="sd">    or the voters &quot;crossover&quot; and rank a candidate from the other bloc first, then alternate</span>
<span class="sd">    between candidates from their own bloc and the opposing.</span>
<span class="sd">    Should only be used when there are two blocs.</span>

<span class="sd">    Can be initialized with an interval or can be</span>
<span class="sd">    constructed with the Dirichlet distribution using the `from_params` method in the</span>
<span class="sd">    `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of slate to voter proportions (ex. {bloc: voter proportion}).</span>

<span class="sd">    `slate_to_candidates`</span>
<span class="sd">    :   dictionary mapping of slate to candidates (ex. {bloc: [candidate1, candidate2]}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
        <span class="c1"># compute the number of bloc and crossover voters in each bloc using Huntington Hill</span>
        <span class="n">cohesion_parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">b</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span>
        <span class="p">}</span>

        <span class="n">voter_types</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span> <span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bloc&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">]]</span>

        <span class="n">voter_props</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;bloc&quot;</span>
            <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">voter_types</span>
        <span class="p">]</span>

        <span class="n">ballots_per_type</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="n">voter_types</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">voter_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">num_bloc_ballots</span> <span class="o">=</span> <span class="n">ballots_per_type</span><span class="p">[(</span><span class="n">bloc</span><span class="p">,</span> <span class="s2">&quot;bloc&quot;</span><span class="p">)]</span>
            <span class="n">num_cross_ballots</span> <span class="o">=</span> <span class="n">ballots_per_type</span><span class="p">[(</span><span class="n">bloc</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">)]</span>

            <span class="n">pref_interval_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>

            <span class="n">opposing_slate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>

            <span class="n">opposing_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="p">[</span><span class="n">opposing_slate</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">bloc_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="n">pref_for_opposing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">pref_interval_dict</span><span class="p">[</span><span class="n">opposing_slate</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">pref_for_bloc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cross_ballots</span> <span class="o">+</span> <span class="n">num_bloc_ballots</span><span class="p">):</span>
                <span class="n">bloc_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="n">bloc_cands</span><span class="p">,</span>
                        <span class="n">p</span><span class="o">=</span><span class="n">pref_for_bloc</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bloc_cands</span><span class="p">),</span>
                        <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">opposing_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="n">opposing_cands</span><span class="p">,</span>
                        <span class="n">p</span><span class="o">=</span><span class="n">pref_for_opposing</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">opposing_cands</span><span class="p">),</span>
                        <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_cross_ballots</span><span class="p">:</span>
                    <span class="c1"># alternate the bloc and opposing bloc candidates to create crossover ballots</span>
                    <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="nb">frozenset</span><span class="p">({</span><span class="n">cand</span><span class="p">})</span>
                        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">opposing_cands</span><span class="p">,</span> <span class="n">bloc_cands</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">pair</span>
                    <span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ranking</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">c</span><span class="p">})</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">bloc_cands</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
                        <span class="nb">frozenset</span><span class="p">({</span><span class="n">c</span><span class="p">})</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">opposing_cands</span>
                    <span class="p">]</span>

                <span class="n">ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ranking</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">ballot_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.CambridgeSampler" class="doc doc-heading">
          <code>CambridgeSampler</code>


<a href="#votekit.ballot_generator.CambridgeSampler" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for generating ballots based on historical RCV elections occurring
in Cambridge. Alternative election data can be used if specified. Assumes that there are two
blocs, a majority and a minority bloc, and determines this based on the bloc_voter_prop attr.</p>
<p>Based on cohesion parameters, decides if a voter casts their top choice within their bloc
or in the opposing bloc. Then uses historical data; given their first choice, choose a
ballot type from the historical distribution.</p>
<p><strong>Attributes</strong></p>
<p><code>slate_to_candidates</code>
:   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: voter proportion}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>historical_majority</code>
: name of majority bloc in historical data, defaults to W for Cambridge.</p>
<p><code>historical_minority</code>
: name of minority bloc in historical data, defaults to C for Cambridge.</p>
<p><code>path</code>
:   file path to an election data file to sample from. Defaults to Cambridge elections.</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CambridgeSampler</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating ballots based on historical RCV elections occurring</span>
<span class="sd">    in Cambridge. Alternative election data can be used if specified. Assumes that there are two</span>
<span class="sd">    blocs, a majority and a minority bloc, and determines this based on the bloc_voter_prop attr.</span>

<span class="sd">    Based on cohesion parameters, decides if a voter casts their top choice within their bloc</span>
<span class="sd">    or in the opposing bloc. Then uses historical data; given their first choice, choose a</span>
<span class="sd">    ballot type from the historical distribution.</span>


<span class="sd">    **Attributes**</span>

<span class="sd">    `slate_to_candidates`</span>
<span class="sd">    :   dictionary mapping of slate to candidates (ex. {bloc: [candidate]}).</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: voter proportion}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `historical_majority`</span>
<span class="sd">    : name of majority bloc in historical data, defaults to W for Cambridge.</span>

<span class="sd">    `historical_minority`</span>
<span class="sd">    : name of minority bloc in historical data, defaults to C for Cambridge.</span>

<span class="sd">    `path`</span>
<span class="sd">    :   file path to an election data file to sample from. Defaults to Cambridge elections.</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">historical_majority</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span>
        <span class="n">historical_minority</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">data</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">historical_majority</span> <span class="o">=</span> <span class="n">historical_majority</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">historical_minority</span> <span class="o">=</span> <span class="n">historical_minority</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;This model currently only supports at two blocs, but you </span><span class="se">\</span>
<span class="s2">                              passed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">majority_bloc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">bloc</span> <span class="k">for</span> <span class="n">bloc</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">prop</span> <span class="o">&gt;=</span> <span class="mf">0.5</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minority_bloc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">bloc</span> <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">bloc</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">majority_bloc</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">majority_bloc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_majority</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">minority_bloc</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">historical_minority</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># # changing names to match historical data, if statement handles generating from_params</span>
        <span class="c1"># # only want to run this now if generating from init</span>
        <span class="c1"># if len(self.cohesion_parameters) &gt; 0:</span>
        <span class="c1">#     self._rename_blocs()</span>

        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s2">&quot;data/&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s2">&quot;Cambridge_09to17_ballot_types.p&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file</span><span class="p">:</span>
            <span class="n">ballot_frequencies</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_file</span><span class="p">)</span>

        <span class="n">cohesion_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="c1"># compute the number of bloc and crossover voters in each bloc using Huntington Hill</span>
        <span class="n">voter_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bloc&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">voter_props</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;bloc&quot;</span>
            <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">b</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">voter_types</span>
        <span class="p">]</span>

        <span class="n">ballots_per_type</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="n">voter_types</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">voter_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">):</span>
            <span class="n">bloc_voters</span> <span class="o">=</span> <span class="n">ballots_per_type</span><span class="p">[(</span><span class="n">bloc</span><span class="p">,</span> <span class="s2">&quot;bloc&quot;</span><span class="p">)]</span>
            <span class="n">cross_voters</span> <span class="o">=</span> <span class="n">ballots_per_type</span><span class="p">[(</span><span class="n">bloc</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">)]</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ballot</span><span class="p">()]</span> <span class="o">*</span> <span class="p">(</span><span class="n">bloc_voters</span> <span class="o">+</span> <span class="n">cross_voters</span><span class="p">)</span>

            <span class="c1"># store the opposition bloc</span>
            <span class="n">opp_bloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>

            <span class="c1"># find total number of ballots that start with bloc and opp_bloc</span>
            <span class="n">bloc_first_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">freq</span>
                    <span class="k">for</span> <span class="n">ballot</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ballot_frequencies</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">opp_bloc_first_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">freq</span>
                    <span class="k">for</span> <span class="n">ballot</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ballot_frequencies</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span><span class="p">[</span><span class="n">opp_bloc</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="c1"># Compute the pref interval for this bloc</span>
            <span class="n">pref_interval_dict</span> <span class="o">=</span> <span class="n">combine_preference_intervals</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                <span class="p">[</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">],</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">]],</span>
            <span class="p">)</span>

            <span class="c1"># compute the relative probabilities of each ballot</span>
            <span class="c1"># sorted by ones where the ballot lists the bloc first</span>
            <span class="c1"># and those that list the opp first</span>
            <span class="n">prob_ballot_given_bloc_first</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ballot</span><span class="p">:</span> <span class="n">freq</span> <span class="o">/</span> <span class="n">bloc_first_count</span>
                <span class="k">for</span> <span class="n">ballot</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ballot_frequencies</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="p">}</span>

            <span class="n">prob_ballot_given_opp_first</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ballot</span><span class="p">:</span> <span class="n">freq</span> <span class="o">/</span> <span class="n">opp_bloc_first_count</span>
                <span class="k">for</span> <span class="n">ballot</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">ballot_frequencies</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span><span class="p">[</span><span class="n">opp_bloc</span><span class="p">]</span>
            <span class="p">}</span>

            <span class="n">bloc_voter_ordering</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">prob_ballot_given_bloc_first</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="n">weights</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">prob_ballot_given_bloc_first</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                <span class="n">k</span><span class="o">=</span><span class="n">bloc_voters</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">cross_voter_ordering</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">prob_ballot_given_opp_first</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="n">weights</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">prob_ballot_given_opp_first</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                <span class="n">k</span><span class="o">=</span><span class="n">cross_voters</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Generate ballots</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bloc_voters</span> <span class="o">+</span> <span class="n">cross_voters</span><span class="p">):</span>
                <span class="c1"># Based on first choice, randomly choose</span>
                <span class="c1"># ballots weighted by Cambridge frequency</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">bloc_voters</span><span class="p">:</span>
                    <span class="n">bloc_ordering</span> <span class="o">=</span> <span class="n">bloc_voter_ordering</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bloc_ordering</span> <span class="o">=</span> <span class="n">cross_voter_ordering</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">bloc_voters</span><span class="p">]</span>

                <span class="c1"># Now turn bloc ordering into candidate ordering</span>
                <span class="n">pl_ordering</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="o">.</span><span class="n">interval</span><span class="p">),</span>
                        <span class="n">p</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pref_interval_dict</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                        <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">ordered_bloc_slate</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pl_ordering</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="n">ordered_opp_slate</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pl_ordering</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slate_to_candidates</span><span class="p">[</span><span class="n">opp_bloc</span><span class="p">]</span>
                <span class="p">]</span>

                <span class="c1"># Fill in the bloc slots as determined</span>
                <span class="c1"># With the candidate ordering generated with PL</span>
                <span class="n">full_ballot</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bloc_ordering</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_to_historical</span><span class="p">[</span><span class="n">bloc</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">ordered_bloc_slate</span><span class="p">:</span>
                            <span class="n">full_ballot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ordered_bloc_slate</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ordered_opp_slate</span><span class="p">:</span>
                            <span class="n">full_ballot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ordered_opp_slate</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

                <span class="n">ranking</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">cand</span><span class="p">})</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">full_ballot</span><span class="p">])</span>
                <span class="n">ballot_pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.OneDimSpatial" class="doc doc-heading">
          <code>OneDimSpatial</code>


<a href="#votekit.ballot_generator.OneDimSpatial" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>1-D spatial model for ballot generation. Assumes the candidates are normally distributed on
the real line. Then voters are also normally distributed, and vote based on Euclidean distance
to the candidates.</p>
<p><strong>Attributes</strong>
<code>candidates</code>
    : a list of candidates.</p>
<p>See <code>BallotGenerator</code> base class.</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OneDimSpatial</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1-D spatial model for ballot generation. Assumes the candidates are normally distributed on</span>
<span class="sd">    the real line. Then voters are also normally distributed, and vote based on Euclidean distance</span>
<span class="sd">    to the candidates.</span>

<span class="sd">    **Attributes**</span>
<span class="sd">    `candidates`</span>
<span class="sd">        : a list of candidates.</span>

<span class="sd">    See `BallotGenerator` base class.</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
        <span class="n">candidate_position_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">}</span>
        <span class="n">voter_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">)</span>

        <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">vp</span> <span class="ow">in</span> <span class="n">voter_positions</span><span class="p">:</span>
            <span class="n">distance_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">c</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">vp</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="ow">in</span> <span class="n">candidate_position_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">candidate_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">distance_dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">distance_dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>
            <span class="n">ballot_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_order</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot_pool_to_profile</span><span class="p">(</span><span class="n">ballot_pool</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.ImpartialCulture" class="doc doc-heading">
          <code>ImpartialCulture</code>


<a href="#votekit.ballot_generator.ImpartialCulture" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotSimplex" href="#votekit.ballot_generator.BallotSimplex">BallotSimplex</a></code></p>

  
      <p>Impartial Culture model with an alpha value of 1e10 (should be infinity theoretically).
This model is uniform on all linear rankings.</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
: (list) a list of candidates</p>
<p><code>alpha</code>
:   (float) alpha parameter for ballot simplex. Defaults to None.</p>
<p><code>point</code>
:   dictionary representing a point in the ballot simplex with candidate as
    keys and electoral support as values. Defaults to None.</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotSimplex</code> object.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>Point or alpha arguments must be included to initialize. For details see
<code>BallotSimplex</code> and <code>BallotGenerator</code> object.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ImpartialCulture</span><span class="p">(</span><span class="n">BallotSimplex</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impartial Culture model with an alpha value of 1e10 (should be infinity theoretically).</span>
<span class="sd">    This model is uniform on all linear rankings.</span>


<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : (list) a list of candidates</span>

<span class="sd">    `alpha`</span>
<span class="sd">    :   (float) alpha parameter for ballot simplex. Defaults to None.</span>

<span class="sd">    `point`</span>
<span class="sd">    :   dictionary representing a point in the ballot simplex with candidate as</span>
<span class="sd">        keys and electoral support as values. Defaults to None.</span>



<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotSimplex` object.</span>

<span class="sd">    ???+ note</span>

<span class="sd">        Point or alpha arguments must be included to initialize. For details see</span>
<span class="sd">        `BallotSimplex` and `BallotGenerator` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.ImpartialAnonymousCulture" class="doc doc-heading">
          <code>ImpartialAnonymousCulture</code>


<a href="#votekit.ballot_generator.ImpartialAnonymousCulture" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotSimplex" href="#votekit.ballot_generator.BallotSimplex">BallotSimplex</a></code></p>

  
      <p>Impartial Anonymous Culture model with an alpha value of 1. This model choose uniformly
    from among all distributions on full linear rankings, and then draws according to the
    chosen distribution.</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
: (list) a list of candidates</p>
<p><code>alpha</code>
:   (float) alpha parameter for ballot simplex. Defaults to None.</p>
<p><code>point</code>
:   dictionary representing a point in the ballot simplex with candidate as
    keys and electoral support as values. Defaults to None.</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotSimplex</code> base class.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>Point or alpha arguments must be included to initialize. For details see
<code>BallotSimplex</code> and <code>BallotGenerator</code> object.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ImpartialAnonymousCulture</span><span class="p">(</span><span class="n">BallotSimplex</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Impartial Anonymous Culture model with an alpha value of 1. This model choose uniformly</span>
<span class="sd">        from among all distributions on full linear rankings, and then draws according to the</span>
<span class="sd">        chosen distribution.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : (list) a list of candidates</span>

<span class="sd">    `alpha`</span>
<span class="sd">    :   (float) alpha parameter for ballot simplex. Defaults to None.</span>

<span class="sd">    `point`</span>
<span class="sd">    :   dictionary representing a point in the ballot simplex with candidate as</span>
<span class="sd">        keys and electoral support as values. Defaults to None.</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotSimplex` base class.</span>

<span class="sd">    ???+ note</span>

<span class="sd">        Point or alpha arguments must be included to initialize. For details see</span>
<span class="sd">        `BallotSimplex` and `BallotGenerator` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.ballot_generator.name_Cumulative" class="doc doc-heading">
          <code>name_Cumulative</code>


<a href="#votekit.ballot_generator.name_Cumulative" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.ballot_generator.BallotGenerator" href="#votekit.ballot_generator.BallotGenerator">BallotGenerator</a></code></p>

  
      <p>Class for generating cumulative ballots. This model samples with
replacement from a combined preference interval and counts candidates with multiplicity.
Can be initialized with an interval or can be constructed with the Dirichlet distribution
using the <code>from_params</code> method in the <code>BallotGenerator</code> class.</p>
<p><strong>Attributes</strong></p>
<p><code>candidates</code>
: a list of candidates.</p>
<p><code>pref_intervals_by_bloc</code>
:   dictionary of dictionaries mapping of bloc to preference intervals.
    (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</p>
<p><code>cohesion_parameters</code>
: dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</p>
<p><code>bloc_voter_prop</code>
:   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</p>
<p><code>num_votes</code>
: the number of votes allowed per ballot.</p>
<p><strong>Methods</strong></p>
<p>See <code>BallotGenerator</code> base class</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">name_Cumulative</span><span class="p">(</span><span class="n">BallotGenerator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating cumulative ballots. This model samples with</span>
<span class="sd">    replacement from a combined preference interval and counts candidates with multiplicity.</span>
<span class="sd">    Can be initialized with an interval or can be constructed with the Dirichlet distribution</span>
<span class="sd">    using the `from_params` method in the `BallotGenerator` class.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `candidates`</span>
<span class="sd">    : a list of candidates.</span>

<span class="sd">    `pref_intervals_by_bloc`</span>
<span class="sd">    :   dictionary of dictionaries mapping of bloc to preference intervals.</span>
<span class="sd">        (ex. {bloc_1: {bloc_1 : PI, bloc_2: PI}}).</span>

<span class="sd">    `cohesion_parameters`</span>
<span class="sd">    : dictionary of dictionaries of cohesion parameters (ex. {bloc_1: {bloc_1:.7, bloc_2: .3}})</span>

<span class="sd">    `bloc_voter_prop`</span>
<span class="sd">    :   dictionary mapping of bloc to voter proportions (ex. {bloc: proportion}).</span>

<span class="sd">    `num_votes`</span>
<span class="sd">    : the number of votes allowed per ballot.</span>

<span class="sd">    **Methods**</span>

<span class="sd">    See `BallotGenerator` base class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cohesion_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">num_votes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="c1"># Call the parent class&#39;s __init__ method to handle common parameters</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cohesion_parameters</span><span class="o">=</span><span class="n">cohesion_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_votes</span> <span class="o">=</span> <span class="n">num_votes</span>

        <span class="c1"># if dictionary of pref intervals is passed</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span> <span class="n">PreferenceInterval</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span>

        <span class="c1"># if nested dictionary of pref intervals, combine by cohesion</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">bloc</span><span class="p">:</span> <span class="n">combine_preference_intervals</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pref_intervals_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">],</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cohesion_parameters</span><span class="p">[</span><span class="n">bloc</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span>
            <span class="p">}</span>

    <span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">        `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">        `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                    False if you want the full, aggregated PreferenceProfile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
        <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
                <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># number of voters in this bloc</span>
            <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
            <span class="n">pref_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>

            <span class="c1"># finds candidates with non-zero preference</span>
            <span class="n">non_zero_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval</span><span class="o">.</span><span class="n">non_zero_cands</span><span class="p">)</span>
            <span class="c1"># creates the interval of probabilities for candidates supported by this block</span>
            <span class="n">cand_support_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">pref_interval</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">non_zero_cands</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ballots</span><span class="p">):</span>
                <span class="c1"># generates ranking based on probability distribution of non zero candidate support</span>
                <span class="n">list_ranking</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                        <span class="n">non_zero_cands</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">num_votes</span><span class="p">,</span>
                        <span class="n">p</span><span class="o">=</span><span class="n">cand_support_vec</span><span class="p">,</span>
                        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">ranking</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">cand</span><span class="p">})</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">list_ranking</span><span class="p">])</span>

                <span class="n">ballot_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

            <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
            <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

        <span class="c1"># combine the profiles</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

        <span class="c1"># else return the combined profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.ballot_generator.name_Cumulative.generate_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_profile</span><span class="p">(</span><span class="n">number_of_ballots</span><span class="p">,</span> <span class="n">by_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.ballot_generator.name_Cumulative.generate_profile" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Args:
<code>number_of_ballots</code>: The number of ballots to generate.</p>
<p><code>by_bloc</code>: True if you want to return a dictionary of PreferenceProfiles by bloc.
            False if you want the full, aggregated PreferenceProfile.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/ballot_generator.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_profile</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_bloc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">    `number_of_ballots`: The number of ballots to generate.</span>

<span class="sd">    `by_bloc`: True if you want to return a dictionary of PreferenceProfiles by bloc.</span>
<span class="sd">                False if you want the full, aggregated PreferenceProfile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># the number of ballots per bloc is determined by Huntington-Hill apportionment</span>
    <span class="n">bloc_props</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">ballots_per_block</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">,</span>
            <span class="n">apportion</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="s2">&quot;huntington&quot;</span><span class="p">,</span> <span class="n">bloc_props</span><span class="p">,</span> <span class="n">number_of_ballots</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">pp_by_bloc</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocs</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">bloc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bloc_voter_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">ballot_pool</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># number of voters in this bloc</span>
        <span class="n">num_ballots</span> <span class="o">=</span> <span class="n">ballots_per_block</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>
        <span class="n">pref_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pref_interval_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span>

        <span class="c1"># finds candidates with non-zero preference</span>
        <span class="n">non_zero_cands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pref_interval</span><span class="o">.</span><span class="n">non_zero_cands</span><span class="p">)</span>
        <span class="c1"># creates the interval of probabilities for candidates supported by this block</span>
        <span class="n">cand_support_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">pref_interval</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">non_zero_cands</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ballots</span><span class="p">):</span>
            <span class="c1"># generates ranking based on probability distribution of non zero candidate support</span>
            <span class="n">list_ranking</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="n">non_zero_cands</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">num_votes</span><span class="p">,</span>
                    <span class="n">p</span><span class="o">=</span><span class="n">cand_support_vec</span><span class="p">,</span>
                    <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">ranking</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">({</span><span class="n">cand</span><span class="p">})</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">list_ranking</span><span class="p">])</span>

            <span class="n">ballot_pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballot_pool</span><span class="p">)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">condense_ballots</span><span class="p">()</span>
        <span class="n">pp_by_bloc</span><span class="p">[</span><span class="n">bloc</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span>

    <span class="c1"># combine the profiles</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="p">[])</span>
    <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">pp_by_bloc</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">pp</span> <span class="o">+=</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="n">by_bloc</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pp_by_bloc</span><span class="p">,</span> <span class="n">pp</span><span class="p">)</span>

    <span class="c1"># else return the combined profiles</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pp</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="elections">Elections<a class="headerlink" href="#elections" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.Bloc" class="doc doc-heading">
          <code>Bloc</code>


<a href="#votekit.elections.election_types.Bloc" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Elects m candidates with the highest m-approval scores. The m-approval
score of a candidate is equal to the number of voters who rank this
candidate among their m top ranked candidates.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Bloc</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Elects m candidates with the highest m-approval scores. The m-approval</span>
<span class="sd">    score of a candidate is equal to the number of voters who rank this</span>
<span class="sd">    candidate among their m top ranked candidates.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts a Limited election to elect m-candidates.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An ElectionState object for a Limited election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">limited_equivalent</span> <span class="o">=</span> <span class="n">Limited</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
            <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
            <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">limited_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
        <span class="k">return</span> <span class="n">outcome</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs complete Bloc election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object with results for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Bloc.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.Bloc.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Runs complete Bloc election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object with results for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs complete Bloc election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object with results for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Bloc.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.Bloc.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts a Limited election to elect m-candidates.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a Limited election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts a Limited election to elect m-candidates.</span>

<span class="sd">    Returns:</span>
<span class="sd">       An ElectionState object for a Limited election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">limited_equivalent</span> <span class="o">=</span> <span class="n">Limited</span><span class="p">(</span>
        <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
        <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
        <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">limited_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
    <span class="k">return</span> <span class="n">outcome</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.Borda" class="doc doc-heading">
          <code>Borda</code>


<a href="#votekit.elections.election_types.Borda" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Positional voting system that assigns a decreasing number of points to
candidates based on order and a score vector. The conventional score
vector is <span class="arithmatex">\((n, n-1, \dots, 1)\)</span>, where <span class="arithmatex">\(n\)</span> is the number of candidates.
If a ballot is incomplete, the remaining points of the score vector
are evenly distributed to the unlisted candidates (see <code>borda_scores</code> function in <code>utils</code>).</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>score_vector</code>
:   (optional) weights assigned to candidate ranking, should be a list of <code>Fractions</code>.
                Defaults to <span class="arithmatex">\((n,n-1,\dots,1)\)</span>.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Borda</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Positional voting system that assigns a decreasing number of points to</span>
<span class="sd">    candidates based on order and a score vector. The conventional score</span>
<span class="sd">    vector is $(n, n-1, \dots, 1)$, where $n$ is the number of candidates.</span>
<span class="sd">    If a ballot is incomplete, the remaining points of the score vector</span>
<span class="sd">    are evenly distributed to the unlisted candidates (see `borda_scores` function in `utils`).</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `score_vector`</span>
<span class="sd">    :   (optional) weights assigned to candidate ranking, should be a list of `Fractions`.</span>
<span class="sd">                    Defaults to $(n,n-1,\dots,1)$.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">score_vector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Fraction</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_vector</span> <span class="o">=</span> <span class="n">score_vector</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete Borda contest as Borda is not a round-by-round</span>
<span class="sd">        system.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">borda_dict</span> <span class="o">=</span> <span class="n">borda_scores</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">score_vector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">score_vector</span>
        <span class="p">)</span>

        <span class="n">ranking</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">borda_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

        <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
        <span class="p">)</span>

        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">borda_dict</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
        <span class="k">return</span> <span class="n">new_state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete Borda contest.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Borda.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.Borda.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete Borda contest.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete Borda contest.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Borda.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.Borda.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete Borda contest as Borda is not a round-by-round
system.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete Borda contest as Borda is not a round-by-round</span>
<span class="sd">    system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">borda_dict</span> <span class="o">=</span> <span class="n">borda_scores</span><span class="p">(</span>
        <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">score_vector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">score_vector</span>
    <span class="p">)</span>

    <span class="n">ranking</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">borda_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

    <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
        <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
    <span class="p">)</span>

    <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
        <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
        <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
        <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
        <span class="n">scores</span><span class="o">=</span><span class="n">borda_dict</span><span class="p">,</span>
        <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
        <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="k">return</span> <span class="n">new_state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.CondoBorda" class="doc doc-heading">
          <code>CondoBorda</code>


<a href="#votekit.elections.election_types.CondoBorda" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Elects candidates ordered by dominating set, but breaks ties
between candidates with Borda.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
            Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CondoBorda</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Elects candidates ordered by dominating set, but breaks ties</span>
<span class="sd">    between candidates with Borda.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts a complete Conda-Borda election as it is not a round-by-round</span>
<span class="sd">        system.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An `ElectionState` object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pwc_graph</span> <span class="o">=</span> <span class="n">PairwiseComparisonGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
        <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="n">pwc_graph</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="s2">&quot;borda&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
            <span class="p">)</span>

        <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
        <span class="p">)</span>

        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
        <span class="k">return</span> <span class="n">new_state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete Conda-Borda election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.CondoBorda.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.CondoBorda.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete Conda-Borda election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete Conda-Borda election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.CondoBorda.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.CondoBorda.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts a complete Conda-Borda election as it is not a round-by-round
system.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An <code>ElectionState</code> object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts a complete Conda-Borda election as it is not a round-by-round</span>
<span class="sd">    system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An `ElectionState` object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pwc_graph</span> <span class="o">=</span> <span class="n">PairwiseComparisonGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
    <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="n">pwc_graph</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="s2">&quot;borda&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
        <span class="p">)</span>

    <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
        <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
    <span class="p">)</span>

    <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
        <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
        <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
        <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
        <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
        <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
        <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="k">return</span> <span class="n">new_state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.Cumulative" class="doc doc-heading">
          <code>Cumulative</code>


<a href="#votekit.elections.election_types.Cumulative" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.elections.election_types.HighestScore" href="#votekit.elections.election_types.HighestScore">HighestScore</a></code></p>

  
      <p>Voting system where voters are allowed to vote for candidates with multiplicity.
Each ranking position should have one candidate, and every candidate ranked will receive
one point, i.e., the score vector is <span class="arithmatex">\((1,\dots,1)\)</span>.
<strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Cumulative</span><span class="p">(</span><span class="n">HighestScore</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Voting system where voters are allowed to vote for candidates with multiplicity.</span>
<span class="sd">    Each ranking position should have one candidate, and every candidate ranked will receive</span>
<span class="sd">    one point, i.e., the score vector is $(1,\dots,1)$.</span>
<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">longest_ballot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">longest_ballot</span><span class="p">:</span>
                <span class="n">longest_ballot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>

        <span class="n">score_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">longest_ballot</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">ballot_ties</span><span class="o">=</span><span class="n">ballot_ties</span><span class="p">,</span>
            <span class="n">score_vector</span><span class="o">=</span><span class="n">score_vector</span><span class="p">,</span>
            <span class="n">seats</span><span class="o">=</span><span class="n">seats</span><span class="p">,</span>
            <span class="n">tiebreak</span><span class="o">=</span><span class="n">tiebreak</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.DominatingSets" class="doc doc-heading">
          <code>DominatingSets</code>


<a href="#votekit.elections.election_types.DominatingSets" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Finds tiers of candidates by dominating set, which is a set of candidates
such that every candidate in the set wins head to head comparisons against
candidates outside of it.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DominatingSets</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds tiers of candidates by dominating set, which is a set of candidates</span>
<span class="sd">    such that every candidate in the set wins head to head comparisons against</span>
<span class="sd">    candidates outside of it.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>


<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts a complete DominatingSets election as it is not a round-by-round</span>
<span class="sd">        system.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pwc_graph</span> <span class="o">=</span> <span class="n">PairwiseComparisonGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
        <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="n">pwc_graph</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
                <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">elected</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
                <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span>
                <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
                <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
                <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">elected</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
                <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
                <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
        <span class="k">return</span> <span class="n">new_state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete DominatingSets election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.DominatingSets.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.DominatingSets.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete DominatingSets election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete DominatingSets election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.DominatingSets.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.DominatingSets.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts a complete DominatingSets election as it is not a round-by-round
system.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts a complete DominatingSets election as it is not a round-by-round</span>
<span class="sd">    system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pwc_graph</span> <span class="o">=</span> <span class="n">PairwiseComparisonGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
    <span class="n">dominating_tiers</span> <span class="o">=</span> <span class="n">pwc_graph</span><span class="o">.</span><span class="n">dominating_tiers</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">dominating_tiers</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">pwc_graph</span><span class="o">.</span><span class="n">pairwise_dict</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="k">return</span> <span class="n">new_state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.HighestScore" class="doc doc-heading">
          <code>HighestScore</code>


<a href="#votekit.elections.election_types.HighestScore" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Conducts an election based on points from score vector.
Chooses the m candidates with highest scores.
Ties are broken by randomly permuting the tied candidates.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected</p>
<p><code>score_vector</code>
: list of floats where ith entry denotes the number of points given to candidates
    ranked in position i.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><code>ballot_ties</code> (optional)
: resolves ties in ballots. Should only be set to True if you want ballots
    to have full linear rankings.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HighestScore</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts an election based on points from score vector.</span>
<span class="sd">    Chooses the m candidates with highest scores.</span>
<span class="sd">    Ties are broken by randomly permuting the tied candidates.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected</span>

<span class="sd">    `score_vector`</span>
<span class="sd">    : list of floats where ith entry denotes the number of points given to candidates</span>
<span class="sd">        ranked in position i.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    `ballot_ties` (optional)</span>
<span class="sd">    : resolves ties in ballots. Should only be set to True if you want ballots</span>
<span class="sd">        to have full linear rankings.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">score_vector</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="c1"># check for valid score vector</span>
        <span class="n">validate_score_vector</span><span class="p">(</span><span class="n">score_vector</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_vector</span> <span class="o">=</span> <span class="n">score_vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># a dictionary whose keys are candidates and values are scores</span>
        <span class="n">vote_tallies</span> <span class="o">=</span> <span class="n">compute_scores_from_vector</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">score_vector</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">score_vector</span>
        <span class="p">)</span>

        <span class="c1"># translate scores into ranking of candidates, tie break</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">score_dict</span><span class="o">=</span><span class="n">vote_tallies</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">untied_ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">untied_ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

        <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">untied_ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.IRV" class="doc doc-heading">
          <code>IRV</code>


<a href="#votekit.elections.election_types.IRV" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.elections.election_types.STV" href="#votekit.elections.election_types.STV">STV</a></code></p>

  
      <p>A class for conducting IRV elections, which are mathematically equivalent to STV for one seat.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>quota</code>
:   formula to calculate quota (defaults to droop).</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IRV</span><span class="p">(</span><span class="n">STV</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for conducting IRV elections, which are mathematically equivalent to STV for one seat.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>


<span class="sd">    `quota`</span>
<span class="sd">    :   formula to calculate quota (defaults to droop).</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">quota</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;droop&quot;</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># let parent class handle the construction</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">ballot_ties</span><span class="o">=</span><span class="n">ballot_ties</span><span class="p">,</span>
            <span class="n">seats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">tiebreak</span><span class="o">=</span><span class="n">tiebreak</span><span class="p">,</span>
            <span class="n">quota</span><span class="o">=</span><span class="n">quota</span><span class="p">,</span>
            <span class="n">transfer</span><span class="o">=</span><span class="n">fractional_transfer</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.Limited" class="doc doc-heading">
          <code>Limited</code>


<a href="#votekit.elections.election_types.Limited" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Elects m candidates with the highest k-approval scores.
The k-approval score of a candidate is equal to the number of voters who
rank this candidate among their k top ranked candidates.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>k</code>
:   value of an approval score.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Limited</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Elects m candidates with the highest k-approval scores.</span>
<span class="sd">    The k-approval score of a candidate is equal to the number of voters who</span>
<span class="sd">    rank this candidate among their k top ranked candidates.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `k`</span>
<span class="sd">    :   value of an approval score.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts Limited election in which m candidates are elected based</span>
<span class="sd">        on approval scores.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An ElectionState object for a Limited election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
        <span class="n">candidate_approvals</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">():</span>
            <span class="c1"># First we have to determine which candidates are approved</span>
            <span class="c1"># i.e. in first k ranks on a ballot</span>
            <span class="n">approvals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cand_set</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">):</span>
                <span class="c1"># If list of total candidates before and including current set</span>
                <span class="c1"># are less than seat count, all candidates are approved</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
                    <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cand_set</span><span class="p">))</span>
                <span class="c1"># If list of total candidates before current set</span>
                <span class="c1"># are greater than seat count, no candidates are approved</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span><span class="n">i</span><span class="p">])))</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
                    <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">([])</span>
                <span class="c1"># Else we know the cutoff is in the set, we compute and randomly</span>
                <span class="c1"># select the number of candidates we can select</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">accepted</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span><span class="n">i</span><span class="p">])))</span>
                    <span class="n">num_to_allow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="n">accepted</span>
                    <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cand_set</span><span class="p">),</span> <span class="n">num_to_allow</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="p">)</span>

            <span class="c1"># Add approval votes equal to ballot weight (i.e. number of voters with this ballot)</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">approvals</span><span class="p">:</span>
                <span class="n">candidate_approvals</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

        <span class="c1"># Order candidates by number of approval votes received</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">candidate_approvals</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

        <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
        <span class="p">)</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">candidate_approvals</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete Limited election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object with results for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Limited.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.Limited.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete Limited election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object with results for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete Limited election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object with results for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.Limited.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.Limited.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts Limited election in which m candidates are elected based
on approval scores.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a Limited election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts Limited election in which m candidates are elected based</span>
<span class="sd">    on approval scores.</span>

<span class="sd">    Returns:</span>
<span class="sd">       An ElectionState object for a Limited election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
    <span class="n">candidate_approvals</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">():</span>
        <span class="c1"># First we have to determine which candidates are approved</span>
        <span class="c1"># i.e. in first k ranks on a ballot</span>
        <span class="n">approvals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cand_set</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">):</span>
            <span class="c1"># If list of total candidates before and including current set</span>
            <span class="c1"># are less than seat count, all candidates are approved</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])))</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
                <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cand_set</span><span class="p">))</span>
            <span class="c1"># If list of total candidates before current set</span>
            <span class="c1"># are greater than seat count, no candidates are approved</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span><span class="n">i</span><span class="p">])))</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">:</span>
                <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">([])</span>
            <span class="c1"># Else we know the cutoff is in the set, we compute and randomly</span>
            <span class="c1"># select the number of candidates we can select</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">accepted</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span><span class="n">i</span><span class="p">])))</span>
                <span class="n">num_to_allow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="n">accepted</span>
                <span class="n">approvals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cand_set</span><span class="p">),</span> <span class="n">num_to_allow</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Add approval votes equal to ballot weight (i.e. number of voters with this ballot)</span>
        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">approvals</span><span class="p">:</span>
            <span class="n">candidate_approvals</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

    <span class="c1"># Order candidates by number of approval votes received</span>
    <span class="n">ranking</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">candidate_approvals</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>

    <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span> <span class="o">=</span> <span class="n">elect_cands_from_set_ranking</span><span class="p">(</span>
        <span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
    <span class="p">)</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
        <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
        <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
        <span class="n">remaining</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
        <span class="n">scores</span><span class="o">=</span><span class="n">candidate_approvals</span><span class="p">,</span>
        <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(),</span>
        <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.Plurality" class="doc doc-heading">
          <code>Plurality</code>


<a href="#votekit.elections.election_types.Plurality" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="votekit.elections.election_types.SNTV" href="#votekit.elections.election_types.SNTV">SNTV</a></code></p>

  
      <p>Simulates a single or multi-winner plurality election. Inherits
methods from <code>SNTV</code> to run election.</p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Plurality</span><span class="p">(</span><span class="n">SNTV</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a single or multi-winner plurality election. Inherits</span>
<span class="sd">    methods from `SNTV` to run election.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.SNTV" class="doc doc-heading">
          <code>SNTV</code>


<a href="#votekit.elections.election_types.SNTV" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Single nontransferable vote (SNTV): Elects k candidates with the highest
Plurality scores.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SNTV</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single nontransferable vote (SNTV): Elects k candidates with the highest</span>
<span class="sd">    Plurality scores.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts an SNTV election to elect candidates.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An ElectionState object for a SNTV election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">limited_equivalent</span> <span class="o">=</span> <span class="n">Limited</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
        <span class="p">)</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">limited_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
        <span class="k">return</span> <span class="n">outcome</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs complete SNTV election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object with results for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SNTV.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.SNTV.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Runs complete SNTV election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object with results for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs complete SNTV election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object with results for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SNTV.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.SNTV.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts an SNTV election to elect candidates.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a SNTV election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts an SNTV election to elect candidates.</span>

<span class="sd">    Returns:</span>
<span class="sd">       An ElectionState object for a SNTV election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">limited_equivalent</span> <span class="o">=</span> <span class="n">Limited</span><span class="p">(</span>
        <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
    <span class="p">)</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">limited_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
    <span class="k">return</span> <span class="n">outcome</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.SNTV_STV_Hybrid" class="doc doc-heading">
          <code>SNTV_STV_Hybrid</code>


<a href="#votekit.elections.election_types.SNTV_STV_Hybrid" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Election method that first runs SNTV to a cutoff, then runs STV to
pick a committee with a given number of seats.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>transfer</code>
:   transfer method (e.g. fractional transfer).</p>
<p><code>r1_cutoff</code>
:   first-round cutoff value.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SNTV_STV_Hybrid</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Election method that first runs SNTV to a cutoff, then runs STV to</span>
<span class="sd">    pick a committee with a given number of seats.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `transfer`</span>
<span class="sd">    :   transfer method (e.g. fractional transfer).</span>

<span class="sd">    `r1_cutoff`</span>
<span class="sd">    :   first-round cutoff value.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">transfer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">r1_cutoff</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transfer</span> <span class="o">=</span> <span class="n">transfer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r1_cutoff</span> <span class="o">=</span> <span class="n">r1_cutoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;SNTV&quot;</span>  <span class="c1"># SNTV, switches to STV, then Complete</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates one round an SNTV_STV election.</span>

<span class="sd">        Args:</span>
<span class="sd">            stage: Stage of the hybrid election, can be SNTV or STV.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An ElectionState object for a given round.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>

        <span class="n">new_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;SNTV&quot;</span><span class="p">:</span>
            <span class="n">round_state</span> <span class="o">=</span> <span class="n">SNTV</span><span class="p">(</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r1_cutoff</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>

            <span class="c1"># The STV election will be run on the new election state</span>
            <span class="c1"># Therefore we should not add any winners, but rather</span>
            <span class="c1"># set the SNTV winners as remaining candidates and update pref profiles</span>
            <span class="n">new_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span>
                <span class="n">ballots</span><span class="o">=</span><span class="n">remove_cand</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">),</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
                <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">elected</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
                <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">,</span>
                <span class="n">remaining</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">new_profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">())],</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">new_profile</span><span class="p">,</span>
                <span class="n">scores</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">round_state</span><span class="o">.</span><span class="n">curr_round</span><span class="p">),</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;STV&quot;</span><span class="p">:</span>
            <span class="n">round_state</span> <span class="o">=</span> <span class="n">STV</span><span class="p">(</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
                <span class="n">transfer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transfer</span><span class="p">,</span>
                <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
                <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>

            <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
                <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">elected</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">winners</span><span class="p">(),</span>
                <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated</span><span class="p">(),</span>
                <span class="n">remaining</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
                <span class="n">scores</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">round_state</span><span class="o">.</span><span class="n">curr_round</span><span class="p">),</span>
                <span class="n">profile</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Update election stage to cue next run step</span>
        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;SNTV&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;STV&quot;</span>
        <span class="k">elif</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;STV&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;Complete&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">new_state</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs complete SNTV_STV election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object with results for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">!=</span> <span class="s2">&quot;Complete&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SNTV_STV_Hybrid.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Runs complete SNTV_STV election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object with results for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs complete SNTV_STV election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object with results for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">!=</span> <span class="s2">&quot;Complete&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SNTV_STV_Hybrid.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span></code>

<a href="#votekit.elections.election_types.SNTV_STV_Hybrid.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates one round an SNTV_STV election.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stage of the hybrid election, can be SNTV or STV.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a given round.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates one round an SNTV_STV election.</span>

<span class="sd">    Args:</span>
<span class="sd">        stage: Stage of the hybrid election, can be SNTV or STV.</span>

<span class="sd">    Returns:</span>
<span class="sd">       An ElectionState object for a given round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>

    <span class="n">new_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;SNTV&quot;</span><span class="p">:</span>
        <span class="n">round_state</span> <span class="o">=</span> <span class="n">SNTV</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r1_cutoff</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
        <span class="p">)</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>

        <span class="c1"># The STV election will be run on the new election state</span>
        <span class="c1"># Therefore we should not add any winners, but rather</span>
        <span class="c1"># set the SNTV winners as remaining candidates and update pref profiles</span>
        <span class="n">new_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span>
            <span class="n">ballots</span><span class="o">=</span><span class="n">remove_cand</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">),</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated_cands</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">new_profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">())],</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">new_profile</span><span class="p">,</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">round_state</span><span class="o">.</span><span class="n">curr_round</span><span class="p">),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;STV&quot;</span><span class="p">:</span>
        <span class="n">round_state</span> <span class="o">=</span> <span class="n">STV</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">transfer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transfer</span><span class="p">,</span>
            <span class="n">seats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">,</span>
            <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>

        <span class="n">new_state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">winners</span><span class="p">(),</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">eliminated</span><span class="p">(),</span>
            <span class="n">remaining</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">get_scores</span><span class="p">(</span><span class="n">round_state</span><span class="o">.</span><span class="n">curr_round</span><span class="p">),</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">round_state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Update election stage to cue next run step</span>
    <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;SNTV&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;STV&quot;</span>
    <span class="k">elif</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;STV&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;Complete&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="n">new_state</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.STV" class="doc doc-heading">
          <code>STV</code>


<a href="#votekit.elections.election_types.STV" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Class for single-winner IRV and multi-winner STV elections.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>transfer</code>
:   transfer method (e.g. fractional transfer).</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>quota</code>
:   formula to calculate quota (defaults to droop).</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">STV</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for single-winner IRV and multi-winner STV elections.</span>

<span class="sd">     **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `transfer`</span>
<span class="sd">    :   transfer method (e.g. fractional transfer).</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `quota`</span>
<span class="sd">    :   formula to calculate quota (defaults to droop).</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">transfer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">quota</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;droop&quot;</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># let parent class handle the og profile and election state</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transfer</span> <span class="o">=</span> <span class="n">transfer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quota</span> <span class="o">=</span> <span class="n">quota</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_threshold</span><span class="p">()</span>

    <span class="c1"># can cache since it will not change throughout rounds</span>
    <span class="k">def</span> <span class="nf">get_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates threshold required for election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Value of the threshold.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quota</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quota</span>
        <span class="k">if</span> <span class="n">quota</span> <span class="o">==</span> <span class="s2">&quot;droop&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">quota</span> <span class="o">==</span> <span class="s2">&quot;hare&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Misspelled or unknown quota type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">next_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if the number of seats has been met to call an election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if number of seats has not been met, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cands_elected</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">winners</span><span class="p">():</span>
            <span class="n">cands_elected</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cands_elected</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates one round an STV election.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An ElectionState object for a given round.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
        <span class="n">round_votes</span><span class="p">,</span> <span class="n">plurality_score</span> <span class="o">=</span> <span class="n">compute_votes</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>

        <span class="n">elected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">eliminated</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># if number of remaining candidates equals number of remaining seats,</span>
        <span class="c1"># everyone is elected</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span>
            <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">elected</span> <span class="o">=</span> <span class="p">[{</span><span class="n">cand</span><span class="p">}</span> <span class="k">for</span> <span class="n">cand</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">round_votes</span><span class="p">]</span>
            <span class="n">remaining</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># elect all candidates who crossed threshold</span>
        <span class="k">elif</span> <span class="n">round_votes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">votes</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="c1"># partition ballots by first place candidate</span>
            <span class="n">cand_to_ballot</span> <span class="o">=</span> <span class="n">ballots_by_first_cand</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
            <span class="n">new_ballots</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">votes</span> <span class="ow">in</span> <span class="n">round_votes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">votes</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
                    <span class="n">elected</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">candidate</span><span class="p">})</span>
                    <span class="n">remaining</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
                    <span class="c1"># only transfer on ballots where winner is first</span>
                    <span class="n">new_ballots</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
                        <span class="n">candidate</span><span class="p">,</span>
                        <span class="n">cand_to_ballot</span><span class="p">[</span><span class="n">candidate</span><span class="p">],</span>
                        <span class="n">plurality_score</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># add in remaining ballots where non-winners are first</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">remaining</span><span class="p">:</span>
                <span class="n">new_ballots</span> <span class="o">+=</span> <span class="n">cand_to_ballot</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span>

            <span class="c1"># remove winners from all ballots</span>
            <span class="n">ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">],</span> <span class="n">new_ballots</span><span class="p">)</span>

        <span class="c1"># since no one has crossed threshold, eliminate one of the people</span>
        <span class="c1"># with least first place votes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lp_candidates</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">candidate</span>
                <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">votes</span> <span class="ow">in</span> <span class="n">round_votes</span>
                <span class="k">if</span> <span class="n">votes</span> <span class="o">==</span> <span class="n">round_votes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">votes</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">lp_cand</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">lp_candidates</span><span class="p">)],</span>
                    <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
                    <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
                <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lp_cand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">lp_candidates</span><span class="p">)],</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
                <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">eliminated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">)</span>
            <span class="n">ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
            <span class="n">remaining</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">)))</span>

        <span class="c1"># sorts remaining based on their current first place votes</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">score_dict</span> <span class="o">=</span> <span class="n">compute_votes</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
        <span class="n">remaining</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">score_dict</span><span class="p">,</span> <span class="n">remaining</span><span class="p">)</span>

        <span class="c1"># sort candidates by vote share if multiple are elected</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elected</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">elected</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span>
                <span class="n">plurality_score</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="c1"># Make sure list-of-sets have non-empty elements</span>
        <span class="n">elected</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()]</span>
        <span class="n">eliminated</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">eliminated</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
            <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
            <span class="n">remaining</span><span class="o">=</span><span class="n">remaining</span><span class="p">,</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">score_dict</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">),</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs complete STV election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object with results for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_round</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Length of elected set equal to number of seats (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_round</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.STV.get_threshold" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_threshold</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.STV.get_threshold" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Calculates threshold required for election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value of the threshold.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates threshold required for election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Value of the threshold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quota</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quota</span>
    <span class="k">if</span> <span class="n">quota</span> <span class="o">==</span> <span class="s2">&quot;droop&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">quota</span> <span class="o">==</span> <span class="s2">&quot;hare&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_profile</span><span class="o">.</span><span class="n">num_ballots</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Misspelled or unknown quota type&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.STV.next_round" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">next_round</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.STV.next_round" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Determines if the number of seats has been met to call an election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if number of seats has not been met, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">next_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the number of seats has been met to call an election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if number of seats has not been met, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cands_elected</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">winners</span><span class="p">():</span>
        <span class="n">cands_elected</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cands_elected</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.STV.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.STV.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Runs complete STV election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object with results for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs complete STV election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object with results for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_round</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Length of elected set equal to number of seats (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_round</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.STV.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.STV.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates one round an STV election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a given round.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates one round an STV election.</span>

<span class="sd">    Returns:</span>
<span class="sd">       An ElectionState object for a given round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
    <span class="n">ballots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
    <span class="n">round_votes</span><span class="p">,</span> <span class="n">plurality_score</span> <span class="o">=</span> <span class="n">compute_votes</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>

    <span class="n">elected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">eliminated</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if number of remaining candidates equals number of remaining seats,</span>
    <span class="c1"># everyone is elected</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span>
        <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">winners</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">elected</span> <span class="o">=</span> <span class="p">[{</span><span class="n">cand</span><span class="p">}</span> <span class="k">for</span> <span class="n">cand</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">round_votes</span><span class="p">]</span>
        <span class="n">remaining</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># elect all candidates who crossed threshold</span>
    <span class="k">elif</span> <span class="n">round_votes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">votes</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
        <span class="c1"># partition ballots by first place candidate</span>
        <span class="n">cand_to_ballot</span> <span class="o">=</span> <span class="n">ballots_by_first_cand</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
        <span class="n">new_ballots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">votes</span> <span class="ow">in</span> <span class="n">round_votes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">votes</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
                <span class="n">elected</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">candidate</span><span class="p">})</span>
                <span class="n">remaining</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
                <span class="c1"># only transfer on ballots where winner is first</span>
                <span class="n">new_ballots</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
                    <span class="n">candidate</span><span class="p">,</span>
                    <span class="n">cand_to_ballot</span><span class="p">[</span><span class="n">candidate</span><span class="p">],</span>
                    <span class="n">plurality_score</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="c1"># add in remaining ballots where non-winners are first</span>
        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">remaining</span><span class="p">:</span>
            <span class="n">new_ballots</span> <span class="o">+=</span> <span class="n">cand_to_ballot</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span>

        <span class="c1"># remove winners from all ballots</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">],</span> <span class="n">new_ballots</span><span class="p">)</span>

    <span class="c1"># since no one has crossed threshold, eliminate one of the people</span>
    <span class="c1"># with least first place votes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lp_candidates</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">candidate</span>
            <span class="k">for</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">votes</span> <span class="ow">in</span> <span class="n">round_votes</span>
            <span class="k">if</span> <span class="n">votes</span> <span class="o">==</span> <span class="n">round_votes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">votes</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">lp_cand</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">lp_candidates</span><span class="p">)],</span>
                <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
                <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
            <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lp_cand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">(</span>
                <span class="n">ranking</span><span class="o">=</span><span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">lp_candidates</span><span class="p">)],</span> <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span>
            <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">eliminated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">)</span>
        <span class="n">ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
        <span class="n">remaining</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">lp_cand</span><span class="p">)))</span>

    <span class="c1"># sorts remaining based on their current first place votes</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">score_dict</span> <span class="o">=</span> <span class="n">compute_votes</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>
    <span class="n">remaining</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">score_dict</span><span class="p">,</span> <span class="n">remaining</span><span class="p">)</span>

    <span class="c1"># sort candidates by vote share if multiple are elected</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elected</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">elected</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span>
            <span class="n">plurality_score</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># Make sure list-of-sets have non-empty elements</span>
    <span class="n">elected</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elected</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()]</span>
    <span class="n">eliminated</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">eliminated</span> <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
        <span class="n">curr_round</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">elected</span><span class="o">=</span><span class="n">elected</span><span class="p">,</span>
        <span class="n">eliminated_cands</span><span class="o">=</span><span class="n">eliminated</span><span class="p">,</span>
        <span class="n">remaining</span><span class="o">=</span><span class="n">remaining</span><span class="p">,</span>
        <span class="n">scores</span><span class="o">=</span><span class="n">score_dict</span><span class="p">,</span>
        <span class="n">profile</span><span class="o">=</span><span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots</span><span class="p">),</span>
        <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.SequentialRCV" class="doc doc-heading">
          <code>SequentialRCV</code>


<a href="#votekit.elections.election_types.SequentialRCV" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Class to conduct Sequential RCV election, in which votes are not transferred
after a candidate has reached threshold, or been elected.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
            Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SequentialRCV</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to conduct Sequential RCV election, in which votes are not transferred</span>
<span class="sd">    after a candidate has reached threshold, or been elected.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                Defaults to True.</span>

<span class="sd">    `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">=</span> <span class="n">seats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a single step of the sequential RCV contest or a full</span>
<span class="sd">        IRV election run on the current set of candidates.</span>

<span class="sd">         Returns:</span>
<span class="sd">           An ElectionState object for a given round.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_election_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

        <span class="n">IRVrun</span> <span class="o">=</span> <span class="n">STV</span><span class="p">(</span>
            <span class="n">old_profile</span><span class="p">,</span> <span class="n">transfer</span><span class="o">=</span><span class="n">seqRCV_transfer</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
        <span class="p">)</span>
        <span class="n">old_election</span> <span class="o">=</span> <span class="n">IRVrun</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
        <span class="n">elected_cand</span> <span class="o">=</span> <span class="n">old_election</span><span class="o">.</span><span class="n">winners</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Removes elected candidate from Ballot List</span>
        <span class="n">updated_ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">elected_cand</span><span class="p">,</span> <span class="n">old_profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">())</span>

        <span class="c1"># Updates profile with removed candidates</span>
        <span class="n">updated_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">updated_ballots</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
            <span class="n">curr_round</span><span class="o">=</span><span class="n">old_election_state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">elected</span><span class="o">=</span><span class="p">[</span><span class="n">elected_cand</span><span class="p">],</span>
            <span class="n">profile</span><span class="o">=</span><span class="n">updated_profile</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">old_election_state</span><span class="p">,</span>
            <span class="n">scores</span><span class="o">=</span><span class="n">first_place_votes</span><span class="p">(</span><span class="n">updated_profile</span><span class="p">),</span>
            <span class="n">remaining</span><span class="o">=</span><span class="n">old_election</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete sequential RCV contest.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_profile</span>
        <span class="n">elected</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: ignore</span>
        <span class="n">seqRCV_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">elected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">:</span>
            <span class="n">seqRCV_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">old_profile</span><span class="p">)</span>
            <span class="n">elected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seqRCV_step</span><span class="o">.</span><span class="n">elected</span><span class="p">)</span>
            <span class="n">old_profile</span> <span class="o">=</span> <span class="n">seqRCV_step</span><span class="o">.</span><span class="n">profile</span>
        <span class="k">return</span> <span class="n">seqRCV_step</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SequentialRCV.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.SequentialRCV.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete sequential RCV contest.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete sequential RCV contest.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_profile</span>
    <span class="n">elected</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: ignore</span>
    <span class="n">seqRCV_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">elected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">:</span>
        <span class="n">seqRCV_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">old_profile</span><span class="p">)</span>
        <span class="n">elected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seqRCV_step</span><span class="o">.</span><span class="n">elected</span><span class="p">)</span>
        <span class="n">old_profile</span> <span class="o">=</span> <span class="n">seqRCV_step</span><span class="o">.</span><span class="n">profile</span>
    <span class="k">return</span> <span class="n">seqRCV_step</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.SequentialRCV.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">(</span><span class="n">old_profile</span><span class="p">)</span></code>

<a href="#votekit.elections.election_types.SequentialRCV.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a single step of the sequential RCV contest or a full
IRV election run on the current set of candidates.</p>
<p>Returns:
   An ElectionState object for a given round.</p>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a single step of the sequential RCV contest or a full</span>
<span class="sd">    IRV election run on the current set of candidates.</span>

<span class="sd">     Returns:</span>
<span class="sd">       An ElectionState object for a given round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_election_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="n">IRVrun</span> <span class="o">=</span> <span class="n">STV</span><span class="p">(</span>
        <span class="n">old_profile</span><span class="p">,</span> <span class="n">transfer</span><span class="o">=</span><span class="n">seqRCV_transfer</span><span class="p">,</span> <span class="n">seats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span>
    <span class="p">)</span>
    <span class="n">old_election</span> <span class="o">=</span> <span class="n">IRVrun</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
    <span class="n">elected_cand</span> <span class="o">=</span> <span class="n">old_election</span><span class="o">.</span><span class="n">winners</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Removes elected candidate from Ballot List</span>
    <span class="n">updated_ballots</span> <span class="o">=</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">elected_cand</span><span class="p">,</span> <span class="n">old_profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">())</span>

    <span class="c1"># Updates profile with removed candidates</span>
    <span class="n">updated_profile</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">updated_ballots</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">ElectionState</span><span class="p">(</span>
        <span class="n">curr_round</span><span class="o">=</span><span class="n">old_election_state</span><span class="o">.</span><span class="n">curr_round</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">elected</span><span class="o">=</span><span class="p">[</span><span class="n">elected_cand</span><span class="p">],</span>
        <span class="n">profile</span><span class="o">=</span><span class="n">updated_profile</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">old_election_state</span><span class="p">,</span>
        <span class="n">scores</span><span class="o">=</span><span class="n">first_place_votes</span><span class="p">(</span><span class="n">updated_profile</span><span class="p">),</span>
        <span class="n">remaining</span><span class="o">=</span><span class="n">old_election</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="votekit.elections.election_types.TopTwo" class="doc doc-heading">
          <code>TopTwo</code>


<a href="#votekit.elections.election_types.TopTwo" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="votekit.models.Election">Election</span></code></p>

  
      <p>Eliminates all but the top two plurality vote getters, and then
conducts a runoff between them, reallocating other ballots.</p>
<p><strong>Attributes</strong></p>
<p><code>profile</code>
:   PreferenceProfile to run election on.</p>
<p><code>seats</code>
:   number of seats to be elected.</p>
<p><code>ballot_ties</code>
:   (optional) resolves input ballot ties if True, else assumes ballots have no ties.
                Defaults to True.</p>
<p><code>tiebreak</code>
:   (optional) resolves procedural and final ties by specified tiebreak.
                Can either be a custom tiebreak function or a string. Supported strings are
                given in <code>tie_broken_ranking</code> documentation. The custom function must take as
                input two named parameters; <code>ranking</code>, a list-of-sets ranking of candidates and
                <code>profile</code>, the original <code>PreferenceProfile</code>. It must return a list-of-sets
                ranking of candidates with no ties. Defaults to random tiebreak.</p>
<p><strong>Methods</strong></p>

            <details class="quote">
              <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TopTwo</span><span class="p">(</span><span class="n">Election</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Eliminates all but the top two plurality vote getters, and then</span>
<span class="sd">    conducts a runoff between them, reallocating other ballots.</span>

<span class="sd">    **Attributes**</span>

<span class="sd">    `profile`</span>
<span class="sd">    :   PreferenceProfile to run election on.</span>

<span class="sd">    `seats`</span>
<span class="sd">    :   number of seats to be elected.</span>

<span class="sd">    `ballot_ties`</span>
<span class="sd">    :   (optional) resolves input ballot ties if True, else assumes ballots have no ties.</span>
<span class="sd">                    Defaults to True.</span>

<span class="sd">     `tiebreak`</span>
<span class="sd">    :   (optional) resolves procedural and final ties by specified tiebreak.</span>
<span class="sd">                    Can either be a custom tiebreak function or a string. Supported strings are</span>
<span class="sd">                    given in `tie_broken_ranking` documentation. The custom function must take as</span>
<span class="sd">                    input two named parameters; `ranking`, a list-of-sets ranking of candidates and</span>
<span class="sd">                    `profile`, the original `PreferenceProfile`. It must return a list-of-sets</span>
<span class="sd">                    ranking of candidates with no ties. Defaults to random tiebreak.</span>

<span class="sd">    **Methods**</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
        <span class="n">ballot_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_ties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span> <span class="o">=</span> <span class="n">tiebreak</span>

    <span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conducts a TopTwo election for one seat with a cutoff of 2 for the runoff.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for the TopTwo election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hybrid_equivalent</span> <span class="o">=</span> <span class="n">SNTV_STV_Hybrid</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
            <span class="n">transfer</span><span class="o">=</span><span class="n">fractional_transfer</span><span class="p">,</span>
            <span class="n">r1_cutoff</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">seats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">hybrid_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
        <span class="k">return</span> <span class="n">outcome</span>

    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates a complete TopTwo election.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An ElectionState object for a complete election.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.TopTwo.run_election" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_election</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#votekit.elections.election_types.TopTwo.run_election" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Simulates a complete TopTwo election.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for a complete election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span>
<span class="k">def</span> <span class="nf">run_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a complete TopTwo election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for a complete election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_step</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="votekit.elections.election_types.TopTwo.run_step" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_step</span><span class="p">()</span></code>

<a href="#votekit.elections.election_types.TopTwo.run_step" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Conducts a TopTwo election for one seat with a cutoff of 2 for the runoff.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.election_state.ElectionState" href="#votekit.election_state.ElectionState">ElectionState</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ElectionState object for the TopTwo election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/election_types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ElectionState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conducts a TopTwo election for one seat with a cutoff of 2 for the runoff.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ElectionState object for the TopTwo election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hybrid_equivalent</span> <span class="o">=</span> <span class="n">SNTV_STV_Hybrid</span><span class="p">(</span>
        <span class="n">profile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">profile</span><span class="p">,</span>
        <span class="n">transfer</span><span class="o">=</span><span class="n">fractional_transfer</span><span class="p">,</span>
        <span class="n">r1_cutoff</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">seats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">tiebreak</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tiebreak</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">hybrid_equivalent</span><span class="o">.</span><span class="n">run_election</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">outcome</span>
    <span class="k">return</span> <span class="n">outcome</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="cleaning">Cleaning<a class="headerlink" href="#cleaning" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.cleaning.clean_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">clean_profile</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">clean_ballot_func</span><span class="p">)</span></code>

<a href="#votekit.cleaning.clean_profile" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Allows user-defined cleaning rules for PreferenceProfile. Input function
that applies modification or rule to a single ballot.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile to clean.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>clean_ballot_func</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>], <a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function that
takes a list of ballots and cleans each ballot.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A cleaned PreferenceProfile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cleaning.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_profile</span><span class="p">(</span>
    <span class="n">pp</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">clean_ballot_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Ballot</span><span class="p">],</span> <span class="n">Ballot</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows user-defined cleaning rules for PreferenceProfile. Input function</span>
<span class="sd">    that applies modification or rule to a single ballot.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp (PreferenceProfile): A PreferenceProfile to clean.</span>
<span class="sd">        clean_ballot_func (Callable[[Ballot], Ballot]): Function that</span>
<span class="sd">            takes a list of ballots and cleans each ballot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A cleaned PreferenceProfile.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># apply cleaning function to clean all ballots</span>
    <span class="k">if</span> <span class="n">clean_ballot_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">clean_ballot_func</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">ballots</span><span class="p">)</span>
    <span class="c1"># group ballots that have the same ranking after cleaning</span>
    <span class="n">grouped_ballots</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ballot</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="c1"># merge ballots in the same groups</span>
    <span class="n">new_ballots</span> <span class="o">=</span> <span class="p">[</span><span class="n">merge_ballots</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">grouped_ballots</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">new_ballots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.cleaning.deduplicate_profiles" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">deduplicate_profiles</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span></code>

<a href="#votekit.cleaning.deduplicate_profiles" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given a PreferenceProfile, deduplicates its ballots.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile to clean.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A cleaned PreferenceProfile without duplicates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cleaning.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">deduplicate_profiles</span><span class="p">(</span><span class="n">pp</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a PreferenceProfile, deduplicates its ballots.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp (PreferenceProfile): A PreferenceProfile to clean.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A cleaned PreferenceProfile without duplicates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">deduplicate_ballots</span><span class="p">(</span><span class="n">ballot</span><span class="p">:</span> <span class="n">Ballot</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Ballot</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a ballot and deduplicates its rankings.</span>

<span class="sd">        Args:</span>
<span class="sd">            ballot (Ballot): a ballot with duplicates in its ranking.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Ballot: a ballot without duplicates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
        <span class="n">dedup_ranking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ranking</span> <span class="ow">and</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dedup_ranking</span><span class="p">:</span>
                <span class="n">dedup_ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand</span><span class="p">)</span>
        <span class="n">new_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">),</span>
            <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dedup_ranking</span><span class="p">),</span>
            <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_ballot</span>

    <span class="n">pp_clean</span> <span class="o">=</span> <span class="n">clean_profile</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">clean_ballot_func</span><span class="o">=</span><span class="n">deduplicate_ballots</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pp_clean</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.cleaning.merge_ballots" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">merge_ballots</span><span class="p">(</span><span class="n">ballots</span><span class="p">)</span></code>

<a href="#votekit.cleaning.merge_ballots" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Takes a list of ballots with the same ranking and merge them into one ballot.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of ballots to deduplicate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A ballot with the same ranking and aggregated weight and voters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cleaning.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge_ballots</span><span class="p">(</span><span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Ballot</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a list of ballots with the same ranking and merge them into one ballot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ballots (list[Ballot]): A list of ballots to deduplicate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Ballot): A ballot with the same ranking and aggregated weight and voters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">weight</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">)</span>
    <span class="n">ranking</span> <span class="o">=</span> <span class="n">ballots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ranking</span>
    <span class="n">voters_to_merge</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">voter_set</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">ballots</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">voter_set</span><span class="p">]</span>
    <span class="n">voter_set</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters_to_merge</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">voter_set</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">:</span> <span class="n">b1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">b2</span><span class="p">),</span> <span class="n">voters_to_merge</span><span class="p">)</span>
        <span class="n">voter_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">voter_set</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ballot</span><span class="p">(</span><span class="n">ranking</span><span class="o">=</span><span class="n">ranking</span><span class="p">,</span> <span class="n">voter_set</span><span class="o">=</span><span class="n">voter_set</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.cleaning.remove_empty_ballots" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_empty_ballots</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">keep_candidates</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.cleaning.remove_empty_ballots" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes empty ballots from a PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile to clean.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keep_candidates</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, keep all of the candidates
from the original PreferenceProfile in the returned PreferenceProfile, even if
they got no votes. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A cleaned PreferenceProfile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cleaning.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_empty_ballots</span><span class="p">(</span>
    <span class="n">pp</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">keep_candidates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes empty ballots from a PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp (PreferenceProfile): A PreferenceProfile to clean.</span>
<span class="sd">        keep_candidates (bool, optional): If True, keep all of the candidates</span>
<span class="sd">            from the original PreferenceProfile in the returned PreferenceProfile, even if</span>
<span class="sd">            they got no votes. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A cleaned PreferenceProfile.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ballots_nonempty</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">deepcopy</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span> <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span> <span class="k">if</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">keep_candidates</span><span class="p">:</span>
        <span class="n">old_cands</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">())</span>
        <span class="n">pp_clean</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots_nonempty</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="n">old_cands</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pp_clean</span> <span class="o">=</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">ballots_nonempty</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pp_clean</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.cleaning.remove_noncands" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_noncands</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">non_cands</span><span class="p">)</span></code>

<a href="#votekit.cleaning.remove_noncands" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes user-assigned non-candidates from ballots, deletes ballots
that are empty as a result of the removal.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile to clean.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>non_cands</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of non-candidates to be removed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A profile with non-candidates removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/cleaning.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_noncands</span><span class="p">(</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">non_cands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PreferenceProfile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes user-assigned non-candidates from ballots, deletes ballots</span>
<span class="sd">    that are empty as a result of the removal.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile (PreferenceProfile): A PreferenceProfile to clean.</span>
<span class="sd">        non_cands (list[str]): A list of non-candidates to be removed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (PreferenceProfile): A profile with non-candidates removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">remove_from_ballots</span><span class="p">(</span><span class="n">ballot</span><span class="p">:</span> <span class="n">Ballot</span><span class="p">,</span> <span class="n">non_cands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Ballot</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes non-candidiates from ballot objects.</span>

<span class="sd">        Args:</span>
<span class="sd">            ballot (Ballot): a ballot to be cleaned.</span>
<span class="sd">            non_cands (list[str]): a list of candidates to remove.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Ballot: returns a cleaned Ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: adjust so string and list of strings are acceptable inputes</span>

        <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">non_cands</span><span class="p">:</span>
            <span class="n">to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">item</span><span class="p">})</span>

        <span class="n">ranking</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span>
        <span class="n">clean_ranking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_remove</span> <span class="ow">and</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clean_ranking</span><span class="p">:</span>
                <span class="n">clean_ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand</span><span class="p">)</span>

        <span class="n">clean_ballot</span> <span class="o">=</span> <span class="n">Ballot</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">clean_ranking</span><span class="p">),</span>
            <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">),</span>
            <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">clean_ballot</span>

    <span class="n">cleaned</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">remove_from_ballots</span><span class="p">(</span><span class="n">ballot</span><span class="p">,</span> <span class="n">non_cands</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">ballots</span>
        <span class="k">if</span> <span class="n">remove_from_ballots</span><span class="p">(</span><span class="n">ballot</span><span class="p">,</span> <span class="n">non_cands</span><span class="p">)</span><span class="o">.</span><span class="n">ranking</span>
    <span class="p">]</span>
    <span class="n">grouped_ballots</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">cleaned</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ballot</span><span class="p">:</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="c1"># merge ballots in the same groups</span>
    <span class="n">new_ballots</span> <span class="o">=</span> <span class="p">[</span><span class="n">merge_ballots</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">grouped_ballots</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">PreferenceProfile</span><span class="p">(</span><span class="n">ballots</span><span class="o">=</span><span class="n">new_ballots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.utils.borda_scores" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">borda_scores</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">ballot_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">score_vector</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#votekit.utils.borda_scores" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates Borda scores for a PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Inputed PreferenceProfile of ballots.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballot_length</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Length of a ballot, if None length of longest ballot is
used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>score_vector</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Borda weights, if None, vector is assigned <span class="arithmatex">\((n,n-1,\dots,1)\)</span>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of candidates (keys) and Borda scores (values).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">borda_scores</span><span class="p">(</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
    <span class="n">ballot_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">score_vector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Borda scores for a PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile: Inputed PreferenceProfile of ballots.</span>
<span class="sd">        ballot_length: Length of a ballot, if None length of longest ballot is</span>
<span class="sd">            used.</span>
<span class="sd">        score_vector: Borda weights, if None, vector is assigned $(n,n-1,\dots,1)$.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): Dictionary of candidates (keys) and Borda scores (values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ballot_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ballot_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">)</span> <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">ballots</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">score_vector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">score_vector</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ballot_length</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="n">candidate_borda</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">ballots</span><span class="p">:</span>
        <span class="n">current_ind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">candidates_covered</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="n">position_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">local_score_vector</span> <span class="o">=</span> <span class="n">score_vector</span><span class="p">[</span><span class="n">current_ind</span> <span class="p">:</span> <span class="n">current_ind</span> <span class="o">+</span> <span class="n">position_size</span><span class="p">]</span>
            <span class="n">borda_allocation</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">local_score_vector</span><span class="p">)</span> <span class="o">/</span> <span class="n">position_size</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">candidate_borda</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">borda_allocation</span><span class="p">)</span> <span class="o">*</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
            <span class="n">current_ind</span> <span class="o">+=</span> <span class="n">position_size</span>
            <span class="n">candidates_covered</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="c1"># If ballot was incomplete, evenly allocation remaining points</span>
        <span class="k">if</span> <span class="n">current_ind</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">score_vector</span><span class="p">):</span>
            <span class="n">remainder_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">candidates_covered</span><span class="p">))</span>
            <span class="n">remainder_score_vector</span> <span class="o">=</span> <span class="n">score_vector</span><span class="p">[</span><span class="n">current_ind</span><span class="p">:]</span>
            <span class="n">remainder_borda_allocation</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">remainder_score_vector</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">remainder_cands</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">remainder_cands</span><span class="p">:</span>
                <span class="n">candidate_borda</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">Fraction</span><span class="p">(</span><span class="n">remainder_borda_allocation</span><span class="p">)</span> <span class="o">*</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">candidate_borda</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.first_place_votes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">first_place_votes</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">to_float</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#votekit.utils.first_place_votes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates first-place votes for a PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Inputed PreferenceProfile of ballots.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>to_float</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, compute first place votes as floats instead of Fractions. Defaults to
        False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of candidates (keys) and first place vote totals (values).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">first_place_votes</span><span class="p">(</span><span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">to_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates first-place votes for a PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile: Inputed PreferenceProfile of ballots.</span>

<span class="sd">        to_float: If True, compute first place votes as floats instead of Fractions. Defaults to</span>
<span class="sd">                    False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of candidates (keys) and first place vote totals (values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cands</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()</span>
    <span class="n">ballots</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">votes_dict</span> <span class="o">=</span> <span class="n">compute_votes</span><span class="p">(</span><span class="n">cands</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_float</span><span class="p">:</span>
        <span class="n">votes_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votes_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="n">votes_dict</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">votes_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.mentions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">mentions</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span></code>

<a href="#votekit.utils.mentions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates total mentions for a PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Inputed PreferenceProfile of ballots.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of candidates (keys) and mention totals (values).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mentions</span><span class="p">(</span><span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates total mentions for a PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile: Inputed PreferenceProfile of ballots.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of candidates (keys) and mention totals (values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mentions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">ballots</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_ballots</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">rank</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mentions</span><span class="p">:</span>
                    <span class="n">mentions</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">mentions</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">rank</span><span class="p">))</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span>
                        <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>
                    <span class="p">)</span>  <span class="c1"># split mentions for candidates that are tied</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mentions</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mentions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.metrics.distances.earth_mover_dist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">earth_mover_dist</span><span class="p">(</span><span class="n">pp1</span><span class="p">,</span> <span class="n">pp2</span><span class="p">)</span></code>

<a href="#votekit.metrics.distances.earth_mover_dist" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Computes the earth mover distance between two elections.
Assumes both elections share the same candidates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp1</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile for first election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pp2</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile for second election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Earth mover distance between inputted elections.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/metrics/distances.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">earth_mover_dist</span><span class="p">(</span><span class="n">pp1</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">pp2</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the earth mover distance between two elections.</span>
<span class="sd">    Assumes both elections share the same candidates.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp1: PreferenceProfile for first election.</span>
<span class="sd">        pp2: PreferenceProfile for second election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Earth mover distance between inputted elections.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create ballot graph</span>
    <span class="n">ballot_graph</span> <span class="o">=</span> <span class="n">BallotGraph</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">pp2</span><span class="p">)</span><span class="o">.</span><span class="n">graph</span>
    <span class="c1"># ballot_graph = graph.from_profile(profile=pp2, complete=True)</span>

    <span class="c1"># Solving Earth Mover Distance</span>
    <span class="n">electA_distr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">em_array</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="n">pp1</span><span class="p">))</span>
    <span class="n">electB_distr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">em_array</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="n">pp2</span><span class="p">))</span>

    <span class="c1"># Floyd Warshall Shortest Distance alorithm. Returns a dictionary of shortest path for each node</span>
    <span class="n">fw_dist_dict</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">floyd_warshall</span><span class="p">(</span><span class="n">ballot_graph</span><span class="p">)</span>
    <span class="n">keys_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fw_dist_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">cost_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">keys_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys_list</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys_list</span><span class="p">)):</span>
        <span class="n">node_dict</span> <span class="o">=</span> <span class="n">fw_dist_dict</span><span class="p">[</span><span class="n">keys_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">cost_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">node_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())]</span>
        <span class="n">cost_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cost_col</span>
    <span class="n">earth_mover_matrix</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">emd</span><span class="p">(</span><span class="n">electA_distr</span><span class="p">,</span> <span class="n">electB_distr</span><span class="p">,</span> <span class="n">cost_matrix</span><span class="p">)</span>

    <span class="c1"># Hadamard Product = Earth mover dist between two matrices</span>
    <span class="n">earth_mover_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">earth_mover_matrix</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">earth_mover_dist</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.metrics.distances.lp_dist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">lp_dist</span><span class="p">(</span><span class="n">pp1</span><span class="p">,</span> <span class="n">pp2</span><span class="p">,</span> <span class="n">p_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#votekit.metrics.distances.lp_dist" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Computes the L_p distance between two election distributions.
Use 'inf' for infinity norm.
Assumes both elections share the same candidates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp1</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile for first election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pp2</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile for second election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p_value</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[int, str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distance parameter, 1 for Manhattan, 2 for Euclidean
or 'inf' for Chebyshev distance.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lp distance between two elections.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/metrics/distances.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">lp_dist</span><span class="p">(</span>
    <span class="n">pp1</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
    <span class="n">pp2</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span>
    <span class="n">p_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the L_p distance between two election distributions.</span>
<span class="sd">    Use &#39;inf&#39; for infinity norm.</span>
<span class="sd">    Assumes both elections share the same candidates.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp1: PreferenceProfile for first election.</span>
<span class="sd">        pp2: PreferenceProfile for second election.</span>
<span class="sd">        p_value: Distance parameter, 1 for Manhattan, 2 for Euclidean</span>
<span class="sd">            or &#39;inf&#39; for Chebyshev distance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Lp distance between two elections.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pp1</span><span class="p">,</span> <span class="n">pp2</span><span class="p">]</span>
    <span class="n">pp_2arry</span> <span class="o">=</span> <span class="n">profiles_to_ndarrys</span><span class="p">(</span><span class="n">pp_list</span><span class="p">)</span>
    <span class="n">electA</span> <span class="o">=</span> <span class="n">pp_2arry</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">electB</span> <span class="o">=</span> <span class="n">pp_2arry</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">electA</span><span class="p">)):</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">electA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">electB</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">**</span> <span class="n">p_value</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">diff</span>
        <span class="n">lp_dist</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">p_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lp_dist</span>

    <span class="k">elif</span> <span class="n">p_value</span> <span class="o">==</span> <span class="s2">&quot;inf&quot;</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">electA</span><span class="p">,</span> <span class="n">electB</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported input type&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.metrics.distances.em_array" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">em_array</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span></code>

<a href="#votekit.metrics.distances.em_array" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Converts a PreferenceProfile into a distribution using ballot graphs.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile for a given election.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distribution of ballots for an election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/metrics/distances.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">em_array</span><span class="p">(</span><span class="n">pp</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a PreferenceProfile into a distribution using ballot graphs.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp: PreferenceProfile for a given election.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Distribution of ballots for an election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ballot_graph</span> <span class="o">=</span> <span class="n">BallotGraph</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">pp</span><span class="p">)</span>
    <span class="n">node_cand_map</span> <span class="o">=</span> <span class="n">ballot_graph</span><span class="o">.</span><span class="n">label_cands</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">()))</span>
    <span class="n">pp_dict</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># invert node_cand_map to map to pp_dict</span>
    <span class="c1"># split is used to remove the custom labeling from the ballotgraph</span>
    <span class="n">inverted</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">node_cand_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">combined_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">node_cand_map</span><span class="p">}</span>

    <span class="c1"># map nodes with weight of corresponding rank</span>
    <span class="c1"># labels on ballotgraph are strings so need to convert key to string</span>
    <span class="n">node_pp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">inverted</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]:</span> <span class="n">pp_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pp_dict</span><span class="p">}</span>

    <span class="n">complete_election_dict</span> <span class="o">=</span> <span class="n">combined_dict</span> <span class="o">|</span> <span class="n">node_pp_dict</span>
    <span class="n">elect_distr</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">complete_election_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">complete_election_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">elect_distr</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.elections.transfers.fractional_transfer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fractional_transfer</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">ballots</span><span class="p">,</span> <span class="n">votes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>

<a href="#votekit.elections.transfers.fractional_transfer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Calculates fractional transfer from winner, then removes winner
from the list of ballots.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>winner</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Candidate to transfer votes from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballot objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>votes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Contains candidates and their corresponding vote totals.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value required to be elected, used to calculate transfer value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Modified ballots with transfered weights and the winning candidate removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/transfers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fractional_transfer</span><span class="p">(</span>
    <span class="n">winner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">],</span> <span class="n">votes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates fractional transfer from winner, then removes winner</span>
<span class="sd">    from the list of ballots.</span>

<span class="sd">    Args:</span>
<span class="sd">        winner: Candidate to transfer votes from.</span>
<span class="sd">        ballots: List of Ballot objects.</span>
<span class="sd">        votes: Contains candidates and their corresponding vote totals.</span>
<span class="sd">        threshold: Value required to be elected, used to calculate transfer value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Modified ballots with transfered weights and the winning candidate removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transfer_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">votes</span><span class="p">[</span><span class="n">winner</span><span class="p">]</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">/</span> <span class="n">votes</span><span class="p">[</span><span class="n">winner</span><span class="p">]</span>

    <span class="n">transfered_ballots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="n">new_ranking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="ow">and</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="n">winner</span><span class="p">}:</span>
            <span class="n">transfered_weight</span> <span class="o">=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">transfer_value</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cand</span> <span class="o">!=</span> <span class="p">{</span><span class="n">winner</span><span class="p">}:</span>
                    <span class="n">new_ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">cand</span><span class="p">))</span>
            <span class="n">transfered_ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Ballot</span><span class="p">(</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_ranking</span><span class="p">),</span>
                    <span class="n">weight</span><span class="o">=</span><span class="n">transfered_weight</span><span class="p">,</span>
                    <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
                    <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transfered_ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">transfered_ballots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.elections.transfers.seqRCV_transfer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">seqRCV_transfer</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">ballots</span><span class="p">,</span> <span class="n">votes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>

<a href="#votekit.elections.transfers.seqRCV_transfer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transfer method for Sequential RCV elections.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>winner</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Candidate to transfer votes from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballot objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>votes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Contains candidates and their corresponding vote totals.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value required to be elected, used to calculate transfer value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Original list of ballots as Sequential RCV does not transfer votes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/transfers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seqRCV_transfer</span><span class="p">(</span>
    <span class="n">winner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">],</span> <span class="n">votes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transfer method for Sequential RCV elections.</span>

<span class="sd">    Args:</span>
<span class="sd">        winner: Candidate to transfer votes from.</span>
<span class="sd">        ballots: List of Ballot objects.</span>
<span class="sd">        votes: Contains candidates and their corresponding vote totals.</span>
<span class="sd">        threshold: Value required to be elected, used to calculate transfer value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Original list of ballots as Sequential RCV does not transfer votes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ballots</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.elections.transfers.random_transfer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">random_transfer</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">ballots</span><span class="p">,</span> <span class="n">votes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>

<a href="#votekit.elections.transfers.random_transfer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Cambridge-style transfer where transfer ballots are selected randomly.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>winner</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Candidate to transfer votes from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballot objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>votes</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Contains candidates and their corresponding vote totals.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value required to be elected, used to calculate transfer value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Modified ballots with transferred weights and the winning candidate removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/elections/transfers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_transfer</span><span class="p">(</span>
    <span class="n">winner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">],</span> <span class="n">votes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cambridge-style transfer where transfer ballots are selected randomly.</span>

<span class="sd">    Args:</span>
<span class="sd">        winner: Candidate to transfer votes from.</span>
<span class="sd">        ballots: List of Ballot objects.</span>
<span class="sd">        votes: Contains candidates and their corresponding vote totals.</span>
<span class="sd">        threshold: Value required to be elected, used to calculate transfer value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Modified ballots with transferred weights and the winning candidate removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># turn all of winner&#39;s ballots into (multiple) ballots of weight 1</span>
    <span class="n">weight_1_ballots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">updated_ballots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span> <span class="ow">and</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="n">winner</span><span class="p">}:</span>
            <span class="c1"># note: under random transfer, weights should always be integers</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">)):</span>
                <span class="n">weight_1_ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Ballot</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">ranking</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">,</span>
                        <span class="n">weight</span><span class="o">=</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>

    <span class="n">surplus_ballots</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">weight_1_ballots</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">votes</span><span class="p">[</span><span class="n">winner</span><span class="p">])</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="n">updated_ballots</span> <span class="o">+=</span> <span class="n">surplus_ballots</span>

    <span class="k">return</span> <span class="n">remove_cand</span><span class="p">(</span><span class="n">winner</span><span class="p">,</span> <span class="n">updated_ballots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="plotting">Plotting<a class="headerlink" href="#plotting" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.plots.mds.compute_MDS" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_MDS</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">47</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#votekit.plots.mds.compute_MDS" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Computes the coordinates of an MDS plot. This is time intensive, so it is decoupled from
<code>plot_mds</code> to allow users to flexibly use the coordinates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, list[<a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with key being a string label and value being list of
        PreferenceProfiles. ex: {'PL with alpha = 4': list[PreferenceProfile]}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[..., int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distance function. See distance.py.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>random_seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>an integer seed to allow for reproducible MDS plots. Defaults to 47.</p>
            </div>
          </td>
          <td>
                <code>47</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>coord_dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a dictionary whose keys match <code>data</code> and whose values are tuples of</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy arrays (x_list, y_list) of coordinates for the MDS plot.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/plots/mds.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_MDS</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">]],</span>
    <span class="n">distance</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">random_seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">47</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the coordinates of an MDS plot. This is time intensive, so it is decoupled from</span>
<span class="sd">    `plot_mds` to allow users to flexibly use the coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Dictionary with key being a string label and value being list of</span>
<span class="sd">                    PreferenceProfiles. ex: {&#39;PL with alpha = 4&#39;: list[PreferenceProfile]}</span>
<span class="sd">        distance: Distance function. See distance.py.</span>
<span class="sd">        random_seed (int): an integer seed to allow for reproducible MDS plots. Defaults to 47.</span>

<span class="sd">    Returns:</span>
<span class="sd">        coord_dict (dict): a dictionary whose keys match `data` and whose values are tuples of</span>
<span class="sd">        numpy arrays (x_list, y_list) of coordinates for the MDS plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># combine all lists to create distance matrix</span>
    <span class="n">combined_pp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pp_list</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">combined_pp</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pp_list</span><span class="p">)</span>

    <span class="c1"># compute distance matrix</span>
    <span class="n">dist_matrix</span> <span class="o">=</span> <span class="n">distance_matrix</span><span class="p">(</span><span class="n">combined_pp</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">mds</span> <span class="o">=</span> <span class="n">manifold</span><span class="o">.</span><span class="n">MDS</span><span class="p">(</span>
        <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span>
        <span class="n">eps</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span>
        <span class="n">dissimilarity</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">normalized_stress</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">mds</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">))</span><span class="o">.</span><span class="n">embedding_</span>

    <span class="n">coord_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">start_pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># color, label, marker = key</span>
        <span class="n">end_pos</span> <span class="o">=</span> <span class="n">start_pos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span>
        <span class="n">coord_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">start_pos</span><span class="p">:</span><span class="n">end_pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="n">start_pos</span><span class="p">:</span><span class="n">end_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">start_pos</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">coord_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.plots.mds.distance_matrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">distance_matrix</span><span class="p">(</span><span class="n">pp_arr</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#votekit.plots.mds.distance_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates pairwise distance matrix between PreferenceProfile. The <span class="arithmatex">\((i,j)\)</span> entry is the pairwise
distance between <span class="arithmatex">\(i\)</span>th and the <span class="arithmatex">\(j\)</span>th PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pp_arr</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of PreferenceProfiles.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span>[..., int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callable distance function type. See distances.py in the metrics module.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dist_matrix</code></td>          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distance matrix for an election.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/plots/mds.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">distance_matrix</span><span class="p">(</span>
    <span class="n">pp_arr</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PreferenceProfile</span><span class="p">],</span> <span class="n">distance</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates pairwise distance matrix between PreferenceProfile. The $(i,j)$ entry is the pairwise</span>
<span class="sd">    distance between $i$th and the $j$th PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        pp_arr: List of PreferenceProfiles.</span>
<span class="sd">        distance: Callable distance function type. See distances.py in the metrics module.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dist_matrix (ndarray): Distance matrix for an election.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pp_arr</span><span class="p">)</span>
    <span class="n">dist_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="n">rows</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
            <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">pp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pp_arr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">dist_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dist_matrix</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.plots.mds.plot_MDS" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_MDS</span><span class="p">(</span><span class="n">coord_dict</span><span class="p">,</span> <span class="n">plot_kwarg_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#votekit.plots.mds.plot_MDS" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates an MDS plot from the output of <code>compute_MDS</code> with legend labels matching the keys
of <code>coord_dict</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>coord_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with key being a string label and value being tuple</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plot_kwarg_dict</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with keys matching coord_dict and values are kwarg dictionaries
that will be passed to matplotlib <code>scatter</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>legend</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>boolean for plotting the legend. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>boolean for plotting the title. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fig</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a matplotlib fig</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/plots/mds.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_MDS</span><span class="p">(</span>
    <span class="n">coord_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">plot_kwarg_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an MDS plot from the output of `compute_MDS` with legend labels matching the keys</span>
<span class="sd">    of `coord_dict`.</span>

<span class="sd">    Args:</span>
<span class="sd">        coord_dict: Dictionary with key being a string label and value being tuple</span>
<span class="sd">        (x_list, y_list), coordinates for the MDS plot.</span>
<span class="sd">        Should be piped in from `compute_MDS`.</span>

<span class="sd">        plot_kwarg_dict: Dictionary with keys matching coord_dict and values are kwarg dictionaries</span>
<span class="sd">            that will be passed to matplotlib `scatter`.</span>

<span class="sd">        legend: boolean for plotting the legend. Defaults to True.</span>

<span class="sd">        title: boolean for plotting the title. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fig: a matplotlib fig</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Plot data</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">coord_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">plot_kwarg_dict</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plot_kwarg_dict</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwarg_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MDS Plot for Pairwise Election Distances&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.plots.profile_plots.plot_summary_stats" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_summary_stats</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">stat</span><span class="p">,</span> <span class="n">multi_color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#votekit.plots.profile_plots.plot_summary_stats" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plots histogram of election summary statistics.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A PreferenceProfile to visualize.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stat</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>'first place votes', 'mentions', or 'borda'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>multi_color</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the bars should be multicolored. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Title for the figure. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A figure with the visualization.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/plots/profile_plots.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_summary_stats</span><span class="p">(</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">stat</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">multi_color</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots histogram of election summary statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        profile (PreferenceProfile): A PreferenceProfile to visualize.</span>
<span class="sd">        stat (str): &#39;first place votes&#39;, &#39;mentions&#39;, or &#39;borda&#39;.</span>
<span class="sd">        multi_color (bool, optional): If the bars should be multicolored. Defaults to True.</span>
<span class="sd">        title (str, optional): Title for the figure. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Figure): A figure with the visualization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;first place votes&quot;</span><span class="p">:</span> <span class="n">first_place_votes</span><span class="p">,</span>
        <span class="s2">&quot;mentions&quot;</span><span class="p">:</span> <span class="n">mentions</span><span class="p">,</span>
        <span class="s2">&quot;borda&quot;</span><span class="p">:</span> <span class="n">borda_scores</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">stat_func</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">stat</span><span class="p">]</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">stat_func</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">multi_color</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">COLOR_LIST</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">COLOR_LIST</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="n">candidates</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_candidates</span><span class="p">(</span><span class="n">received_votes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Candidates&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="utils">Utils<a class="headerlink" href="#utils" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="votekit.utils.compute_votes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_votes</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span></code>

<a href="#votekit.utils.compute_votes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Computes first place votes for all candidates in a PreferenceProfile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>candidates</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of all candidates in a PreferenceProfile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballot objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[list[<span title="votekit.utils.CandidateVotes">CandidateVotes</span>], dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple (ordered, votes) where ordered is a list of tuples (cand, first place votes)
ordered by decreasing first place votes and votes is a dictionary whose keys are
candidates and values are first place votes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_votes</span><span class="p">(</span>
    <span class="n">candidates</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">CandidateVotes</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes first place votes for all candidates in a PreferenceProfile.</span>

<span class="sd">    Args:</span>
<span class="sd">        candidates: List of all candidates in a PreferenceProfile.</span>
<span class="sd">        ballots: List of Ballot objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple (ordered, votes) where ordered is a list of tuples (cand, first place votes)</span>
<span class="sd">            ordered by decreasing first place votes and votes is a dictionary whose keys are</span>
<span class="sd">            candidates and values are first place votes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">votes</span> <span class="o">=</span> <span class="p">{</span><span class="n">cand</span><span class="p">:</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">first_place_cand</span> <span class="o">=</span> <span class="n">unset</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_place_cand</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">first_place_cand</span><span class="p">:</span>
                <span class="n">votes</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_place_cand</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">votes</span><span class="p">[</span><span class="n">first_place_cand</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ballot</span><span class="o">.</span><span class="n">weight</span>

    <span class="n">ordered</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CandidateVotes</span><span class="p">(</span><span class="n">cand</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">votes</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">votes</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">ordered</span><span class="p">,</span> <span class="n">votes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.remove_cand" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">remove_cand</span><span class="p">(</span><span class="n">removed</span><span class="p">,</span> <span class="n">ballots</span><span class="p">)</span></code>

<a href="#votekit.utils.remove_cand" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes specified candidate(s) from ballots.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>removed</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Candidate or set of candidates to be removed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ballots</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballots to remove candidate(s) from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Updated list of ballots with candidate(s) removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_cand</span><span class="p">(</span><span class="n">removed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span> <span class="n">ballots</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes specified candidate(s) from ballots.</span>

<span class="sd">    Args:</span>
<span class="sd">        removed: Candidate or set of candidates to be removed.</span>
<span class="sd">        ballots: List of Ballots to remove candidate(s) from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated list of ballots with candidate(s) removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">removed</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">remove_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">removed</span><span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">removed</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="n">remove_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">removed</span><span class="p">)</span>

    <span class="n">update</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ballot</span> <span class="ow">in</span> <span class="n">ballots</span><span class="p">:</span>
        <span class="n">new_ranking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_set</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">remove_set</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
                <span class="n">new_s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">remove_set</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_s</span><span class="p">:</span>
                    <span class="n">new_ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_s</span><span class="p">)</span>
            <span class="n">update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Ballot</span><span class="p">(</span>
                    <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_ranking</span><span class="p">),</span>
                    <span class="n">weight</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span>
                    <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_set</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">:</span>
                <span class="n">new_s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">remove_set</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_s</span><span class="p">:</span>
                    <span class="n">new_ranking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_s</span><span class="p">)</span>
            <span class="n">update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Ballot</span><span class="p">(</span>
                    <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">ranking</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_ranking</span><span class="p">),</span>
                    <span class="n">weight</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span>
                    <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">update</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.fix_ties" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fix_ties</span><span class="p">(</span><span class="n">ballot</span><span class="p">)</span></code>

<a href="#votekit.utils.fix_ties" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Helper function for recursively_fix_ties. Resolves the first appearing
tied rank in the input ballot.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ballot</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.ballot.Ballot" href="#votekit.ballot.Ballot">Ballot</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Ballot.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of Ballots that are permutations of the tied ballot.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_ties</span><span class="p">(</span><span class="n">ballot</span><span class="p">:</span> <span class="n">Ballot</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Ballot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for recursively_fix_ties. Resolves the first appearing</span>
<span class="sd">    tied rank in the input ballot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ballot: A Ballot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): List of Ballots that are permutations of the tied ballot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ballots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rank</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">rank</span><span class="p">):</span>
                <span class="n">resolved</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
                    <span class="n">resolved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">cand</span><span class="p">))</span>
                <span class="n">ballots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Ballot</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                        <span class="n">ranking</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>
                        <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">resolved</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">ballot</span><span class="o">.</span><span class="n">ranking</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:],</span>
                        <span class="n">weight</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">weight</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rank</span><span class="p">)),</span>
                        <span class="n">voter_set</span><span class="o">=</span><span class="n">ballot</span><span class="o">.</span><span class="n">voter_set</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">ballots</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.elect_cands_from_set_ranking" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">elect_cands_from_set_ranking</span><span class="p">(</span><span class="n">ranking</span><span class="p">,</span> <span class="n">seats</span><span class="p">)</span></code>

<a href="#votekit.utils.elect_cands_from_set_ranking" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Splits a ranking into elected and eliminated based on seats,
and if a tie set overlaps the desired number of seats raises a ValueError.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ranking</code></td>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list-of-set ranking of candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seats</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of seats to fill.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[list[set[str]], list[set[str]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list-of-sets of elected candidates, a list-of-sets of eliminated candidates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">elect_cands_from_set_ranking</span><span class="p">(</span>
    <span class="n">ranking</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">seats</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits a ranking into elected and eliminated based on seats,</span>
<span class="sd">    and if a tie set overlaps the desired number of seats raises a ValueError.</span>

<span class="sd">    Args:</span>
<span class="sd">        ranking: A list-of-set ranking of candidates.</span>
<span class="sd">        seats: Number of seats to fill.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list-of-sets of elected candidates, a list-of-sets of eliminated candidates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cands_elected</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">elected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">eliminated</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ranking</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cands_elected</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">seats</span><span class="p">:</span>
            <span class="n">cands_elected</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">elected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eliminated</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">cands_elected</span> <span class="o">!=</span> <span class="n">seats</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot elect correct number of candidates without breaking ties.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">elected</span><span class="p">,</span> <span class="n">eliminated</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.scores_into_set_list" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">score_dict</span><span class="p">,</span> <span class="n">candidate_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#votekit.utils.scores_into_set_list" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sorts candidates based on a scoring dictionary (i.e Borda, First-Place).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>score_dict</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary between candidates (key) and their score (value).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>candidate_subset</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[list[str], set[str], None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Relevant candidates to sort.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Candidate rankings in a list-of-sets form.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scores_into_set_list</span><span class="p">(</span>
    <span class="n">score_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">candidate_subset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts candidates based on a scoring dictionary (i.e Borda, First-Place).</span>

<span class="sd">    Args:</span>
<span class="sd">        score_dict: Dictionary between candidates (key) and their score (value).</span>
<span class="sd">        candidate_subset: Relevant candidates to sort.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Candidate rankings in a list-of-sets form.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">candidate_subset</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">candidate_subset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidate_subset</span><span class="p">)</span>

    <span class="n">tier_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">score_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tier_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">}</span>
    <span class="n">tier_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tier_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tier_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">candidate_subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tier_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">t</span> <span class="o">&amp;</span> <span class="n">candidate_subset</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tier_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="n">candidate_subset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">tier_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.tie_broken_ranking" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">tie_broken_ranking</span><span class="p">(</span><span class="n">ranking</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span></code>

<a href="#votekit.utils.tie_broken_ranking" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Breaks ties in a list-of-sets ranking according to a given scheme.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ranking</code></td>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list-of-set ranking of candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>profile</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="votekit.pref_profile.PreferenceProfile" href="#votekit.pref_profile.PreferenceProfile">PreferenceProfile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreferenceProfile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tiebreak</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Method of tiebreak, currently supports 'none', 'random', 'borda', 'firstplace'.</p>
            </div>
          </td>
          <td>
                <code>&#39;none&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list-of-set ranking of candidates (tie broken down to one candidate sets unless
tiebreak = 'none').</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tie_broken_ranking</span><span class="p">(</span>
    <span class="n">ranking</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">profile</span><span class="p">:</span> <span class="n">PreferenceProfile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Breaks ties in a list-of-sets ranking according to a given scheme.</span>

<span class="sd">    Args:</span>
<span class="sd">        ranking: A list-of-set ranking of candidates.</span>
<span class="sd">        profile: PreferenceProfile.</span>
<span class="sd">        tiebreak: Method of tiebreak, currently supports &#39;none&#39;, &#39;random&#39;, &#39;borda&#39;, &#39;firstplace&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list-of-set ranking of candidates (tie broken down to one candidate sets unless</span>
<span class="sd">            tiebreak = &#39;none&#39;).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">new_ranking</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">tiebreak</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">new_ranking</span> <span class="o">=</span> <span class="n">ranking</span>
    <span class="k">elif</span> <span class="n">tiebreak</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
            <span class="n">shuffled_s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
            <span class="n">new_ranking</span> <span class="o">+=</span> <span class="p">[{</span><span class="n">c</span><span class="p">}</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">shuffled_s</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">tiebreak</span> <span class="o">==</span> <span class="s2">&quot;firstplace&quot;</span><span class="p">:</span>
        <span class="n">tiebreak_scores</span> <span class="o">=</span> <span class="n">first_place_votes</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
            <span class="n">ordered_set</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">tiebreak_scores</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">new_ranking</span> <span class="o">+=</span> <span class="n">ordered_set</span>
    <span class="k">elif</span> <span class="n">tiebreak</span> <span class="o">==</span> <span class="s2">&quot;borda&quot;</span><span class="p">:</span>
        <span class="n">tiebreak_scores</span> <span class="o">=</span> <span class="n">borda_scores</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
            <span class="n">ordered_set</span> <span class="o">=</span> <span class="n">scores_into_set_list</span><span class="p">(</span><span class="n">tiebreak_scores</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">new_ranking</span> <span class="o">+=</span> <span class="n">ordered_set</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid tiebreak code was provided&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tiebreak</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">new_ranking</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial tiebreak was unsuccessful, performing random tiebreak&quot;</span><span class="p">)</span>
        <span class="n">new_ranking</span> <span class="o">=</span> <span class="n">tie_broken_ranking</span><span class="p">(</span>
            <span class="n">ranking</span><span class="o">=</span><span class="n">new_ranking</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">tiebreak</span><span class="o">=</span><span class="s2">&quot;random&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">new_ranking</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="votekit.utils.candidate_position_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">candidate_position_dict</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span></code>

<a href="#votekit.utils.candidate_position_dict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a dictionary with the integer ranking of candidates given a set ranking
i.e. A &gt; B, C &gt; D returns {A: 1, B: 2, C: 2, D: 4}.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ranking</code></td>
          <td>
                <code>list[set[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list-of-sets ranking of candidates.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of candidates (keys) and integer rankings (values).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/votekit/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">candidate_position_dict</span><span class="p">(</span><span class="n">ranking</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a dictionary with the integer ranking of candidates given a set ranking</span>
<span class="sd">    i.e. A &gt; B, C &gt; D returns {A: 1, B: 2, C: 2, D: 4}.</span>

<span class="sd">    Args:</span>
<span class="sd">        ranking: A list-of-sets ranking of candidates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of candidates (keys) and integer rankings (values).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">candidate_positions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">tie_set</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">tie_set</span><span class="p">:</span>
            <span class="n">candidate_positions</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">=</span> <span class="n">position</span>
        <span class="n">position</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tie_set</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">candidate_positions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>







  
  




  



                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.tabs", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>